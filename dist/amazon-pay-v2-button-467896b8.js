"use strict";(self.webpackJsonpCheckout=self.webpackJsonpCheckout||[]).push([[3380,3948],{372:(e,t,n)=>{n.d(t,{A:()=>o});var i=n(31635),a=n(3375),r=n.n(a),s=n(70355);const o=e=>{var{children:t,className:n,hidden:a,testId:o,isFloatingLabelEnabled:d,additionalClassName:l}=e,u=(0,i.__rest)(e,["children","className","hidden","testId","isFloatingLabelEnabled","additionalClassName"]);return s.createElement("label",Object.assign({},u,{className:r()({"floating-label":d},n||"form-label",{"is-srOnly":a},"optimizedCheckout-form-label",l),"data-test":o}),t)}},12056:(e,t,n)=>{n.d(t,{A:()=>d});var i=n(31635),a=n(3375),r=n.n(a),s=n(69440),o=n(70355);const d=(0,o.forwardRef)(((e,t)=>{var{className:n,testId:a,placeholder:d,name:l,isFloatingLabelEnabled:u}=e,m=(0,i.__rest)(e,["className","testId","placeholder","name","isFloatingLabelEnabled"]);return o.createElement("input",Object.assign({},m,{className:r()(n,{"floating-input":u&&!(0,s.includes)(["orderComment","redeemableCode"],l)}),name:l,"data-test":a,placeholder:u?" ":d,ref:t}))}))},29905:(e,t,n)=>{function i(e){switch(e){case"amex":case"american_express":return"american-express";case"diners":case"diners_club":return"diners-club";default:return e}}n.d(t,{A:()=>i})},31448:(e,t,n)=>{n.d(t,{A:()=>i});const i=(0,n(84494).Mz)((({data:e})=>{const t=e.getCart();return t&&t.lineItems}),(e=>(t,n)=>!!e&&function({lineItems:e,instrument:t,paymentMethod:n}){const{isVaultingCardNumberValidationAvailable:i=!0}=(null==n?void 0:n.initializationData)||{};return!(0===e.physicalItems.length||!i||t.trustedShippingAddress)}({lineItems:e,instrument:t,paymentMethod:n})))},48407:(e,t,n)=>{n.d(t,{A:()=>r});var i=n(84494);const a=["bluesnapdirect"];const r=(0,i.Mz)((({data:e})=>{const t=e.getCart();return t&&t.lineItems}),(e=>(t,n)=>!!e&&function({instrument:e,lineItems:t,paymentMethod:n}){const{config:{isVaultingCvvEnabled:i,cardCode:r},initializationData:s}=n,{isVaultingCardCodeValidationAvailable:o=!0}=s||{};return!(a.includes(e.provider)||!o||!(t.digitalItems.length>0||t.giftCertificates.length>0)&&(e.trustedShippingAddress?!i:!i&&!r))}({instrument:t,lineItems:e,paymentMethod:n})))},62677:(e,t,n)=>{n.d(t,{A:()=>w});var i=n(70355),a=n(49655),r=n(24750),s=n(40052),o=n(35393),d=n(97834),l=n(22437),u=n(3375),m=n.n(u),c=n(52921),p=n.n(c),h=n(69440),y=n(86516),I=n(47237),b=n(29905);const E=({className:e,instrument:t,testId:n,shouldHideExpiryDate:r=!1,onClick:s})=>{var o;const d=(0,b.A)(t.brand),u=p().getTypeInfo(d),c=!(0,l.expirationDate)({month:t.expiryMonth,year:t.expiryYear}).isValid;return i.createElement("button",{className:e,"data-test":n,onClick:s,type:"button"},i.createElement("div",{className:m()("instrumentSelect-details",{"instrumentSelect-details--expired":c})},i.createElement(y.A,{cardType:d}),i.createElement("div",{className:"instrumentSelect-card","data-test":`${null!=n?n:""}-last4`},u?i.createElement(a.A,{data:{cardTitle:null!==(o=u.niceType)&&void 0!==o?o:"",endingIn:t.last4},id:"payment.instrument_ending_in_text"}):i.createElement(a.A,{data:{endingIn:t.last4},id:"payment.instrument_default_ending_in_text"})),!r&&i.createElement("div",{className:m()("instrumentSelect-expiry",{"instrumentSelect-expiry--expired":c}),"data-test":`${n||""}-expiry`},c?i.createElement(a.A,{data:{expiryDate:`${t.expiryMonth}/${t.expiryYear}`},id:"payment.instrument_expired_text"}):i.createElement(a.A,{data:{expiryDate:`${t.expiryMonth}/${t.expiryYear}`},id:"payment.instrument_expires_text"}))))},g=({instrument:e,shouldHideExpiryDate:t=!1,onClick:n=h.noop})=>{const a=(0,i.useCallback)((()=>{n(e.bigpayToken)}),[n,e]);return i.createElement(E,{instrument:e,onClick:a,shouldHideExpiryDate:t,testId:"instrument-select-option"})},C=({className:e,testId:t,onClick:n=h.noop})=>i.createElement("button",{className:e,"data-test":t,onClick:n,type:"button"},i.createElement("div",{className:"instrumentSelect-details instrumentSelect-details--addNew"},i.createElement(y.A,null),i.createElement("div",{className:"instrumentSelect-card"},i.createElement(a.A,{id:"payment.instrument_add_card_action"})))),v=({instruments:e,selectedInstrumentId:t,shouldHideExpiryDate:n=!1,onSelectInstrument:a,onUseNewInstrument:r})=>i.createElement("ul",{className:"instrumentSelect-dropdownMenu instrumentSelect-dropdownMenuNext dropdown-menu","data-test":"instrument-select-menu"},e.map((e=>i.createElement("li",{className:m()("instrumentSelect-option dropdown-menu-item",{"instrumentSelect-option--selected":e.bigpayToken===t}),key:e.bigpayToken},i.createElement(g,{instrument:e,onClick:a,shouldHideExpiryDate:n,testId:"instrument-select-option"})))),i.createElement("li",{className:"instrumentSelect-option instrumentSelect-option--addNew dropdown-menu-item"},i.createElement(C,{onClick:r,testId:"instrument-select-option-use-new"}))),f=({instrument:e,shouldHideExpiryDate:t=!1,testId:n,onClick:a})=>e?i.createElement(E,{className:"instrumentSelect-button optimizedCheckout-form-select dropdown-button form-input",instrument:e,onClick:a,shouldHideExpiryDate:t,testId:n}):i.createElement(C,{className:"instrumentSelect-button optimizedCheckout-form-select dropdown-button form-input",testId:n}),S=({field:e,form:t,instruments:n,onSelectInstrument:a,onUseNewInstrument:r,selectedInstrumentId:s,shouldHideExpiryDate:o=!1})=>{const d=(0,i.useRef)(s),l=(0,i.useCallback)(((n="")=>{t.setFieldValue(e.name,n)}),[t,e.name]);(0,i.useEffect)((()=>(setTimeout((()=>l(s))),()=>{""===e.value&&void 0!==s&&l()})),[]),(0,i.useEffect)((()=>{d.current!==s&&setTimeout((()=>l(s))),d.current=s}),[s,l]);const u=(0,h.find)(n,{bigpayToken:s});return i.createElement("div",{className:"instrumentSelect"},i.createElement(I.A,{dropdown:i.createElement(v,{instruments:n,onSelectInstrument:a,onUseNewInstrument:r,selectedInstrumentId:s,shouldHideExpiryDate:o})},i.createElement(f,{instrument:u,shouldHideExpiryDate:o,testId:"instrument-select"}),i.createElement("input",Object.assign({type:"hidden"},e))))};var N=n(3701);const w=(0,i.memo)((({instruments:e,onDeleteInstrument:t,onSelectInstrument:n,onUseNewInstrument:l,selectedInstrumentId:u,shouldHideExpiryDate:m=!1,validateInstrument:c=null})=>{const p=(0,i.useCallback)((t=>i.createElement(S,Object.assign({},t,{instruments:e,onSelectInstrument:n,onUseNewInstrument:l,selectedInstrumentId:u,shouldHideExpiryDate:m}))),[e,n,l,u,m]),h=(0,i.useCallback)((n=>i.createElement(N.A,Object.assign({instruments:e,onDeleteInstrument:t},n))),[e,t]);return i.createElement(r.A,{additionalClassName:"instrumentFieldset",legend:i.createElement(s.A,{hidden:!0},i.createElement(a.A,{id:"payment.instrument_text"}))},i.createElement(o.A,{modal:h},(({onClick:e})=>i.createElement("button",{className:"instrumentModal-trigger",onClick:e,type:"button"},i.createElement(a.A,{id:"payment.instrument_manage_button"})))),i.createElement(d.A,{name:"instrumentId",render:p}),i.createElement("div",{style:{display:u?void 0:"none"}},c))}))},63582:(e,t,n)=>{n.d(t,{A:()=>r});var i=n(31635),a=n(70355);const r=(0,n(19285).A)((({checkoutService:{deinitializeCustomer:e,initializeCustomer:t},checkoutButtonContainerClass:n,containerId:r,methodId:s,onUnhandledError:o,onWalletButtonClick:d,additionalInitializationOptions:l,integrations:u})=>((0,a.useEffect)((()=>((0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{yield t({methodId:s,integrations:u,[s]:Object.assign({container:r,onUnhandledError:o,onClick:()=>d(s)},l)})}catch(e){"function"==typeof o&&e instanceof Error&&o(e)}})),()=>{(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{yield e({methodId:s})}catch(e){"function"==typeof o&&e instanceof Error&&o(e)}}))})),[]),a.createElement("div",{className:n,"data-test":r,id:r}))),[])},79026:(e,t,n)=>{n.d(t,{N:()=>r,i:()=>a});var i=n(70355);const a=(0,i.createContext)(void 0);function r(){const e=(0,i.useContext)(a);if(!e)throw new Error("usePaymentFormContext must be used within a PaymentFormContextProvider");return e}},86516:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(70355),a=n(97685),r=n(2156);const s=(0,i.memo)((({cardType:e})=>{const t={additionalClassName:"cardIcon-icon",size:r.l.Medium,testId:`credit-card-icon-${e||"default"}`},n=(0,a.qT)(e);return n?i.createElement(i.Suspense,null,i.createElement(n,Object.assign({},t))):i.createElement("div",{className:"cardIcon-icon cardIcon-icon--default icon icon--medium"})}))},88727:(e,t,n)=>{n.d(t,{AmazonPayV2Button:()=>h,AmazonPayV2PaymentMethod:()=>m});var i=n(31635),a=n(30183),r=n(69440),s=n(70355),o=n(89799),d=n(48407),l=n(31448),u=n(19285);const m=(0,u.A)((e=>{var{checkoutService:t,checkoutState:n,paymentForm:u,method:m,method:{initializationData:{paymentDescriptor:c,paymentToken:p}}}=e,h=(0,i.__rest)(e,["checkoutService","checkoutState","paymentForm","method","method"]);const y=(0,s.useCallback)((e=>t.initializePayment(Object.assign(Object.assign({},e),{integrations:[a.cz],amazonpay:{editButtonId:"editButtonId"}}))),[t]),I=(0,s.useCallback)((()=>window.location.reload()),[]),{hidePaymentSubmitButton:b,disableSubmit:E,setFieldValue:g,setSubmit:C,setValidationSchema:v}=u,{data:{getCheckout:f,isPaymentDataRequired:S},statuses:{isLoadingInstruments:N}}=n,w=f(),A=n.data.getCustomer(),k=!(null==A?void 0:A.isGuest)&&Boolean(m.config.isVaultingEnabled),z=n.data.getInstruments(m)||[];return s.createElement(o.A,Object.assign({},h,{buttonId:"editButtonId",containerId:"paymentWidget",deinitializePayment:t.deinitializePayment,disableSubmit:E,hidePaymentSubmitButton:b,hideWidget:!0,initializePayment:y,instruments:z,isInstrumentCardCodeRequired:(0,d.A)(n),isInstrumentCardNumberRequired:(0,l.A)(n),isInstrumentFeatureAvailable:k,isLoadingInstruments:N(),isPaymentDataRequired:S(),isSignInRequired:!1,isSignedIn:(0,r.some)(null==w?void 0:w.payments,{providerId:m.id}),loadInstruments:t.loadInstruments,method:m,onSignOut:I,paymentDescriptor:c,setFieldValue:g,setSubmit:C,setValidationSchema:v,shouldShow:!!p,shouldShowDescriptor:!!p,shouldShowEditButton:!!p,signOut:t.signOutCustomer}))}),[{id:"amazonpay"}]);var c=n(63582);const p=()=>{var e;if(!document.querySelector(".checkout-button-container"))return;const t=document.querySelector("#amazonpayCheckoutButton > div");if(t){const n=null===(e=t.shadowRoot)||void 0===e?void 0:e.querySelector(".amazonpay-button-view1");if(n instanceof HTMLElement)return void(n.style.height="36px")}setTimeout(p,10)},h=(0,u.A)((e=>((0,s.useEffect)((()=>{p()}),[]),s.createElement("div",{className:"AmazonPayContainer"},s.createElement(c.A,Object.assign({integrations:[a.mg]},e))))),[{id:"amazonpay"}])},89799:(e,t,n)=>{n.d(t,{A:()=>g});var i=n(31635),a=n(69440),r=n(70355),s=n(52137),o=n(43125),d=n(11474),l=n(62677),u=n(40646),m=n(68801),c=n(3375),p=n.n(c),h=n(72769),y=n(49655);const I=({buttonId:e,shouldShowEditButton:t})=>{if(t){const t=r.createElement(y.A,{id:"remote.select_different_card_action"});return r.createElement("p",null,r.createElement("button",{className:p()("stepHeader","widget-link-amazonpay"),id:e,onClick:(0,h.A)(),type:"button"},t))}return null},b=({shouldShowDescriptor:e,paymentDescriptor:t})=>e&&t?r.createElement("div",{className:"payment-descriptor"},t):null,E=({additionalContainerClassName:e,containerId:t,hideContentWhenSignedOut:n,hideWidget:i,isSignInRequired:a,isSignedIn:s,method:o,renderCustomPaymentForm:d,shouldRenderCustomInstrument:l,shouldShowCreditCardFieldset:u})=>r.createElement("div",{className:p()("widget",`widget--${o.id}`,"payment-widget",l?"":e),id:t,style:{display:n&&a&&!s||!u||i?"none":void 0},tabIndex:-1},l&&d&&d()),g=({instruments:e,hideWidget:t=!1,isInitializing:n=!1,isAccountInstrument:c,isInstrumentFeatureAvailable:p,isLoadingInstruments:h,shouldHideInstrumentExpiryDate:y=!1,shouldShow:g=!0,hideVerificationFields:C,method:v,storedCardValidationSchema:f,isPaymentDataRequired:S,setValidationSchema:N,loadInstruments:w,onUnhandledError:A=a.noop,deinitializeCustomer:k,deinitializePayment:z,setSubmit:x,initializeCustomer:_,initializePayment:D,signInCustomer:T,isSignedIn:O,isSignInRequired:R,isInstrumentCardNumberRequired:P,validateInstrument:B,containerId:F,hideContentWhenSignedOut:M=!1,renderCustomPaymentForm:H,additionalContainerClassName:V,shouldRenderCustomInstrument:q=!1,paymentDescriptor:j,shouldShowDescriptor:U,shouldShowEditButton:L,buttonId:W,setFieldValue:$})=>{const[Y,J]=(0,r.useState)(!1),[G,K]=(0,r.useState)(void 0),X=(0,r.useRef)(e);(0,r.useEffect)((()=>{X.current=e}),[e]);const Q=(0,r.useCallback)((()=>{if(Y)return;const e=X.current.find((e=>e.defaultInstrument))||X.current[0];return e?e.bigpayToken:void 0}),[Y]),Z=(0,r.useCallback)((()=>{const e=G||Q();return(0,a.find)(X.current,{bigpayToken:e})}),[G,Q]),ee=(0,r.useCallback)((()=>{if(!S)return null;const e=Z();return p&&e&&f||null}),[Z,p,S,f]),te=(0,r.useCallback)(((e,t)=>!e&&(0,s.T)(t)?t:void 0),[]),ne=(0,r.useCallback)((t=>{if(0===e.length)return J(!0),K(void 0),void $("instrumentId","");if(G===t){const e=Q();K(e),$("instrumentId",e)}}),[e,G,Q]),ie=(0,r.useCallback)((()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){J(!0),K(void 0),z&&(yield z({gatewayId:v.gateway,methodId:v.id})),D&&(yield D({gatewayId:v.gateway,methodId:v.id}))}))),[v,z,D]),ae=(0,r.useCallback)((e=>{J(!1),K(e)}),[]),re=(0,r.useCallback)((()=>{const t=G||Q(),n=(0,a.find)(e,{bigpayToken:t});if(n){(0,o.A)(n);const e=P(n,v);if(C)return;if(B)return B(e,n)}}),[G,Q,e,v,C,B]),se=()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const e=X.current;if(!S)return void x(v,null);if(R&&!O)return x(v,T||null),_?_({methodId:v.id}):void 0;let t;if(x(v,null),!Y){const n=G||Q(),i=e.find((e=>e.bigpayToken===n))||e[0];i&&(0,o.a)(i)&&(t=i)}return D?D({gatewayId:v.gateway,methodId:v.id},t):void 0})),oe=G||Q(),de=oe&&e.find((e=>e.bigpayToken===oe))||e[0],le=e.filter((e=>!(0,s.T)(e))),ue=e.filter((e=>(0,s.T)(e))),me=p&&e.length>0,ce=!me||Y,pe=(n||h)&&!t,he=de?te(Y,de):void 0,ye=e[0]&&(0,s.T)(e[0]);(0,r.useEffect)((()=>((0,i.__awaiter)(void 0,void 0,void 0,(function*(){N(v,ee());try{p&&(yield null==w?void 0:w()),yield se()}catch(e){e instanceof Error&&A(e)}})),()=>{(0,i.__awaiter)(void 0,void 0,void 0,(function*(){N(v,null),x(v,null);try{z&&(yield z({gatewayId:v.gateway,methodId:v.id})),k&&(yield k({methodId:v.id}))}catch(e){e instanceof Error&&A(e)}}))})),[]);const Ie=(0,r.useRef)(!0),be=(0,r.useRef)(e.length),Ee=(0,r.useRef)(S),ge=(0,r.useRef)(G);return(0,r.useEffect)((()=>{if(Ie.current)return void(Ie.current=!1);N(v,ee());(ge.current!==G||Number(be.current)>0&&0===e.length||Ee.current!==S)&&(ge.current=G,be.current=e.length,Ee.current=S,(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{z&&(yield z({gatewayId:v.gateway,methodId:v.id})),yield se()}catch(e){e instanceof Error&&A(e)}})))}),[G,e,S]),g?r.createElement(m.A,{hideContentWhenLoading:!0,isLoading:pe},r.createElement("div",{className:"paymentMethod--hosted"},ye&&me&&r.createElement(d.A,{instruments:ue,onSelectInstrument:ae,onUseNewInstrument:ie,selectedInstrument:he}),!ye&&me&&r.createElement(l.A,{instruments:le,onDeleteInstrument:ne,onSelectInstrument:ae,onUseNewInstrument:ie,selectedInstrumentId:oe,shouldHideExpiryDate:y,validateInstrument:re()}),r.createElement(b,{paymentDescriptor:j,shouldShowDescriptor:U}),r.createElement(E,{additionalContainerClassName:V,containerId:F,hideContentWhenSignedOut:M,hideWidget:t,isSignInRequired:R,isSignedIn:O,method:v,renderCustomPaymentForm:H,shouldRenderCustomInstrument:q,shouldShowCreditCardFieldset:ce}),p&&r.createElement(u.A,{instrumentId:oe,instruments:e,isAccountInstrument:Boolean(c||ye)}),r.createElement(I,{buttonId:W,shouldShowEditButton:L}))):r.createElement("div",{style:{display:"none"}})}},97685:(e,t,n)=>{n.d(t,{Ay:()=>r,TE:()=>o,qT:()=>s});var i=n(70355);const a={AMEX:{instrument:"american-express",component:(0,i.lazy)((()=>n.e(5609).then(n.bind(n,68494))))},BITCOIN:{instrument:"bitcoin",component:(0,i.lazy)((()=>n.e(5137).then(n.bind(n,25755))))},BITCOIN_CASH:{instrument:"bitcoin-cash",component:(0,i.lazy)((()=>n.e(63).then(n.bind(n,94526))))},BANCONTACT:{instrument:"bancontact",component:(0,i.lazy)((()=>n.e(8841).then(n.bind(n,69790))))},CARNET:{instrument:"carnet",component:(0,i.lazy)((()=>n.e(535).then(n.bind(n,57228))))},CB:{instrument:"cb",component:(0,i.lazy)((()=>n.e(5615).then(n.bind(n,79060))))},DINERS:{instrument:"diners-club",component:(0,i.lazy)((()=>n.e(9764).then(n.bind(n,43228))))},DANKORT:{instrument:"dankort",component:(0,i.lazy)((()=>n.e(8773).then(n.bind(n,1530))))},DISCOVER:{instrument:"discover",component:(0,i.lazy)((()=>n.e(8057).then(n.bind(n,83262))))},DOGECOIN:{instrument:"dogecoin",component:(0,i.lazy)((()=>n.e(69).then(n.bind(n,24125))))},ELECTRON:{instrument:"electron",component:(0,i.lazy)((()=>n.e(1782).then(n.bind(n,97841))))},ELO:{instrument:"elo",component:(0,i.lazy)((()=>n.e(4322).then(n.bind(n,27261))))},ETHEREUM:{instrument:"ethereum",component:(0,i.lazy)((()=>n.e(6954).then(n.bind(n,71518))))},HIPER:{instrument:"hiper",component:(0,i.lazy)((()=>n.e(7292).then(n.bind(n,47919))))},JCB:{instrument:"jcb",component:(0,i.lazy)((()=>n.e(4833).then(n.bind(n,30758))))},LITECOIN:{instrument:"litecoin",component:(0,i.lazy)((()=>n.e(7234).then(n.bind(n,52646))))},MADA:{instrument:"mada",component:(0,i.lazy)((()=>n.e(1767).then(n.bind(n,18732))))},MAESTRO:{instrument:"maestro",component:(0,i.lazy)((()=>n.e(2891).then(n.bind(n,22704))))},MC:{instrument:"mastercard",component:(0,i.lazy)((()=>n.e(4936).then(n.bind(n,63723))))},SHIBA_INU:{instrument:"shiba-inu",component:(0,i.lazy)((()=>n.e(4795).then(n.bind(n,55420))))},TROY:{instrument:"troy",component:(0,i.lazy)((()=>n.e(370).then(n.bind(n,23229))))},CUP:{instrument:"unionpay",component:(0,i.lazy)((()=>n.e(2425).then(n.bind(n,66302))))},USD_COIN:{instrument:"usd-coin",component:(0,i.lazy)((()=>n.e(2643).then(n.bind(n,68650))))},VISA:{instrument:"visa",component:(0,i.lazy)((()=>n.e(1507).then(n.bind(n,24856))))}};function r(e){var t;return(null===(t=a[e])||void 0===t?void 0:t.instrument)||void 0}function s(e){if(!e)return;const t=Object.values(a).find((t=>t.instrument===e));return t?t.component:void 0}function o(e){const t=Object.values(a).map((e=>e.instrument));return e.filter((e=>t.includes(e)))}}}]);
//# sourceMappingURL=amazon-pay-v2-button-467896b8.js.map