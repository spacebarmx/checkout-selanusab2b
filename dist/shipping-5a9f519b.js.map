{"version":3,"file":"shipping-5a9f519b.js","mappings":"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","sources":["webpack://checkout/./packages/ui/src/icon/IconHelp.tsx","webpack://checkout/./packages/ui/src/accordion/AccordionItem.tsx","webpack://checkout/./packages/core/src/app/ui/form/ChecklistItemInput.tsx","webpack://checkout/./packages/core/src/app/ui/form/ChecklistItem.tsx","webpack://checkout/./packages/ui/src/modal/ConfirmationModal.tsx","webpack://checkout/./packages/ui/src/icon/IconClose.tsx","webpack://checkout/./packages/ui/src/modal/Modal.tsx","webpack://checkout/./packages/ui/src/form/Fieldset/Fieldset.tsx","webpack://checkout/./packages/ui/src/accordion/AccordionContext.tsx","webpack://checkout/./packages/core/src/app/ui/icon/IconChevronDown.tsx","webpack://checkout/./packages/core/src/app/ui/tooltip/Tooltip.tsx","webpack://checkout/./packages/ui/src/icon/IconError.tsx","webpack://checkout/./packages/ui/src/icon/IconSuccess.tsx","webpack://checkout/./packages/ui/src/icon/IconInfo.tsx","webpack://checkout/./packages/ui/src/alert/Alert.tsx","webpack://checkout/./packages/ui/src/modal/ModalHeader.tsx","webpack://checkout/./packages/core/src/app/shipping/getShippingMethodId.ts","webpack://checkout/./packages/core/src/app/shipping/hasPromotionalItems.tsx","webpack://checkout/./packages/core/src/app/common/form/withFormikExtended.tsx","webpack://checkout/./packages/core/src/app/address/AddressFormModal.tsx","webpack://checkout/./packages/core/src/app/shipping/errors/AssignItemInvalidAddressError.ts","webpack://checkout/./packages/core/src/app/shipping/errors/AssignItemFailedError.ts","webpack://checkout/./packages/ui/src/icon/IconEdit.tsx","webpack://checkout/./packages/core/src/app/shipping/GuestCustomerAddressSelector.tsx","webpack://checkout/./packages/core/src/app/shipping/utils/setRecommendedOrMissingShippingOption.ts","webpack://checkout/./packages/core/src/app/shipping/ConsignmentAddressSelector.tsx","webpack://checkout/./packages/core/src/app/shipping/ItemSplitTooltip.tsx","webpack://checkout/./packages/core/src/app/shipping/AllocatedItemsList.tsx","webpack://checkout/./packages/core/src/app/shipping/LeftToAllocateItem.tsx","webpack://checkout/./packages/core/src/app/shipping/LeftToAllocateItemsTable.tsx","webpack://checkout/./packages/core/src/app/shipping/MultishippingType.ts","webpack://checkout/./packages/core/src/app/shipping/AllocateItemsModal.tsx","webpack://checkout/./packages/core/src/app/shipping/errors/UnassignItemError.ts","webpack://checkout/./packages/core/src/app/shipping/hooks/useDeallocateItem.ts","webpack://checkout/./packages/core/src/app/shipping/utils/generateItemHash.tsx","webpack://checkout/./packages/core/src/app/shipping/hooks/useMultishippingConsignmentItems.ts","webpack://checkout/./packages/core/src/app/shipping/ConsignmentLineItem.tsx","webpack://checkout/./packages/core/src/app/shipping/shippingOption/MultiShippingOptionsListItem.tsx","webpack://checkout/./packages/core/src/app/shipping/shippingOption/MultiShippingOptionsList.tsx","webpack://checkout/./packages/core/src/app/shipping/getShippableLineItems.ts","webpack://checkout/./packages/core/src/app/shipping/findConsignment.ts","webpack://checkout/./packages/core/src/app/shipping/getRecommendedShippingOption.ts","webpack://checkout/./packages/core/src/app/shipping/utils/getShippingOptionIds.ts","webpack://checkout/./packages/core/src/app/shipping/shippingOption/MultiShippingConsignmentDetails.tsx","webpack://checkout/./packages/core/src/app/shipping/shippingOption/NoShippingOption.tsx","webpack://checkout/./packages/core/src/app/shipping/carriers/getCarriers.ts","webpack://checkout/./packages/core/src/app/shipping/carriers/getCarriersName.ts","webpack://checkout/./packages/core/src/app/shipping/shippingOption/ShippingOptionsList.tsx","webpack://checkout/./packages/core/src/app/shipping/carriers/getDefaultCarriers.ts","webpack://checkout/./packages/core/src/app/shipping/shippingOption/ShippingOptionsForm.tsx","webpack://checkout/./packages/core/src/app/shipping/shippingOption/ShippingOptions.tsx","webpack://checkout/./packages/core/src/app/shipping/shippingOption/MultiShippingOptions.tsx","webpack://checkout/./packages/core/src/app/shipping/ConsignmentListItem.tsx","webpack://checkout/./packages/core/src/app/shipping/isSelectedShippingOptionValid.ts","webpack://checkout/./packages/core/src/app/shipping/MultiShippingFormFooter.tsx","webpack://checkout/./packages/core/src/app/shipping/NewConsignment.tsx","webpack://checkout/./packages/core/src/app/shipping/MultiShippingForm.tsx","webpack://checkout/./packages/core/src/app/shipping/BillingSameAsShippingField.tsx","webpack://checkout/./packages/core/src/app/shipping/StaticAddressEditable.tsx","webpack://checkout/./packages/core/src/app/shipping/AmazonPayShippingAddress.tsx","webpack://checkout/./packages/paypal-fastlane-integration/src/PayPalFastlaneShippingAddressForm.tsx","webpack://checkout/./packages/core/src/app/shipping/ShippingAddressForm.tsx","webpack://checkout/./packages/core/src/app/shipping/PayPalFastlaneShippingAddress.tsx","webpack://checkout/./packages/core/src/app/shipping/ShippingAddress.tsx","webpack://checkout/./packages/core/src/app/shipping/ShippingAddressFields.ts","webpack://checkout/./packages/core/src/app/shipping/ShippingFormFooter.tsx","webpack://checkout/./packages/core/src/app/shipping/SingleShippingForm.tsx","webpack://checkout/./packages/core/src/app/shipping/ShippingForm.tsx","webpack://checkout/./packages/core/src/app/shipping/ShippingHeader.tsx","webpack://checkout/./packages/core/src/app/shipping/stripeUPE/StripeShippingAddressDisplay.tsx","webpack://checkout/./packages/core/src/app/shipping/stripeUPE/StripeStateMapper.ts","webpack://checkout/./packages/core/src/app/shipping/stripeUPE/StripeShippingAddress.tsx","webpack://checkout/./packages/core/src/app/shipping/stripeUPE/StripeShippingForm.tsx","webpack://checkout/./packages/core/src/app/shipping/stripeUPE/StripeShipping.tsx","webpack://checkout/./packages/core/src/app/shipping/Shipping.tsx","webpack://checkout/./packages/ui/src/accordion/Accordion.tsx","webpack://checkout/./packages/core/src/app/ui/form/Checklist.tsx","webpack://checkout/./packages/core/src/app/ui/icon/IconChevronUp.tsx","webpack://checkout/./packages/core/src/app/common/form/connectFormik.tsx","webpack://checkout/./packages/ui/src/tooltip/TooltipTrigger.tsx"],"sourcesContent":["import React, { type FunctionComponent } from 'react';\n\nimport withIconContainer from './withIconContainer';\n\nconst IconHelp: FunctionComponent = () => (\n    <svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z\" />\n    </svg>\n);\n\nexport default withIconContainer(IconHelp);\n","import classNames from 'classnames';\nimport React, {\n    type FunctionComponent,\n    memo,\n    type ReactNode,\n    useCallback,\n    useContext,\n} from 'react';\nimport { CSSTransition } from 'react-transition-group';\n\nimport AccordionContext from './AccordionContext';\n\nexport interface AccordionItemProps {\n    bodyClassName?: string;\n    children?: ReactNode;\n    className?: string;\n    classNameSelected?: string;\n    headerClassName?: string;\n    headerClassNameSelected?: string;\n    itemId: string;\n    headerContent(props: AccordionItemHeaderProps): ReactNode;\n}\n\nexport interface AccordionItemHeaderProps {\n    isSelected: boolean;\n    onToggle(id: string): void;\n}\n\nconst AccordionItem: FunctionComponent<AccordionItemProps> = ({\n    bodyClassName = 'accordion-item-body',\n    children,\n    className = 'accordion-item',\n    classNameSelected = 'accordion-item--selected',\n    headerClassName = 'accordion-item-header',\n    headerClassNameSelected = 'accordion-item-header--selected',\n    headerContent,\n    itemId,\n}) => {\n    const { onToggle, selectedItemId } = useContext(AccordionContext);\n    const isSelected = selectedItemId === itemId;\n\n    const transitionEndListener = useCallback((node: Node, done: () => void) => {\n        node.addEventListener('transitionend', ({ target }: Event) => {\n            if (target === node) {\n                done();\n            }\n        });\n    }, []);\n\n    return (\n        <li className={classNames(className, { [classNameSelected]: isSelected })}>\n            <div className={classNames(headerClassName, { [headerClassNameSelected]: isSelected })}>\n                {headerContent({ isSelected, onToggle })}\n            </div>\n\n            {children ? (\n                <CSSTransition\n                    addEndListener={transitionEndListener}\n                    classNames={bodyClassName}\n                    in={isSelected}\n                    mountOnEnter\n                    timeout={{}}\n                    unmountOnExit\n                >\n                    <div aria-live=\"polite\" className={bodyClassName}>\n                        {children}\n                    </div>\n                </CSSTransition>\n            ) : null}\n        </li>\n    );\n};\n\nexport default memo(AccordionItem);\n","import React, { type FunctionComponent, type InputHTMLAttributes } from 'react';\n\nimport Input from './Input';\nimport Label from './Label';\n\nexport interface ChecklistItemInputProps extends InputHTMLAttributes<HTMLInputElement> {\n    isSelected: boolean;\n}\n\nconst ChecklistItemInput: FunctionComponent<ChecklistItemInputProps> = ({\n    id,\n    isSelected,\n    children,\n    ...props\n}) => (\n    <>\n        <Input\n            {...props}\n            checked={isSelected}\n            className=\"form-checklist-checkbox optimizedCheckout-form-checklist-checkbox\"\n            id={id}\n            type=\"radio\"\n        />\n\n        <Label htmlFor={id}>{children}</Label>\n    </>\n);\n\nexport default ChecklistItemInput;\n","import { memoizeOne } from '@bigcommerce/memoize';\nimport { type FieldProps } from 'formik';\nimport { kebabCase } from 'lodash';\nimport React, { type FunctionComponent, memo, type ReactNode, useCallback, useContext } from 'react';\n\nimport { AccordionItem, type AccordionItemHeaderProps } from '@bigcommerce/checkout/ui';\n\nimport BasicFormField from './BasicFormField';\nimport { ChecklistContext } from './Checklist';\nimport ChecklistItemInput from './ChecklistItemInput';\n\nexport interface ChecklistItemProps {\n    content?: ReactNode;\n    htmlId?: string;\n    isDisabled?: boolean;\n    label: ReactNode | ((isSelected: boolean) => ReactNode);\n    value: string;\n}\n\nconst ChecklistItem: FunctionComponent<ChecklistItemProps> = ({\n    isDisabled,\n    value,\n    content,\n    htmlId = kebabCase(value),\n    label,\n    ...rest\n}) => {\n    const { name = '' } = useContext(ChecklistContext) || {};\n\n    const renderInput = useCallback(\n        memoizeOne((isSelected: boolean) => ({ field }: FieldProps) => (\n            <ChecklistItemInput\n                {...field}\n                disabled={isDisabled}\n                id={htmlId}\n                isSelected={field.value === value}\n                value={value}\n            >\n                {label instanceof Function ? label(isSelected) : label}\n            </ChecklistItemInput>\n        )),\n        [htmlId, isDisabled, label, value],\n    );\n\n    const handleChange = useCallback(\n        memoizeOne((onToggle: (id: string) => void) => (selectedValue: string) => {\n            if (value === selectedValue) {\n                onToggle(value);\n            }\n        }),\n        [],\n    );\n\n    const renderHeaderContent = useCallback(\n        ({ isSelected, onToggle }: AccordionItemHeaderProps) => (\n            <BasicFormField\n                className=\"form-checklist-option\"\n                name={name}\n                onChange={handleChange(onToggle)}\n                render={renderInput(isSelected)}\n            />\n        ),\n        [handleChange, name, renderInput],\n    );\n\n    return (\n        <AccordionItem\n            {...rest}\n            bodyClassName=\"form-checklist-body\"\n            className=\"form-checklist-item optimizedCheckout-form-checklist-item\"\n            classNameSelected=\"form-checklist-item--selected optimizedCheckout-form-checklist-item--selected\"\n            headerClassName=\"form-checklist-header\"\n            headerClassNameSelected=\"form-checklist-header--selected\"\n            headerContent={renderHeaderContent}\n            itemId={value}\n        >\n            {content}\n        </AccordionItem>\n    );\n};\n\nexport default memo(ChecklistItem);\n","import { noop } from 'lodash';\nimport React, { type ReactNode } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { Button, ButtonSize, ButtonVariant } from '../button';\n\nimport Modal from './Modal';\nimport ModalHeader from './ModalHeader';\n\ninterface ConfirmationModalProps {\n    headerId: string;\n    messageId: string;\n    isModalOpen: boolean;\n    onRequestClose?: () => void;\n    action: () => void;\n    actionButtonLabel?: ReactNode;\n    shouldShowCloseButton?: boolean;\n}\n\nconst ConfirmationModal = ({\n    headerId,\n    messageId,\n    isModalOpen,\n    action,\n    actionButtonLabel,\n    onRequestClose = noop,\n    shouldShowCloseButton = true,\n}: ConfirmationModalProps) => {\n    return (\n        <Modal\n            additionalModalClassName=\"modal--confirm\"\n            footer={\n                <Button onClick={action} size={ButtonSize.Small} variant={ButtonVariant.Primary}>\n                    {actionButtonLabel ?? <TranslatedString id=\"common.confirm_action\" />}\n                </Button>\n            }\n            header={\n                <ModalHeader>\n                    <span aria-live=\"assertive\" role=\"alert\">\n                        <TranslatedString id={headerId} />\n                    </span>\n                </ModalHeader>\n            }\n            isOpen={isModalOpen}\n            onRequestClose={onRequestClose}\n            shouldShowCloseButton={shouldShowCloseButton}\n        >\n            <p aria-live=\"assertive\" role=\"alert\">\n                <TranslatedString id={messageId} />\n            </p>\n        </Modal>\n    );\n};\n\nexport default ConfirmationModal;\n","import React, { type FunctionComponent } from 'react';\n\nimport withIconContainer from './withIconContainer';\n\nconst IconClose: FunctionComponent = () => (\n    <svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\" />\n    </svg>\n);\n\nexport default withIconContainer(IconClose);\n","import classNames from 'classnames';\nimport { noop } from 'lodash';\nimport React, {\n    type FunctionComponent,\n    type KeyboardEvent,\n    type MouseEvent,\n    type ReactNode,\n    useCallback,\n} from 'react';\nimport ReactModal from 'react-modal';\nimport { type Omit } from 'utility-types';\n\nimport { preventDefault } from '@bigcommerce/checkout/dom-utils';\n\nimport { IconClose } from '../icon';\n\nexport type ModalProps = Omit<\n    ReactModal.Props,\n    'bodyOpenClassName' | 'className' | 'closeTimeoutMS' | 'overlayClassName'\n> & {\n    children?: ReactNode;\n    closeButtonLabel?: string | ReactNode;\n    footer?: ReactNode;\n    header?: ReactNode;\n    additionalHeaderClassName?: string;\n    additionalBodyClassName?: string;\n    additionalModalClassName?: string;\n    shouldShowCloseButton?: boolean;\n};\n\nconst Modal: FunctionComponent<ModalProps> = ({\n    children,\n    closeButtonLabel = 'Close',\n    footer,\n    header,\n    additionalHeaderClassName,\n    additionalBodyClassName,\n    additionalModalClassName,\n    onRequestClose = noop,\n    shouldShowCloseButton = false,\n    ...rest\n}) => {\n    const handleClose = useCallback(\n        (event: MouseEvent | KeyboardEvent) => {\n            onRequestClose(event);\n        },\n        [onRequestClose],\n    );\n\n    return (\n        <ReactModal\n            {...rest}\n            ariaHideApp={process.env.NODE_ENV !== 'test'}\n            bodyOpenClassName=\"has-activeModal\"\n            className={{\n                base: classNames(\n                    'modal optimizedCheckout-contentPrimary',\n                    additionalModalClassName,\n                ),\n                afterOpen: 'modal--afterOpen',\n                beforeClose: 'modal--beforeClose',\n            }}\n            closeTimeoutMS={200}\n            onRequestClose={onRequestClose}\n            overlayClassName={{\n                base: 'modalOverlay',\n                afterOpen: 'modalOverlay--afterOpen',\n                beforeClose: 'modalOverlay--beforeClose',\n            }}\n            shouldCloseOnEsc={true}\n            shouldCloseOnOverlayClick={false}\n        >\n            <div className={classNames('modal-header', additionalHeaderClassName)}>\n                {header}\n\n                {shouldShowCloseButton && (\n                    <a\n                        className=\"modal-close\"\n                        data-test=\"modal-close-button\"\n                        href=\"#\"\n                        onClick={preventDefault(handleClose)}\n                    >\n                        {Boolean(closeButtonLabel) && (\n                            <span className=\"is-srOnly\">{closeButtonLabel}</span>\n                        )}\n\n                        <IconClose />\n                    </a>\n                )}\n            </div>\n\n            <div\n                className={classNames('modal-body', additionalBodyClassName)}\n                data-test=\"modal-body\"\n            >\n                {children}\n            </div>\n\n            {Boolean(footer) && (\n                <div className=\"modal-footer\" data-test=\"modal-footer\">\n                    {footer}\n                </div>\n            )}\n        </ReactModal>\n    );\n};\n\nexport default Modal;\n","import classNames from 'classnames';\nimport React, { type FieldsetHTMLAttributes, forwardRef, type ReactNode, type Ref } from 'react';\n\nexport interface FieldsetProps extends FieldsetHTMLAttributes<HTMLFieldSetElement> {\n    additionalClassName?: string;\n    testId?: string;\n    legend?: ReactNode;\n}\n\nconst Fieldset = forwardRef(\n    (\n        { additionalClassName, children, className, legend, testId, ...rest }: FieldsetProps,\n        ref: Ref<HTMLFieldSetElement>,\n    ) => (\n        <fieldset\n            {...rest}\n            className={className || classNames('form-fieldset', additionalClassName)}\n            data-test={testId}\n            ref={ref}\n        >\n            {legend}\n\n            <div className=\"form-body\">{children}</div>\n        </fieldset>\n    ),\n);\n\nexport default Fieldset;\n","import { noop } from 'lodash';\nimport { createContext } from 'react';\n\nexport interface AccordionContextProps {\n    selectedItemId?: string;\n    onToggle(id: string): void;\n}\n\nconst AccordionContext = createContext<AccordionContextProps>({ onToggle: noop });\n\nexport default AccordionContext;\n","import React, { type FunctionComponent } from 'react';\n\nimport withIconContainer from './withIconContainer';\n\nconst IconChevronDown: FunctionComponent = () => (\n    <svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z\" />\n    </svg>\n);\n\nexport default withIconContainer(IconChevronDown);\n","import React, { type FunctionComponent } from 'react';\n\nimport './Tooltip.scss';\n\nexport interface TooltipProps {\n    children: React.ReactNode;\n    testId?: string;\n}\n\nconst Tooltip: FunctionComponent<TooltipProps> = ({ children, testId }) => (\n    <span className=\"tooltip tooltip--basic\" data-test={testId}>\n        {children}\n    </span>\n);\n\nexport default Tooltip;\n","import React, { type FunctionComponent } from 'react';\n\nimport withIconContainer from './withIconContainer';\n\nconst IconError: FunctionComponent = () => (\n    <svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z\" />\n    </svg>\n);\n\nexport default withIconContainer(IconError);\n","import React, { type FunctionComponent } from 'react';\n\nimport withIconContainer from './withIconContainer';\n\nconst IconSuccess: FunctionComponent = () => (\n    <svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z\" />\n    </svg>\n);\n\nexport default withIconContainer(IconSuccess);\n","import React, { type FunctionComponent } from 'react';\n\nimport withIconContainer from './withIconContainer';\n\nconst IconInfo: FunctionComponent = () => (\n    <svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z\" />\n    </svg>\n);\n\nexport default withIconContainer(IconInfo);\n","import classNames from 'classnames';\nimport React, { type FunctionComponent, type ReactNode, useId } from 'react';\n\nimport { IconError, IconInfo, IconSuccess } from '../icon';\n\nexport interface AlertProps {\n    additionalClassName?: string;\n    icon?: ReactNode;\n    testId?: string;\n    type?: AlertType;\n    children?: ReactNode;\n}\n\nexport enum AlertType {\n    Error = 'error',\n    Info = 'info',\n    Success = 'success',\n    Warning = 'warning',\n}\n\nfunction renderDefaultIcon(type?: AlertType): ReactNode {\n    switch (type) {\n        case AlertType.Error:\n        case AlertType.Warning:\n            return <IconError />;\n\n        case AlertType.Success:\n            return <IconSuccess />;\n\n        case AlertType.Info:\n        default:\n            return <IconInfo />;\n    }\n}\n\nconst Alert: FunctionComponent<AlertProps> = ({\n    additionalClassName,\n    children,\n    icon,\n    testId,\n    type,\n}) => {\n    const describedBy = useId();\n\n    return (\n        <div\n            aria-describedby={describedBy}\n            className={classNames(\n                'alertBox',\n                additionalClassName,\n                { 'alertBox--info': type === AlertType.Info || !type },\n                { 'alertBox--error': type === AlertType.Error },\n                { 'alertBox--success': type === AlertType.Success },\n                { 'alertBox--warning': type === AlertType.Warning },\n            )}\n            data-test={testId}\n        >\n            <div className=\"alertBox-column alertBox-icon\">{icon || renderDefaultIcon(type)}</div>\n\n            <div\n                aria-live={type === AlertType.Error ? 'assertive' : 'polite'}\n                className=\"alertBox-column alertBox-message\"\n                id={describedBy}\n                role={type === AlertType.Error ? 'alert' : 'status'}\n            >\n                {children}\n            </div>\n        </div>\n    );\n};\n\nexport default Alert;\n","import classNames from 'classnames';\nimport React, { type FunctionComponent } from 'react';\n\ninterface ModalHeaderProps {\n    children: React.ReactNode;\n    additionalClassName?: string;\n}\n\nconst ModalHeader: FunctionComponent<ModalHeaderProps> = ({ children, additionalClassName }) => (\n    <h2\n        className={classNames(\n            'modal-header-title optimizedCheckout-headingSecondary',\n            additionalClassName,\n        )}\n        data-test=\"modal-heading\"\n    >\n        {children}\n    </h2>\n);\n\nexport default ModalHeader;\n","import { type Checkout, type StoreConfig } from '@bigcommerce/checkout-sdk';\n\nimport { getPreselectedPayment } from '../payment';\nimport getProviderWithCustomCheckout from '../payment/getProviderWithCustomCheckout';\nimport { PaymentMethodId } from '../payment/paymentMethod';\n\nexport default function getShippingMethodId(checkout: Checkout, config: StoreConfig): string | undefined {\n    const SHIPPING_METHOD_IDS: string[] = [\n        PaymentMethodId.AmazonPay,\n        PaymentMethodId.BraintreeAcceleratedCheckout,\n        PaymentMethodId.PayPalCommerceAcceleratedCheckout,\n    ];\n    const providerWithCustomCheckout = getProviderWithCustomCheckout(\n        config.checkoutSettings?.providerWithCustomCheckout,\n    );\n    const preselectedPayment = getPreselectedPayment(checkout);\n\n    if (preselectedPayment && SHIPPING_METHOD_IDS.includes(preselectedPayment.providerId)) {\n        return preselectedPayment.providerId;\n    }\n\n    return providerWithCustomCheckout && SHIPPING_METHOD_IDS.includes(providerWithCustomCheckout)\n        ? providerWithCustomCheckout\n        : undefined;\n}\n","import { type Cart } from '@bigcommerce/checkout-sdk';\n\nexport default function hasPromotionalItems(cart: Cart): boolean {\n    const { digitalItems = [], physicalItems } = cart.lineItems;\n    \n    return [...digitalItems, ...physicalItems].filter((item) => item.addedByPromotion)?.length > 0;\n}\n","import {\n    type FormikProps,\n    type FormikValues,\n    withFormik,\n    type WithFormikConfig,\n} from 'formik';\nimport React, {\n    type ComponentType,\n    useEffect,\n    useRef,\n} from 'react';\n\nexport interface WithFormikExtendedProps {\n    isInitialValueLoaded?: boolean;\n}\n\n/**\n * This HOC extends the behavior of the default `withFormik` HOC. It can reset a form to its initial state when\n * the `isInitialValueLoaded` prop is set to true. This is useful when a form needs to be rendered before its\n * initial value is fully loaded.\n */\nexport default function withFormikExtended<\n    TOuterProps extends object,\n    TValues extends FormikValues = FormikValues,\n    TPayload = TValues\n>(\n    config: WithFormikConfig<TOuterProps, TValues, TPayload>\n) {\n    return (\n        OriginalComponent: ComponentType<TOuterProps & FormikProps<TValues>>\n    ) => {\n        const DecoratedComponent: ComponentType<\n            TOuterProps & FormikProps<TValues> & WithFormikExtendedProps\n        > = (props) => {\n            const { resetForm, isInitialValueLoaded, initialValues } = props;\n            const previousIsInitialValueLoadedRef = useRef(isInitialValueLoaded);\n\n            useEffect(() => {\n                if (\n                    previousIsInitialValueLoadedRef.current === false &&\n                    isInitialValueLoaded === true\n                ) {\n                    resetForm({ values: initialValues ?? {} });\n                }\n\n                previousIsInitialValueLoadedRef.current = isInitialValueLoaded;\n            }, [isInitialValueLoaded, initialValues, resetForm]);\n\n            return <OriginalComponent {...props} />;\n        };\n\n        DecoratedComponent.displayName = `WithFormikExtended(${\n            OriginalComponent.displayName || OriginalComponent.name\n        })`;\n\n        return withFormik(config)(DecoratedComponent);\n    };\n}\n","import { type Address, type FormField } from '@bigcommerce/checkout-sdk';\nimport { type FormikProps, withFormik } from 'formik';\nimport React, { type FunctionComponent } from 'react';\nimport { lazy } from 'yup';\n\nimport { TranslatedString, withLanguage, type WithLanguageProps } from '@bigcommerce/checkout/locale';\nimport { LoadingOverlay } from '@bigcommerce/checkout/ui';\n\nimport { Button, ButtonVariant } from '../ui/button';\nimport { Form } from '../ui/form';\nimport { Modal, ModalHeader } from '../ui/modal';\n\nimport AddressForm from './AddressForm';\nimport AddressType from './AddressType';\nimport getAddressFormFieldsValidationSchema from './getAddressFormFieldsValidationSchema';\nimport mapAddressToFormValues, { type AddressFormValues } from './mapAddressToFormValues';\n\nexport interface AddressFormModalProps extends AddressFormProps {\n    isOpen: boolean;\n    onAfterOpen?(): void;\n}\n\nexport interface AddressFormProps {\n    isLoading: boolean;\n    shouldShowSaveAddress?: boolean;\n    defaultCountryCode?: string;\n    getFields(countryCode?: string): FormField[];\n    onSaveAddress(address: AddressFormValues): void;\n    onRequestClose?(): void;\n    selectedAddress?: Address;\n}\n\nconst SaveAddress: FunctionComponent<\n    AddressFormProps & WithLanguageProps & FormikProps<AddressFormValues>\n> = ({\n    getFields,\n    values,\n    setFieldValue,\n    isLoading,\n    onRequestClose,\n}) => (\n    <Form autoComplete=\"on\">\n        <LoadingOverlay isLoading={isLoading}>\n            <AddressForm\n                countryCode={values.countryCode}\n                formFields={getFields(values.countryCode)}\n                setFieldValue={setFieldValue}\n                shouldShowSaveAddress={false}\n                type={AddressType.Shipping}\n            />\n            <div className=\"form-actions\">\n                <Button\n                    onClick={onRequestClose}\n                    variant={ButtonVariant.Secondary}>\n                    <TranslatedString id=\"common.cancel_action\" />\n                </Button>\n\n                <Button\n                    disabled={isLoading}\n                    id=\"checkout-save-address\"\n                    type=\"submit\"\n                    variant={ButtonVariant.Primary}\n                >\n                    <TranslatedString id=\"address.save_address_action\" />\n                </Button>\n            </div>\n        </LoadingOverlay>\n    </Form>\n);\n\nconst SaveAddressForm = withLanguage(\n    withFormik<AddressFormProps & WithLanguageProps, AddressFormValues>({\n        handleSubmit: (values, { props: { onSaveAddress } }) => {\n            onSaveAddress(values);\n        },\n        mapPropsToValues: ({ getFields, selectedAddress }) => {\n            return mapAddressToFormValues(\n                getFields(selectedAddress && selectedAddress.countryCode),\n                selectedAddress,\n            )\n        },\n        validationSchema: ({ language, getFields }: AddressFormProps & WithLanguageProps) =>\n            lazy<Partial<AddressFormValues>>((values) =>\n                getAddressFormFieldsValidationSchema({\n                    language,\n                    formFields: getFields(values && values.countryCode),\n                }),\n            ),\n    })(SaveAddress),\n);\n\nconst AddressFormModal: FunctionComponent<AddressFormModalProps> = ({\n    isOpen,\n    onAfterOpen,\n    onRequestClose,\n    ...addressFormProps\n}) => (\n    <Modal\n        additionalModalClassName=\"modal--medium\"\n        header={\n            <ModalHeader>\n                <TranslatedString id=\"address.add_address_heading\" />\n            </ModalHeader>\n        }\n        isOpen={isOpen}\n        onAfterOpen={onAfterOpen}\n        onRequestClose={onRequestClose}\n        shouldShowCloseButton={true}\n    >\n        <SaveAddressForm {...addressFormProps} onRequestClose={onRequestClose} />\n    </Modal>\n);\n\nexport default AddressFormModal;\n","import { getLanguageService } from '@bigcommerce/checkout/locale';\n\nimport { CustomError, setPrototypeOf } from '../../common/error';\n\nexport default class AssignItemInvalidAddressError extends CustomError {\n    constructor(data?: Error) {\n        /* istanbul ignore next */\n        super({\n            name: 'ASSIGN_ITEM_INVALID_ADDRESS',\n            message: getLanguageService().translate('shipping.assign_item_invalid_address_error'),\n            title: getLanguageService().translate(\n                'shipping.assign_item_invalid_address_error_heading',\n            ),\n            data,\n        });\n\n        setPrototypeOf(this, AssignItemInvalidAddressError.prototype);\n    }\n}\n","import { getLanguageService } from '@bigcommerce/checkout/locale';\n\nimport { CustomError, setPrototypeOf } from '../../common/error';\n\nexport default class AssignItemFailedError extends CustomError {\n    constructor(data: Error) {\n        /* istanbul ignore next */\n        super({\n            name: 'ASSIGN_ITEM_FAILED',\n            message: getLanguageService().translate('shipping.assign_item_error'),\n            data,\n        });\n\n        setPrototypeOf(this, AssignItemFailedError.prototype);\n    }\n}\n","import React, { type FunctionComponent } from 'react';\n\nimport withIconContainer from './withIconContainer';\n\nconst IconEdit: FunctionComponent = () => (\n    <svg fill=\"none\" height=\"20\" viewBox=\"0 0 20 20\" width=\"20\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M2.49902 14.5511V17.0844C2.49902 17.3178 2.68236 17.5011 2.91569 17.5011H5.44902C5.55736 17.5011 5.66569 17.4594 5.74069 17.3761L14.8407 8.28444L11.7157 5.15944L2.62402 14.2511C2.54069 14.3344 2.49902 14.4344 2.49902 14.5511ZM17.2574 5.86777C17.5824 5.54277 17.5824 5.01777 17.2574 4.69277L15.3074 2.74277C14.9824 2.41777 14.4574 2.41777 14.1324 2.74277L12.6074 4.26777L15.7324 7.39277L17.2574 5.86777Z\" />\n    </svg>\n);\n\nexport default withIconContainer(IconEdit);\n","import { type Address } from '@bigcommerce/checkout-sdk';\nimport React from \"react\";\n\nimport { preventDefault } from \"@bigcommerce/checkout/dom-utils\";\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\nimport { IconEdit, useThemeContext } from '@bigcommerce/checkout/ui';\n\nimport SingleLineStaticAddress from '../address/SingleLineStaticAddress';\n\ninterface GuestCustomerAddressSelectorProps {\n    onUseNewAddress(): void;\n    selectedAddress?: Address;\n}\n\nconst GuestCustomerAddressSelector = ({ onUseNewAddress, selectedAddress }: GuestCustomerAddressSelectorProps) => {\n    const { themeV2 } = useThemeContext();\n\n    return <div className='guest-consignment-line-item-header'>\n        {\n            !selectedAddress\n                ? <>\n                    <h3 className={themeV2 ? 'body-bold' : ''}>\n                        <TranslatedString id=\"shipping.guest_multishipping_no_shipping_address_message\" />\n                    </h3>\n                    <a\n                        className={themeV2 ? 'body-cta' : ''}\n                        data-test=\"enter-shipping-address\"\n                        href=\"#\"\n                        onClick={preventDefault(onUseNewAddress)}\n                    >\n                        <TranslatedString id=\"shipping.guest_multishipping_enter_shipping_address_action\" />\n                    </a>\n                </>\n                : <>\n                    <SingleLineStaticAddress address={selectedAddress} />\n                    <a\n                        className={themeV2 ? 'body-cta' : ''}\n                        data-test=\"edit-shipping-address\"\n                        href=\"#\"\n                        onClick={preventDefault(onUseNewAddress)}\n                    >\n                        <IconEdit />\n                    </a>\n                </>\n        }\n    </div>;\n}\n\nexport default GuestCustomerAddressSelector;\n","import { type CheckoutSelectors, type Consignment, type ShippingRequestOptions } from '@bigcommerce/checkout-sdk';\n\nconst createShippingOptionsMap = (consignments: Consignment[]): Map<string, string | undefined> => {\n    return new Map(\n        consignments.map((consignment) => [consignment.id, consignment.selectedShippingOption?.id]),\n    );\n};\n\nexport const setRecommendedOrMissingShippingOption = async (\n    previousConsignment: Consignment[],\n    currentConsignments: Consignment[],\n    selectConsignmentShippingOption: (\n        consignmentId: string,\n        shippingOptionId: string,\n        options?: ShippingRequestOptions<object>,\n    ) => Promise<CheckoutSelectors>,\n): Promise<void> => {\n    const previousShippingOptions = createShippingOptionsMap(previousConsignment);\n\n    for (const consignment of currentConsignments) {\n        if (!consignment.selectedShippingOption) {\n            const previousShippingOptionId = previousShippingOptions.get(consignment.id);\n\n            if (previousShippingOptionId) {\n                // eslint-disable-next-line no-await-in-loop\n                await selectConsignmentShippingOption(consignment.id, previousShippingOptionId);\n\n                continue;\n            }\n\n            const recommendedOption = consignment.availableShippingOptions?.find(\n                (option) => option.isRecommended,\n            );\n\n            if (recommendedOption) {\n                // eslint-disable-next-line no-await-in-loop\n                await selectConsignmentShippingOption(consignment.id, recommendedOption.id);\n            }\n        }\n    }\n};\n","import { type Address, type ConsignmentCreateRequestBody } from \"@bigcommerce/checkout-sdk\";\nimport React, { useState } from \"react\";\n\nimport { TranslatedString } from \"@bigcommerce/checkout/locale\";\nimport { useCheckout } from \"@bigcommerce/checkout/payment-integration-api\";\n\nimport { AddressFormModal, type AddressFormValues, AddressSelect, AddressType, isValidAddress, mapAddressFromFormValues } from \"../address\";\nimport { ErrorModal } from \"../common/error\";\nimport { EMPTY_ARRAY } from \"../common/utility\";\n\nimport { AssignItemFailedError, AssignItemInvalidAddressError } from \"./errors\";\nimport GuestCustomerAddressSelector from \"./GuestCustomerAddressSelector\";\nimport { type MultiShippingConsignmentData } from \"./MultishippingType\";\nimport { setRecommendedOrMissingShippingOption } from './utils';\n\ninterface ConsignmentAddressSelectorProps {\n    consignment?: MultiShippingConsignmentData;\n    defaultCountryCode?: string;\n    isLoading: boolean;\n    onUnhandledError(error: Error): void;\n    setConsignmentRequest?(consignmentRequest: ConsignmentCreateRequestBody): void;\n    selectedAddress?: Address;\n}\n\nconst ConsignmentAddressSelector = ({\n    consignment,\n    defaultCountryCode,\n    isLoading,\n    onUnhandledError,\n    selectedAddress,\n    setConsignmentRequest,\n}: ConsignmentAddressSelectorProps) => {\n    const [isOpenNewAddressModal, setIsOpenNewAddressModal] = useState(false);\n    const [createCustomerAddressError, setCreateCustomerAddressError] = useState<Error>();\n\n    const {\n        checkoutState: {\n            data: {\n                getCustomer,\n                getConfig,\n                getConsignments: getPreviousConsignments,\n                getShippingAddressFields: getFields,\n            },\n        },\n        checkoutService: {\n            updateConsignment,\n            createCustomerAddress,\n            selectConsignmentShippingOption,\n        },\n    } = useCheckout();\n\n    const customer = getCustomer();\n    const config = getConfig();\n\n    if (!config || !customer) {\n        return null;\n    }\n\n    // TODO: add filter for addresses\n    const addresses = customer.addresses || EMPTY_ARRAY;\n\n    const isGuest = customer.isGuest;\n\n    const handleSelectAddress = async (address: Address) => {\n        if (!isValidAddress(address, getFields(address.countryCode))) {\n            return onUnhandledError(new AssignItemInvalidAddressError());\n        }\n\n        if (!consignment) {\n            setConsignmentRequest?.({\n                address,\n                shippingAddress: address,\n                lineItems: [],\n            });\n\n            return;\n        }\n\n        try {\n            const {\n                data: { getConsignments },\n            } = await updateConsignment({\n                id: consignment.id,\n                address,\n                shippingAddress: address,\n                lineItems: consignment.lineItems.map(({ id, quantity }) => ({ itemId: id, quantity })),\n            });\n\n            const currentConsignments = getConsignments();\n\n            if (currentConsignments && currentConsignments.length > 0) {\n                await setRecommendedOrMissingShippingOption(\n                    getPreviousConsignments() ?? [],\n                    currentConsignments,\n                    selectConsignmentShippingOption,\n                );\n            }\n        } catch (error) {\n            if (error instanceof Error) {\n                onUnhandledError(new AssignItemFailedError(error));\n            }\n        }\n    }\n\n    const handleUseNewAddress = () => {\n        setIsOpenNewAddressModal(true);\n    }\n\n    const handleCloseAddAddressForm = () => {\n        setIsOpenNewAddressModal(false);\n    }\n\n    const handleSaveAddress = async (addressFormValues: AddressFormValues) => {\n        const address = mapAddressFromFormValues(addressFormValues);\n\n        await handleSelectAddress(address);\n\n        if (!isGuest) {\n            try {\n                await createCustomerAddress(address);\n            } catch (error) {\n                if (error instanceof Error) {\n                    setCreateCustomerAddressError(error);\n                }\n            }\n        }\n\n        setIsOpenNewAddressModal(false);\n    }\n\n    const handleCloseErrorModal = () => {\n        setCreateCustomerAddressError(undefined);\n    }\n\n    return (\n        <>\n            <ErrorModal\n                error={createCustomerAddressError}\n                message={\n                    <>\n                        <TranslatedString id=\"address.consignment_address_updated_text\" />{' '}\n                        <TranslatedString id=\"customer.create_address_error\" />\n                    </>\n                }\n                onClose={handleCloseErrorModal}\n                shouldShowErrorCode={false}\n            />\n            <AddressFormModal\n                defaultCountryCode={defaultCountryCode}\n                getFields={getFields}\n                isLoading={isLoading}\n                isOpen={isOpenNewAddressModal}\n                onRequestClose={handleCloseAddAddressForm}\n                onSaveAddress={handleSaveAddress}\n                selectedAddress={isGuest ? selectedAddress : undefined}\n            />\n            {isGuest\n                ? <GuestCustomerAddressSelector\n                    onUseNewAddress={handleUseNewAddress}\n                    selectedAddress={selectedAddress}\n                />\n                : <AddressSelect\n                    addresses={addresses}\n                    onSelectAddress={handleSelectAddress}\n                    onUseNewAddress={handleUseNewAddress}\n                    placeholderText={<TranslatedString id=\"shipping.choose_shipping_address\" />}\n                    selectedAddress={selectedAddress}\n                    showSingleLineAddress\n                    type={AddressType.Shipping}\n                />\n            }\n        </>\n    )\n}\n\nexport default ConsignmentAddressSelector;\n","import React, { type FunctionComponent } from \"react\";\n\nimport { TranslatedString } from \"@bigcommerce/checkout/locale\";\nimport { IconHelp, TooltipTrigger } from \"@bigcommerce/checkout/ui\";\n\nimport { Tooltip } from \"../ui/tooltip\";\nimport \"./ItemSplitTooltip.scss\";\n\nexport const ItemSplitTooltip: FunctionComponent = () => {\n    return (\n        <TooltipTrigger\n            placement=\"right-start\"\n            tooltip={\n                <Tooltip>\n                    <TranslatedString\n                        id=\"shipping.multishipping_item_split_tooltip_message\"\n                    />\n                </Tooltip>\n            }\n        >\n            <span className=\"item-split-tooltip\" data-test=\"split-item-tooltip\">\n                <IconHelp />\n            </span>\n        </TooltipTrigger>\n    )\n};\n","import React from \"react\";\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\nimport { useThemeContext } from '@bigcommerce/checkout/ui';\n\nimport { IconClose } from \"../ui/icon\";\n\nimport { renderItemContent } from \"./ConsignmentLineItemDetail\";\nimport { ItemSplitTooltip } from \"./ItemSplitTooltip\";\nimport { type MultiShippingTableData, type MultiShippingTableItemWithType } from \"./MultishippingType\";\n\ninterface AllocatedItemsListProps {\n    assignedItems: MultiShippingTableData;\n    onUnassignItem(itemToDelete: MultiShippingTableItemWithType): void;\n}\n\nconst AllocatedItemsList = ({ assignedItems, onUnassignItem }: AllocatedItemsListProps) => {\n    const { themeV2 } = useThemeContext();\n\n    return (\n        <div className=\"allocated-line-items\">\n            <h3 className={themeV2 ? 'body-bold' : ''}>\n                <TranslatedString data={{ count: assignedItems.shippableItemsCount }} id=\"shipping.multishipping_item_allocated_message\" />\n                {assignedItems.hasSplitItems && (\n                    <ItemSplitTooltip />\n                )}\n            </h3>\n            <ul className=\"allocated-line-items-list\">\n                {assignedItems.lineItems.map(item => (\n                    <li key={item.id}>\n                        {renderItemContent(item, themeV2)}\n                        <span data-test={`remove-${item.id.toString()}-button`} onClick={() => onUnassignItem(item)}>\n                            <IconClose />\n                        </span>\n                    </li>\n                ))}\n            </ul>\n        </div>\n    );\n}\n\nexport default AllocatedItemsList;\n","import classNames from \"classnames\";\nimport React, { type FunctionComponent } from \"react\";\n\nimport { TranslatedString } from \"@bigcommerce/checkout/locale\";\nimport { useThemeContext } from '@bigcommerce/checkout/ui';\n\nimport { FormField, TextInput } from \"../ui/form\";\nimport { isMobileView as isMobileViewUI } from \"../ui/responsive\";\n\nimport { type MultiShippingTableItemWithType } from \"./MultishippingType\";\n\ninterface LeftToAllocateItemProps {\n    item: MultiShippingTableItemWithType;\n    error?: string;\n}\n\nconst LeftToAllocateItem: FunctionComponent<LeftToAllocateItemProps> = ({ item, error }: LeftToAllocateItemProps) => {\n    const isMobileView = isMobileViewUI();\n    const { themeV2 } = useThemeContext();\n\n    return (\n        <tr>\n            <td className=\"left-to-allocate-item-name-container\">\n                <figure className=\"left-to-allocate-item-figure\">\n                    {item.imageUrl && <img alt={item.name} src={item.imageUrl} />}\n                </figure>\n                <div>\n                    <p className={classNames('left-to-allocate-item-name',\n                        { 'body-regular': themeV2 })}>\n                        {item.name}\n                    </p>\n                    {item.options?.map(option => (\n                        <p className={classNames('left-to-allocate-item-option',\n                            { 'sub-text-medium': themeV2 })}\n                            key={option.nameId}>\n                            {option.name}: {option.value}\n                        </p>\n                    ))}\n                </div>\n            </td>\n            {!isMobileView && <td className={themeV2 ? 'body-regular' : ''}>{item.quantity}</td>}\n            <td className={themeV2 ? 'body-regular' : ''}>\n                {isMobileView && <TranslatedString data={{ count: item.quantity }} id=\"shipping.multishipping_left_to_allocate_message\" />}\n                <FormField\n                    additionalClassName={error ? \"form-field--error\" : \"\"}\n                    input={({ field }) => <TextInput\n                        {...field}\n                        aria-label={`Quantity of ${item.name}`}\n                        disabled={item.quantity === 0}\n                        id={field.name}\n                        min={0}\n                        themeV2={themeV2}\n                        type=\"number\"\n                    />}\n                    name={item.id.toString()}\n                />\n            </td>\n        </tr>\n    );\n}\n\nexport default LeftToAllocateItem;\n","import { type FormikErrors } from \"formik\";\nimport React, { type FunctionComponent } from \"react\";\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\nimport { useThemeContext } from '@bigcommerce/checkout/ui';\n\nimport { isMobileView as isMobileViewUI } from \"../ui/responsive\";\n\nimport { type AllocateItemsModalFormValues } from \"./AllocateItemsModal\";\nimport LeftToAllocateItem from \"./LeftToAllocateItem\";\nimport { type MultiShippingTableItemWithType } from \"./MultishippingType\";\n\ninterface LeftToAllocateItemsTableProps {\n    items: MultiShippingTableItemWithType[];\n    formErrors: FormikErrors<AllocateItemsModalFormValues>;\n}\n\nconst LeftToAllocateItemsTable: FunctionComponent<LeftToAllocateItemsTableProps> = ({ items, formErrors }: LeftToAllocateItemsTableProps) => {\n    const isMobileView = isMobileViewUI();\n    const { themeV2 } = useThemeContext();\n\n    return (\n        <table className=\"table left-to-allocate-items-table\">\n            <thead>\n                <tr>\n                    <th className={themeV2 ? 'body-medium' : ''}><TranslatedString id=\"shipping.multishipping_left_to_allocate_items_table_item\" /></th>\n                    {!isMobileView && <th className={themeV2 ? 'body-medium' : ''}><TranslatedString id=\"shipping.multishipping_left_to_allocate_items_table_left_to_allocate\" /></th>}\n                    <th className={themeV2 ? 'body-medium' : ''}><TranslatedString id=\"shipping.multishipping_left_to_allocate_items_table_quantity\" /></th>\n                </tr>\n            </thead>\n            <tbody>\n                {items.map(item => (\n                    <LeftToAllocateItem\n                        error={formErrors[item.id.toString()]}\n                        item={item}\n                        key={item.id}\n                    />\n                ))}\n            </tbody>\n        </table>\n    );\n}\n\nexport default LeftToAllocateItemsTable;\n","import { type Consignment, type LineItemOption, type PhysicalItem } from \"@bigcommerce/checkout-sdk\";\n\nexport enum LineItemType {\n    Physical,\n    Digital,\n    GiftCertificate,\n    Custom,\n}\n\nexport interface MultiShippingTableItem {\n    name: string;\n    options?: LineItemOption[];\n    giftWrapping?: PhysicalItem['giftWrapping'];\n    sku: string;\n    quantity: number;\n    id: string | number;\n    imageUrl?: string;\n}\n\nexport interface MultiShippingTableItemWithType extends MultiShippingTableItem {\n    type: LineItemType;\n}\n\nexport interface MultiShippingTableData {\n    lineItems: MultiShippingTableItemWithType[];\n    hasDigitalItems: boolean;\n    hasSplitItems: boolean;\n    shippableItemsCount: number;\n};\n\nexport interface MultiShippingConsignmentData extends Consignment, MultiShippingTableData {\n    consignmentNumber: number;\n}\n","import { type Address, type ConsignmentLineItem } from \"@bigcommerce/checkout-sdk\";\nimport { type FormikProps } from \"formik\";\nimport React, { type FunctionComponent, useMemo } from \"react\";\nimport { number, object } from \"yup\";\n\nimport { preventDefault } from \"@bigcommerce/checkout/dom-utils\";\nimport { TranslatedString, withLanguage, type WithLanguageProps } from \"@bigcommerce/checkout/locale\";\nimport { Alert, AlertType, ButtonVariant, useThemeContext } from \"@bigcommerce/checkout/ui\";\n\nimport { getAddressContent } from \"../address/SingleLineStaticAddress\";\nimport { withFormikExtended } from \"../common/form\";\nimport { Button } from \"../ui/button\";\nimport { Form } from \"../ui/form\";\nimport { Modal, ModalHeader } from \"../ui/modal\";\n\nimport AllocatedItemsList from \"./AllocatedItemsList\";\nimport { ItemSplitTooltip } from \"./ItemSplitTooltip\";\nimport LeftToAllocateItemsTable from \"./LeftToAllocateItemsTable\";\nimport { LineItemType, type MultiShippingTableData, type MultiShippingTableItemWithType } from \"./MultishippingType\";\n\nexport interface AllocateItemsModalFormValues {\n    [key: string]: number;\n}\n\ninterface AllocateItemsModalProps {\n    consignmentNumber: number;\n    isOpen: boolean;\n    onRequestClose?(): void;\n    address: Address;\n    unassignedItems: MultiShippingTableData;\n    assignedItems?: MultiShippingTableData;\n    onAllocateItems(consignmentLineItems: ConsignmentLineItem[]): void;\n    onUnassignItem?(itemToDelete: MultiShippingTableItemWithType): void;\n    isLoading: boolean;\n}\n\nconst AllocateItemsModal: FunctionComponent<AllocateItemsModalProps & FormikProps<AllocateItemsModalFormValues>> = ({\n    consignmentNumber,\n    isOpen,\n    onRequestClose,\n    address,\n    assignedItems,\n    unassignedItems,\n    setValues,\n    values,\n    dirty,\n    submitForm,\n    errors,\n    onUnassignItem,\n    isLoading,\n}: AllocateItemsModalProps & FormikProps<AllocateItemsModalFormValues>) => {\n\n    const { themeV2 } = useThemeContext();\n\n    const allocatedOrSelectedItemsMessage = useMemo(() => {\n        const leftItemsTotal = unassignedItems.shippableItemsCount;\n\n        if (values && dirty) {\n            const selectedItems = Object.keys(values).reduce((acc, key) => {\n                if (values[key] > 0) {\n                    acc += values[key];\n                }\n\n                return acc;\n            }, 0);\n\n            return <TranslatedString data={{ count: `${selectedItems}/${leftItemsTotal}` }} id=\"shipping.multishipping_items_selected_message\" />;\n        }\n\n        return <TranslatedString data={{ count: leftItemsTotal }} id=\"shipping.multishipping_item_to_allocate_message\" />;\n    }, [values]);\n\n    const handleSelectAll = () => {\n        const values: AllocateItemsModalFormValues = {};\n\n        unassignedItems.lineItems.forEach(item => {\n            values[item.id.toString()] = item.quantity;\n        });\n        setValues(values);\n    };\n\n    const handleClearAll = () => {\n        const values: AllocateItemsModalFormValues = {};\n\n        unassignedItems.lineItems.forEach(item => {\n            values[item.id.toString()] = 0;\n        });\n        setValues(values);\n    }\n\n    const formErrors = useMemo(() => {\n        const errorKeys = Object.keys(errors);\n\n        return errorKeys.reduce((acc: string[], key: string) => {\n            const error = errors[key];\n\n            if (error) {\n                acc.push(error);\n            }\n\n            return Array.from(new Set(acc));\n        }, []);\n    }, [errors]);\n\n    const hasItemsAssigned = !!assignedItems && assignedItems.lineItems.length > 0 && !!onUnassignItem;\n    const hasUnassignedItems = !!unassignedItems && unassignedItems.lineItems.length > 0;\n\n    const modalFooter = (\n        <>\n            <Button\n                className={themeV2 ? 'body-medium' : ''}\n                disabled={isLoading}\n                onClick={onRequestClose}\n                variant={ButtonVariant.Secondary}\n            >\n                <TranslatedString id=\"shipping.multishipping_items_allocate_cancel\" />\n            </Button>\n            <Button\n                className={themeV2 ? 'body-medium' : ''}\n                disabled={!hasItemsAssigned && !dirty}\n                isLoading={isLoading}\n                onClick={submitForm}\n                type=\"submit\"\n                variant={ButtonVariant.Primary}\n            >\n                {hasItemsAssigned\n                    ? <TranslatedString id=\"shipping.multishipping_items_allocate_save\" />\n                    : <TranslatedString id=\"shipping.multishipping_items_allocate_allocate\" />\n                }\n            </Button>\n        </>\n    );\n\n    return (\n        <Modal\n            additionalModalClassName=\"allocate-items-modal\"\n            footer={modalFooter}\n            header={\n                <>\n                    <ModalHeader additionalClassName={themeV2 ? 'header' : ''}>\n                        <TranslatedString data={{ consignmentNumber }} id=\"shipping.multishipping_consignment_index_heading\" />\n                    </ModalHeader>\n                    <h4 className={themeV2 ? 'body-medium' : ''}>{getAddressContent(address)}</h4>\n                </>\n            }\n            isOpen={isOpen}\n            onRequestClose={onRequestClose}\n        >\n            <Form>\n                {formErrors.length > 0 && (\n                    <div className=\"form-errors\">\n                        {formErrors.map((error, index) => (\n                            <Alert key={index} type={AlertType.Error}>{error}</Alert>\n                        ))}\n                    </div>\n                )}\n                {unassignedItems.hasDigitalItems && (\n                    <Alert type={AlertType.Info}>\n                        <TranslatedString id=\"shipping.multishipping_digital_item_no_shipping_banner\" />\n                    </Alert>\n                )}\n                {hasItemsAssigned && (\n                    <AllocatedItemsList assignedItems={assignedItems} onUnassignItem={onUnassignItem} />\n                )}\n                {hasUnassignedItems\n                    ? <>\n                        <div className=\"left-to-allocate-items-table-actions\">\n                            <p className={themeV2 ? 'body-regular' : ''}>\n                                {allocatedOrSelectedItemsMessage}\n                                {unassignedItems.hasSplitItems && (\n                                    <ItemSplitTooltip />\n                                )}\n                            </p>\n\n                            <div className=\"button-group\">\n                                <a\n                                    className={themeV2 ? 'body-cta' : ''}\n                                    data-test=\"clear-all-items-button\"\n                                    href=\"#\"\n                                    onClick={preventDefault(handleClearAll)}\n                                >\n                                    <TranslatedString id=\"shipping.multishipping_items_allocate_clear_all\" />\n                                </a>\n                                <a\n                                    className={themeV2 ? 'body-cta' : ''}\n                                    data-test=\"allocate-all-items-button\"\n                                    href=\"#\"\n                                    onClick={preventDefault(handleSelectAll)}\n                                >\n                                    <TranslatedString id=\"shipping.multishipping_items_allocate_select_all_items_left\" />\n                                </a>\n                            </div>\n                        </div>\n                        <LeftToAllocateItemsTable\n                            formErrors={errors}\n                            items={unassignedItems.lineItems}\n                        />\n                    </>\n                    : null\n                }\n            </Form>\n        </Modal>\n    )\n}\n\nexport default withLanguage(\n    withFormikExtended<AllocateItemsModalProps & WithLanguageProps, AllocateItemsModalFormValues>({\n        handleSubmit: (values, { props: { onAllocateItems } }) => {\n            const consignmentLineItems = Object.keys(values).filter(key => values[key] > 0).map((lineItemId: string) => ({\n                itemId: lineItemId,\n                quantity: values[lineItemId],\n            }));\n\n            onAllocateItems(consignmentLineItems);\n        },\n        mapPropsToValues: ({ unassignedItems }) => {\n            const values: AllocateItemsModalFormValues = {};\n\n            unassignedItems.lineItems.forEach(item => {\n                values[item.id.toString()] = 0;\n            });\n\n            return values;\n        },\n        enableReinitialize: true,\n        validationSchema: ({ language, unassignedItems }: AllocateItemsModalProps & WithLanguageProps) => {\n            const createItemSchema = (item: MultiShippingTableItemWithType) => {\n                const baseSchema = number()\n                    .required(language.translate('shipping.quantity_required_error'))\n                    .integer(language.translate('shipping.quantity_invalid_error'))\n                    .min(0, language.translate('shipping.quantity_min_error'))\n                    .max(item.quantity, language.translate('shipping.quantity_max_error'))\n\n                if (item.type === LineItemType.Custom) {\n                    return baseSchema\n                        .oneOf([0, item.quantity], language.translate('shipping.custom_item_quantity_error'))\n                }\n\n                return baseSchema;\n            };\n\n            const schemaObject = Object.fromEntries(\n                unassignedItems.lineItems.map((item) => [item.id.toString(), createItemSchema(item)]),\n            );\n\n            return object().shape(schemaObject);\n        },\n        validateOnBlur: true,\n        validateOnChange: false,\n    })(AllocateItemsModal),\n);\n","import { getLanguageService } from '@bigcommerce/checkout/locale';\n\nimport { CustomError, setPrototypeOf } from '../../common/error';\n\nexport default class UnassignItemError extends CustomError {\n    constructor(data: Error) {\n        /* istanbul ignore next */\n        super({\n            name: 'UNASSIGN_ITEM_FAILED',\n            message: getLanguageService().translate('shipping.unassign_item_error'),\n            data,\n        });\n\n        setPrototypeOf(this, UnassignItemError.prototype);\n    }\n}\n","import { type Consignment, type ConsignmentCreateRequestBody } from \"@bigcommerce/checkout-sdk\";\n\nimport { useCheckout } from \"@bigcommerce/checkout/payment-integration-api\";\n\nexport const useDeallocateItem = () => {\n    const {\n        checkoutService: { createConsignments, deleteConsignment },\n    } = useCheckout();\n\n    // this is a workaround to handle removing an item from a consignment\n    // current consignment API does not support removing an item directly - Oct 2024\n\n    const deleteItem = async (consignmentRequest: ConsignmentCreateRequestBody, itemId: string, consignment: Consignment) => {\n        let consignmentIdToBeDeleted: string | undefined = consignment.id;\n\n        if (consignment.lineItemIds.length > 1) {\n            const checkoutResponse = await createConsignments([consignmentRequest]);\n\n            const consignmentsReponse = checkoutResponse.data.getConsignments();\n\n            consignmentIdToBeDeleted = consignmentsReponse?.find((c) =>\n                c.lineItemIds.find((lineItemId) => lineItemId === itemId),\n            )?.id;\n        }\n\n        if (!consignmentIdToBeDeleted) {\n            throw new Error('Unable to find consignment to delete');\n        }\n\n        deleteConsignment(consignmentIdToBeDeleted);\n    }\n\n    return deleteItem;\n}\n","import { type LineItem, type LineItemOption } from \"@bigcommerce/checkout-sdk\";\n\nconst generateHash = (values: string[]): string => {\n  return btoa(encodeURIComponent(values.join('-')));\n};\n\nconst generateProductOptionsHash = (options: LineItemOption[] | undefined): string => {\n  if (!options) {\n    return '';\n  }\n\n  return generateHash(\n    options.map((option) =>\n      generateHash([\n        option.name,\n        option.nameId.toString(),\n        option.value,\n        option.valueId ? option.valueId.toString() : '',\n      ]),\n    ),\n  );\n};\n\nexport const generateItemHash = (item: LineItem): string => {\n  return generateHash([\n    item.productId.toString(),\n    item.variantId.toString(),\n    item.sku,\n    generateProductOptionsHash(item.options),\n  ]);\n};\n","import { type Consignment, type LineItemMap } from \"@bigcommerce/checkout-sdk\";\n\nimport { useCheckout } from \"@bigcommerce/checkout/payment-integration-api\";\n\nimport { LineItemType, type MultiShippingConsignmentData, type MultiShippingTableData, type MultiShippingTableItemWithType } from \"../MultishippingType\";\nimport { generateItemHash } from \"../utils\";\n\ninterface MultiShippingConsignmentItemsHook {\n    unassignedItems: MultiShippingTableData;\n    consignmentList: MultiShippingConsignmentData[];\n}\n\n// TODO: consolidate this from /app/order/removeBundledItems\nfunction removeBundledItems(lineItems: LineItemMap): LineItemMap {\n    return {\n        ...lineItems,\n        physicalItems: lineItems.physicalItems.filter((item) => typeof item.parentId !== 'string'),\n        digitalItems: lineItems.digitalItems.filter((item) => typeof item.parentId !== 'string'),\n    };\n}\n\nconst calculateShippableItemsCount = (items: MultiShippingTableItemWithType[]): number => {\n    return items.reduce((total, item) => total + item.quantity, 0);\n};\n\nconst hasSplitItem = (\n    items: MultiShippingTableItemWithType[],\n    itemHashMap: Map<string, string>,\n  ): boolean => {\n    const processedHashes = new Set<string>();\n  \n    for (const item of items) {\n      const hash = itemHashMap.get(item.id.toString());\n\n      if (!hash) continue;\n  \n      if (processedHashes.has(hash)) {\n        return true;\n      }\n  \n      processedHashes.add(hash);\n    }\n  \n    return false;\n  };\n\nfunction mapConsignmentsItems(\n    lineItems: LineItemMap,\n    consignments: Consignment[],\n): {\n        consignmentList: MultiShippingConsignmentData[];\n        unassignedItems: MultiShippingTableData;\n    } {\n    const unassignedItemsMap = new Map<string, MultiShippingTableItemWithType>();\n    const digitalItemsMap = new Map<string, MultiShippingTableItemWithType>();\n\n    const itemHashMap = new Map<string, string>();\n\n    const consignmentList: MultiShippingConsignmentData[] = [];\n\n    lineItems.physicalItems.forEach((item) => {\n        unassignedItemsMap.set(item.id.toString(), { ...item, type: LineItemType.Physical });\n        itemHashMap.set(item.id.toString(), generateItemHash(item));\n    });\n    lineItems.customItems?.forEach((item) =>\n        unassignedItemsMap.set(item.id, { ...item, type: LineItemType.Custom }),\n    );\n    lineItems.digitalItems.forEach((item) =>\n        digitalItemsMap.set(item.id.toString(), { ...item, type: LineItemType.Digital }),\n    );\n\n    consignments.forEach((consignment, index) => {\n        const consignmentLineItems: MultiShippingTableItemWithType[] = [];\n\n        consignment.lineItemIds.forEach((itemId) => {\n            const item = unassignedItemsMap.get(itemId);\n\n            if (item) {\n                consignmentLineItems.push(item);\n                unassignedItemsMap.delete(itemId);\n            }\n        });\n\n        consignmentList.push({\n            ...consignment,\n            consignmentNumber: index + 1,\n            hasDigitalItems: false,\n            hasSplitItems: hasSplitItem(consignmentLineItems, itemHashMap),\n            shippableItemsCount: calculateShippableItemsCount(consignmentLineItems),\n            lineItems: consignmentLineItems,\n        });\n    });\n\n    const unassignedItemsList = Array.from(unassignedItemsMap.values());\n\n    const unassignedItems: MultiShippingTableData = {\n        lineItems: unassignedItemsList,\n        hasDigitalItems: digitalItemsMap.size > 0,\n        hasSplitItems: hasSplitItem(unassignedItemsList, itemHashMap),\n        shippableItemsCount: calculateShippableItemsCount(unassignedItemsList),\n    };\n\n    return { consignmentList, unassignedItems };\n}\n\nconst defaultMultiShippingConsignmentItems: MultiShippingConsignmentItemsHook = {\n    unassignedItems: {\n        lineItems: [],\n        hasDigitalItems: false,\n        hasSplitItems: false,\n        shippableItemsCount: 0,\n    },\n    consignmentList: [],\n};\n\nexport const useMultiShippingConsignmentItems = (): MultiShippingConsignmentItemsHook => {\n    const { checkoutState: {\n        data: { getCheckout },\n    },\n    } = useCheckout();\n\n    const checkout = getCheckout();\n\n    if (!checkout) {\n        return defaultMultiShippingConsignmentItems;\n    }\n\n    const {\n        cart: { lineItems },\n        consignments,\n    } = checkout;\n\n    const nonBundledLineItems = removeBundledItems(lineItems);\n\n    const { consignmentList, unassignedItems } =\n        mapConsignmentsItems(nonBundledLineItems, consignments);\n\n    return {\n        unassignedItems,\n        consignmentList,\n    };\n};\n","import { ConsignmentLineItem } from \"@bigcommerce/checkout-sdk\";\nimport classNames from \"classnames\";\nimport React, { type FunctionComponent, useState } from \"react\";\n\nimport { preventDefault } from \"@bigcommerce/checkout/dom-utils\";\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\nimport { useCheckout } from \"@bigcommerce/checkout/payment-integration-api\";\nimport { useThemeContext } from '@bigcommerce/checkout/ui';\n\nimport { IconChevronDown, IconChevronUp } from \"../ui/icon\";\nimport { isMobileView as isMobileViewUI } from \"../ui/responsive\";\n\nimport AllocateItemsModal from \"./AllocateItemsModal\";\nimport ConsignmentLineItemDetail from \"./ConsignmentLineItemDetail\";\nimport { AssignItemFailedError, UnassignItemError } from \"./errors\";\nimport { useDeallocateItem } from \"./hooks/useDeallocateItem\";\nimport { useMultiShippingConsignmentItems } from \"./hooks/useMultishippingConsignmentItems\";\nimport { ItemSplitTooltip } from \"./ItemSplitTooltip\";\nimport { type MultiShippingConsignmentData, type MultiShippingTableItemWithType } from \"./MultishippingType\";\n\ninterface ConsignmentLineItemProps {\n    consignmentNumber: number;\n    consignment: MultiShippingConsignmentData;\n    onUnhandledError(error: Error): void;\n    isLoading: boolean;\n}\n\nconst ConsignmentLineItem: FunctionComponent<ConsignmentLineItemProps> = ({ consignmentNumber, consignment, onUnhandledError, isLoading }: ConsignmentLineItemProps) => {\n    const [isOpenAllocateItemsModal, setIsOpenAllocateItemsModal] = useState(false);\n    const [showItems, setShowItems] = useState(true);\n\n    const { unassignedItems } = useMultiShippingConsignmentItems();\n    const { checkoutService: { assignItemsToAddress: assignItem } } = useCheckout();\n    const deleteItem = useDeallocateItem();\n    const { themeV2 } = useThemeContext();\n\n    const toggleAllocateItemsModal = () => {\n        setIsOpenAllocateItemsModal(!isOpenAllocateItemsModal);\n    }\n\n    const handleAssignItems = async (consignmentLineItems: ConsignmentLineItem[]) => {\n        try {\n            await assignItem({\n                address: consignment.address,\n                lineItems: consignmentLineItems,\n            });\n\n        } catch (error) {\n            if (error instanceof Error) {\n                onUnhandledError(new AssignItemFailedError(error));\n            }\n        } finally {\n            toggleAllocateItemsModal();\n        }\n    }\n\n    const handleUnassignItems = async (itemToDelete: MultiShippingTableItemWithType) => {\n        try {\n            const consignmentRequest = {\n                address: consignment.address,\n                shippingAddress: consignment.shippingAddress,\n                lineItems: [\n                    {\n                        quantity: itemToDelete.quantity,\n                        itemId: itemToDelete.id,\n                    },\n                ],\n            }\n\n            await deleteItem(consignmentRequest, itemToDelete.id.toString(), consignment);\n        } catch (error) {\n            if (error instanceof Error) {\n                onUnhandledError(new UnassignItemError(error));\n            }\n        }\n    }\n\n    const toggleShowItems = () => {\n        setShowItems(!showItems);\n    }\n\n    const isMobileView = isMobileViewUI();\n\n    const itemsCount = consignment.shippableItemsCount;\n\n    return (\n        <div>\n            <AllocateItemsModal\n                address={consignment.shippingAddress}\n                assignedItems={consignment}\n                consignmentNumber={consignmentNumber}\n                isLoading={isLoading}\n                isOpen={isOpenAllocateItemsModal}\n                onAllocateItems={handleAssignItems}\n                onRequestClose={toggleAllocateItemsModal}\n                onUnassignItem={handleUnassignItems}\n                unassignedItems={unassignedItems}\n            />\n            <div className=\"consignment-line-item-header\">\n                <div>\n                    <h3 className={themeV2 ? 'body-bold' : ''}>\n                        <TranslatedString data={{ count: itemsCount }} id=\"shipping.multishipping_item_allocated_message\" />\n                    </h3>\n\n                    {consignment.hasSplitItems && (\n                        <ItemSplitTooltip />\n                    )}\n\n                    <a\n                        className={classNames('expand-items-button',\n                            { 'body-cta': themeV2 }\n                        )}\n                        data-test=\"expand-items-button\"\n                        href=\"#\"\n                        onClick={preventDefault(toggleShowItems)}\n                    >\n                        {showItems ? (\n                            <>\n                                {!isMobileView && <TranslatedString id=\"shipping.multishipping_item_hide_items_message\" />}\n                                <IconChevronUp />\n                            </>\n                        ) : (\n                            <>\n                                {!isMobileView && <TranslatedString id=\"shipping.multishipping_item_show_items_message\" />}\n                                <IconChevronDown />\n                            </>\n                        )}\n                    </a>\n                </div>\n                <a\n                    className={themeV2 ? 'body-cta' : ''}\n                    data-test=\"reallocate-items-button\"\n                    href=\"#\"\n                    onClick={preventDefault(toggleAllocateItemsModal)}\n                >\n                    <TranslatedString id=\"shipping.multishipping_item_reallocated_message\" />\n                </a>\n            </div>\n            {showItems\n                ? <ConsignmentLineItemDetail lineItems={consignment.lineItems} />\n                : null\n            }\n        </div>\n    )\n}\n\nexport default ConsignmentLineItem;\n","import { type ShippingOption } from '@bigcommerce/checkout-sdk';\nimport React, { type FunctionComponent } from 'react';\n\nimport { RadioInput, useThemeContext } from '@bigcommerce/checkout/ui';\n\nimport { ShopperCurrency } from '../../currency';\n\ninterface MultiShippingOptionsListItemProps {\n    consignmentId: string;\n    selectedShippingOptionId?: string;\n    shippingOption: ShippingOption;\n    handleSelect: (consignmentId: string, shippingOptionId: string) => void;\n}\n\nexport const MultiShippingOptionsListItem: FunctionComponent<\n    MultiShippingOptionsListItemProps\n> = ({ consignmentId, selectedShippingOptionId, shippingOption, handleSelect }) => {\n    const { themeV2 } = useThemeContext();\n\n    const label = (\n        <span className={themeV2 ? 'body-regular' : ''}>\n            {`${shippingOption.description} - `}\n            <ShopperCurrency amount={shippingOption.cost} />\n        </span>\n    );\n\n    const selectThisOption = () => {\n        handleSelect(consignmentId, shippingOption.id);\n    };\n\n    return (\n        <ul className=\"shipping-option-item\">\n            <RadioInput\n                checked={selectedShippingOptionId === shippingOption.id}\n                id={`shippingOption-${consignmentId}-${shippingOption.id}`}\n                key={`key-${consignmentId}-${shippingOption.id}`}\n                label={label}\n                name={`${consignmentId}-shippingMethod`}\n                onClick={selectThisOption}\n                readOnly\n                value={shippingOption.id}\n            />\n        </ul>\n    );\n};\n","import { type ShippingOption } from '@bigcommerce/checkout-sdk';\nimport React, { type FunctionComponent, memo } from 'react';\n\nimport { LoadingOverlay } from '@bigcommerce/checkout/ui';\n\nimport { MultiShippingOptionsListItem } from './MultiShippingOptionsListItem';\n\ninterface MultiShippingOptionsListV2Props {\n    consignmentId: string;\n    isLoading: boolean;\n    selectedShippingOptionId?: string;\n    shippingOptions: ShippingOption[];\n    onSelectedOption(consignmentId: string, shippingOptionId: string): void;\n}\n\nconst MultiShippingOptionsListV2: FunctionComponent<MultiShippingOptionsListV2Props> = ({\n    consignmentId,\n    isLoading,\n    shippingOptions,\n    selectedShippingOptionId,\n    onSelectedOption,\n}) => {\n    return (\n        <LoadingOverlay isLoading={isLoading}>\n            {shippingOptions.map((shippingOption) => (\n                <MultiShippingOptionsListItem\n                    consignmentId={consignmentId}\n                    handleSelect={onSelectedOption}\n                    key={shippingOption.id}\n                    selectedShippingOptionId={selectedShippingOptionId}\n                    shippingOption={shippingOption}\n                />\n            ))}\n        </LoadingOverlay>\n    );\n};\n\nexport default memo(MultiShippingOptionsListV2);\n","import { type Cart, type Consignment, type PhysicalItem } from '@bigcommerce/checkout-sdk';\nimport { isNil, reduce } from 'lodash';\n\nimport findConsignment from './findConsignment';\nimport type ShippableItem from './ShippableItem';\n\nexport default function getShippableLineItems(\n    cart: Cart,\n    consignments: Consignment[],\n): ShippableItem[] {\n    return reduce(\n        (cart && cart.lineItems.physicalItems) || [],\n        (result, item, i) =>\n            !item.addedByPromotion && isNil(item.parentId)\n                ? result.concat(...splitItem(item, consignments, i))\n                : result,\n        [] as ShippableItem[],\n    );\n}\n\nfunction splitItem(\n    item: PhysicalItem,\n    consignments: Consignment[],\n    lineItemIndex: number,\n): ShippableItem[] {\n    let splitItems: ShippableItem[] = [];\n    const consignment = findConsignment(consignments, item.id as string);\n\n    for (let i = 0; i < item.quantity; i++) {\n        splitItems = splitItems.concat({\n            ...item,\n            key: `${item.variantId}-${item.productId}-${lineItemIndex}-${i}`,\n            consignment,\n            quantity: 1,\n        });\n    }\n\n    return splitItems;\n}\n","import { type Consignment } from '@bigcommerce/checkout-sdk';\nimport { find, includes } from 'lodash';\n\nexport default function findConsignment(\n    consignments: Consignment[],\n    itemId: string,\n): Consignment | undefined {\n    return find(consignments, (consignment) => includes(consignment.lineItemIds, itemId));\n}\n","import { type ShippingOption } from '@bigcommerce/checkout-sdk';\n\nexport default function getRecommendedShippingOption(\n    availableShippingOptions: ShippingOption[],\n): ShippingOption | undefined {\n    if (!availableShippingOptions) {\n        return;\n    }\n\n    return availableShippingOptions.find(\n        ({ isRecommended }: { isRecommended: any }) => isRecommended,\n    );\n}\n","import { type ShippingOptionsFormProps } from \"../shippingOption/ShippingOptionsForm\";\n\nexport const getShippingOptionIds = ({ consignments }: ShippingOptionsFormProps) => {\n    const shippingOptionIds: { [id: string]: string } = {};\n\n    (consignments || []).forEach((consignment) => {\n        shippingOptionIds[consignment.id] = consignment.selectedShippingOption\n            ? consignment.selectedShippingOption.id\n            : '';\n    });\n\n    return { shippingOptionIds };\n};\n","import { type Cart, type Consignment } from '@bigcommerce/checkout-sdk';\nimport React, { type ReactElement } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { AddressType, StaticAddress } from '../../address';\nimport StaticConsignmentItemList from '../StaticConsignmentItemList';\n\ninterface ConsignmentDetailsProps {\n    cart: Cart;\n    consignment: Consignment;\n}\n\nexport const ConsignmentDetails = ({ cart, consignment }: ConsignmentDetailsProps): ReactElement => (\n    <div className=\"staticConsignment\">\n        <strong>\n            <TranslatedString id=\"shipping.shipping_address_heading\" />\n        </strong>\n        <StaticAddress address={consignment.shippingAddress} type={AddressType.Shipping} />\n        <StaticConsignmentItemList cart={cart} consignment={consignment} />\n    </div>\n);\n","import React, { type ReactElement } from 'react';\n\nimport { ChecklistSkeleton } from '@bigcommerce/checkout/ui';\n\ninterface NoShippingOptionsProps {\n    message: React.ReactNode;\n    isLoading: boolean;\n}\n\nexport const NoShippingOptions = ({ message, isLoading }: NoShippingOptionsProps): ReactElement => (\n    <ChecklistSkeleton\n        additionalClassName=\"shippingOptions-skeleton\"\n        isLoading={isLoading}\n        rows={2}\n    >\n        <div className=\"shippingOptions-panel optimizedCheckout-overlay\">\n            <p\n                aria-live=\"polite\"\n                className=\"shippingOptions-panel-message optimizedCheckout-primaryContent\"\n                role=\"alert\"\n            >\n                {message}\n            </p>\n        </div>\n    </ChecklistSkeleton>\n);\n","import getCarriersName from \"./getCarriersName\";\n\nexport async function getCarriers(userBcId: number | undefined) {\n\n    const BUNDLEURL = process.env.BUNDLEURL || ''\n    const BUNDLEAUTHTOKEN = process.env.BUNDLEAUTHTOKEN || ''\n    \n    if(userBcId===undefined)return;\n    \n    try {\n         \n        const companiesIds = await fetch(`${BUNDLEURL}/v3/io/companies?customerId=${userBcId}`, \n            {\n                headers: {'Content-Type': 'application/json', authToken: BUNDLEAUTHTOKEN}\n            }\n        ) .then(response => response.json())\n          .then(response => response.data.map((res:any)=>res.companyId))\n        \n        const multipleShippingsNames = await Promise.all(\n            companiesIds.map(async (companyId: number)=>{\n            \n                const companyDetails= await fetch(`${BUNDLEURL}/v3/io/companies/${companyId}`, \n                {\n                    headers: {'Content-Type': 'application/json', authToken: BUNDLEAUTHTOKEN}\n                }\n                ).then(response => response.json())\n                .then(response => response.data)\n                \n                const shippings= companyDetails.extraFields.find((field:any)=> field.fieldName=== 'Transporte:')\n\n                const shippingsArray= shippings.fieldValue.split(\",\")\n                \n                const shippingNamesFiltered= await getCarriersName(shippingsArray)\n\n                return shippingNamesFiltered\n\n            })\n        )\n        \n        const allMultipleShippingsNamesInASingleArray= multipleShippingsNames.flat()\n       \n        return allMultipleShippingsNamesInASingleArray\n    }catch(e){\n        // eslint-disable-next-line no-console\n        console.error(\"Error getting carriers\",e)\n\n        return [];\n    }\n}\n","export interface CarriersApi {\n    id: number\n    bigcommerce_id: number\n    deliver_id: number\n    default?: boolean\n    name: string\n    create_at: Date\n}\n\nexport default async function getCarriersName(shippingsArray:string[]) {\n  try {\n    const SELANUSAAPIURL= process.env.SELANUSAAPIURL || ''\n  \n    const shippingsNumberArray= shippingsArray.map((element)=> parseInt(element, 10))\n  \n    const shippingsNumberArrayInString= JSON.stringify(shippingsNumberArray)\n    \n    const data= await fetch(`${SELANUSAAPIURL}/carriers?ids=${shippingsNumberArrayInString}`).then((response)=> response.json())\n      \n    const filteredNames= data.map((shipping:CarriersApi)=> shipping.name)\n    \n    return filteredNames\n\n  } catch(e){\n    // eslint-disable-next-line no-console\n    console.error(e)\n\n    return [];\n  }\n}\n","import { ExtensionRegion, type ShippingOption } from '@bigcommerce/checkout-sdk';\nimport React, { type FunctionComponent, memo, useCallback, useEffect, useState } from 'react';\n\nimport { Extension } from '@bigcommerce/checkout/checkout-extension';\nimport { LoadingOverlay } from '@bigcommerce/checkout/ui';\n\nimport { EMPTY_ARRAY } from '../../common/utility';\nimport { Checklist, ChecklistItem } from '../../ui/form';\nimport { getCarriers } from '../carriers/getCarriers';\nimport GetDefaultCarriers from '../carriers/getDefaultCarriers';\n\nimport StaticShippingOption from './StaticShippingOption';\n\ninterface ShippingOptionListItemProps {\n    consignmentId: string;\n    isMultiShippingMode: boolean;\n    selectedShippingOptionId?: string;\n    shippingOption: ShippingOption;\n}\n\nconst ShippingOptionListItem: FunctionComponent<ShippingOptionListItemProps> = ({\n    consignmentId,\n    isMultiShippingMode,\n    selectedShippingOptionId,\n    shippingOption,\n}) => {\n    const isSelected = selectedShippingOptionId === shippingOption.id;\n\n    const renderLabel = useCallback(\n        () => (\n            <div className=\"shippingOptionLabel\">\n                <StaticShippingOption displayAdditionalInformation={true} method={shippingOption} />\n                {(isSelected && !isMultiShippingMode) && (\n                    <Extension region={ExtensionRegion.ShippingSelectedShippingMethod} />\n                )}\n            </div>\n        ),\n        [isSelected, isMultiShippingMode, shippingOption],\n    );\n\n    return (\n        <ChecklistItem\n            htmlId={`shippingOptionRadio-${consignmentId}-${shippingOption.id}`}\n            label={renderLabel}\n            value={shippingOption.id}\n        />\n    );\n};\n\nexport interface ShippingOptionListProps {\n    consignmentId: string;\n    inputName: string;\n    isLoading: boolean;\n    isMultiShippingMode: boolean;\n    customerId?: number ;\n    customerGroupId?: number;\n    postalCode: string;\n    stateOrProvince: string;\n    storeHash?: string;\n    selectedShippingOptionId?: string;\n    shippingOptions?: ShippingOption[];\n    onSelectedOption(consignmentId: string, shippingOptionId: string): void;\n}\n\nconst ShippingOptionsList: FunctionComponent<ShippingOptionListProps> = ({\n    consignmentId,\n    inputName,\n    isLoading,\n    isMultiShippingMode,\n    customerId,\n    customerGroupId,\n    postalCode,\n    stateOrProvince,\n    shippingOptions = EMPTY_ARRAY,\n    selectedShippingOptionId,\n    onSelectedOption,\n}) => {\n    const [filteredShippingOptions, setFilteredShippingOptions] = useState<ShippingOption[]>([])\n    const handleSelect = useCallback(\n        (value: string) => {\n            onSelectedOption(consignmentId, value);\n        },\n        [consignmentId, onSelectedOption],\n    );\n    const setFilterCarriers =  async () => {\n        if(!shippingOptions.length) return;\n\n        // Carriers from Bundle\n        const newCarriers= await getCarriers(customerId) || []\n        const bundleCarriers= pushAndFilterCarriers(newCarriers)\n\n        // Default Carriers\n        const newDefaultCarriers = await GetDefaultCarriers()\n        const defaultCarriersFromDb = pushAndFilterCarriers(newDefaultCarriers)\n\n        const allCarriers= defaultCarriersFromDb.concat(bundleCarriers)\n\n        setFilteredShippingOptions(allCarriers)\n    }\n\n    useEffect( () => {\n        setFilterCarriers()\n    }, [postalCode, stateOrProvince])\n\n    const pushAndFilterCarriers = (Carriers:string[]) =>{\n        const newFilteredShipping = []\n\n        for ( const carrierName of Carriers){\n\n            const filteredShipping = shippingOptions.find(element=> element.description === carrierName)\n\n            if(!filteredShipping) continue;\n\n            const isTheStateAndSelanusasGroup = customerGroupId===570 && stateOrProvince === 'Ciudad de Mxico'\n\n            // has to be one of the selected pickup in store, has the correcto postalCode and be in the state Mxico\n            if(\n                filteredShipping.description === 'Boutique Selanusa' || filteredShipping.description === 'Recoger CLS'\n            ) {\n                if(\n                    !(postalCode===\"06080\" && filteredShipping.description === 'Boutique Selanusa' || postalCode===\"07040\" && filteredShipping.description === 'Recoger CLS')\n                        || \n                    !isTheStateAndSelanusasGroup\n                ) continue;\n            }\n\n            newFilteredShipping.push(filteredShipping)\n\n        }\n\n        return newFilteredShipping\n    }\n\n    if (!shippingOptions.length) {\n        return null;\n    }\n\n    return (\n        <LoadingOverlay isLoading={isLoading}>\n            {\n                filteredShippingOptions?\n            <Checklist\n                aria-live=\"polite\"\n                defaultSelectedItemId={selectedShippingOptionId}\n                name={inputName}\n                onSelect={handleSelect}\n            >\n                {filteredShippingOptions.map((shippingOption) => (\n                    <ShippingOptionListItem\n                        consignmentId={consignmentId}\n                        isMultiShippingMode={isMultiShippingMode}\n                        key={shippingOption.id}\n                        selectedShippingOptionId={selectedShippingOptionId}\n                        shippingOption={shippingOption}\n                    />\n                ))}\n            </Checklist>\n            : <h4>No hay transportistas disponibles</h4>\n            }\n        </LoadingOverlay>\n    );\n};\n\nexport default memo(ShippingOptionsList);\n","import { CarriersApi } from \"./getCarriersName\"\n\nexport default async function GetDefaultCarriers() {\n    try {\n\n        const SELANUSAAPIURL= process.env.SELANUSAAPIURL || ''\n      \n        const data= await fetch(`${SELANUSAAPIURL}/default-carriers`).then((response)=> response.json())\n          \n        const filteredNames= data.map((shipping:CarriersApi)=> shipping.name)\n        \n        return filteredNames\n    } catch(e){\n        // eslint-disable-next-line no-console\n        console.error(e)\n        \n        return []\n    }\n}\n  ","import { type CheckoutSelectors } from '@bigcommerce/checkout-sdk';\nimport { type FormikProps } from 'formik';\nimport { noop } from 'lodash';\nimport React, { type ReactElement, useEffect } from 'react';\n\nimport { useAnalytics } from '@bigcommerce/checkout/analytics';\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\n\nimport { withFormikExtended } from '../../common/form';\nimport getRecommendedShippingOption from '../getRecommendedShippingOption';\nimport { getShippingOptionIds } from '../utils';\n\nimport { ConsignmentDetails } from './MultiShippingConsignmentDetails';\nimport { NoShippingOptions } from './NoShippingOption';\nimport { type ShippingOptionsProps, type WithCheckoutShippingOptionsProps } from './ShippingOptions';\nimport ShippingOptionsList from './ShippingOptionsList';\nimport './ShippingOptionsForm.scss';\n\nexport type ShippingOptionsFormProps = ShippingOptionsProps &\n    WithCheckoutShippingOptionsProps;\n\nexport interface ShippingOptionsFormValues {\n    shippingOptionIds: {\n        [shippingOptionIds: string]: string;\n    };\n}\n\nconst ShippingOptionsForm = (props: ShippingOptionsFormProps & FormikProps<ShippingOptionsFormValues>): ReactElement => {\n    const {\n        consignments,\n        cart,\n        isMultiShippingMode,\n        selectShippingOption,\n        isLoading,\n        shouldShowShippingOptions,\n        invalidShippingMessage,\n        methodId,\n        subscribeToConsignments,\n        setFieldValue,\n        shippingFormRenderTimestamp,\n        setValues,\n        customerGroupId,\n        customerId,\n        storeHash,\n    } = props;\n    const { analyticsTracker } = useAnalytics();\n\n    const selectDefaultShippingOptions = async ({ data }: CheckoutSelectors) => {\n        const consignment = (data.getConsignments() || []).find(\n            ({ selectedShippingOption, availableShippingOptions: shippingOptions }) =>\n                !selectedShippingOption && shippingOptions,\n        );\n\n        if (!consignment || !consignment.availableShippingOptions) {\n            return;\n        }\n\n        const { availableShippingOptions, id } = consignment;\n        const recommendedOption = getRecommendedShippingOption(availableShippingOptions);\n        const singleShippingOption =\n            availableShippingOptions.length === 1 && availableShippingOptions[0];\n        const defaultShippingOption = recommendedOption || singleShippingOption;\n\n        if (!defaultShippingOption) {\n            return;\n        }\n\n        await selectShippingOption(id, defaultShippingOption.id);\n        setFieldValue(`shippingOptionIds.${id}`, defaultShippingOption.id);\n    }\n\n    useEffect(() => {\n        const unsubscribe = subscribeToConsignments(selectDefaultShippingOptions);\n\n        return () => {\n            if (unsubscribe) {\n                unsubscribe();\n            }\n        };\n    }, []);\n\n    useEffect(() => {\n        if (consignments?.length && shouldShowShippingOptions) {\n            analyticsTracker.showShippingMethods();\n        }\n    }, [consignments, shouldShowShippingOptions]);\n\n    useEffect(() => {\n        if(shippingFormRenderTimestamp){\n            setValues(getShippingOptionIds(props));\n        }\n    }, [shippingFormRenderTimestamp]);\n\n    if (!consignments?.length || !shouldShowShippingOptions) {\n        return (\n            <NoShippingOptions\n                isLoading={isLoading()}\n                message={\n                    <TranslatedString\n                        id={\n                            methodId || isMultiShippingMode\n                                ? 'shipping.select_shipping_address_text'\n                                : 'shipping.enter_shipping_address_text'\n                        }\n                    />\n                }\n            />\n        );\n    }\n\n    return (\n        <>\n            {consignments.map((consignment) => (\n                <div className=\"shippingOptions-container form-fieldset\" key={consignment.id}>\n                    {isMultiShippingMode && (\n                        <ConsignmentDetails cart={cart} consignment={consignment} />\n                    )}\n\n                    <ShippingOptionsList\n                        consignmentId={consignment.id}\n                        customerGroupId={customerGroupId}\n                        customerId={customerId}\n                        inputName={`shippingOptionIds.${consignment.id}`}\n                        isLoading={isLoading(consignment.id)}\n                        isMultiShippingMode={isMultiShippingMode}\n                        onSelectedOption={selectShippingOption}\n                        postalCode= {consignment.shippingAddress.postalCode}\n                        selectedShippingOptionId={consignment.selectedShippingOption &&\n                            consignment.selectedShippingOption.id}\n                        shippingOptions={consignment.availableShippingOptions}\n                        stateOrProvince={consignment.shippingAddress.stateOrProvince}\n                        storeHash={storeHash}                   />\n\n                    {(!consignment.availableShippingOptions ||\n                        !consignment.availableShippingOptions.length) && (\n                        <NoShippingOptions\n                            isLoading={isLoading(consignment.id)}\n                            message={invalidShippingMessage}\n                        />\n                    )}\n                </div>\n            ))}\n        </>\n    );\n};\n\nexport default withFormikExtended<ShippingOptionsFormProps, ShippingOptionsFormValues>({\n    handleSubmit: noop,\n    mapPropsToValues: getShippingOptionIds,\n})(ShippingOptionsForm);\n","import { type Cart, type CheckoutSelectors, type Consignment } from '@bigcommerce/checkout-sdk';\nimport { map, sortBy, uniq } from 'lodash';\nimport { createSelector } from 'reselect';\n\nimport { type CheckoutContextProps } from '@bigcommerce/checkout/payment-integration-api';\n\nimport { withCheckout } from '../../checkout';\nimport getShippableLineItems from '../getShippableLineItems';\nimport getShippingMethodId from '../getShippingMethodId';\n\nimport ShippingOptionsForm from './ShippingOptionsForm';\n\nexport interface ShippingOptionsProps {\n    isInitialValueLoaded: boolean;\n    isMultiShippingMode: boolean;\n    isUpdatingAddress?: boolean;\n    shouldShowShippingOptions: boolean;\n    shippingFormRenderTimestamp?: number;\n}\n\nexport interface WithCheckoutShippingOptionsProps {\n    invalidShippingMessage: string;\n    customerId?: number;\n    customerGroupId?: number;\n    methodId?: string;\n    consignments?: Consignment[];\n    cart: Cart;\n    storeHash?: string;\n    isSelectingShippingOption(consignmentId?: string): boolean;\n    subscribeToConsignments(subscriber: (state: CheckoutSelectors) => void): () => void;\n    selectShippingOption(consignmentId: string, optionId: string): Promise<CheckoutSelectors>;\n    isLoading(consignmentId?: string): boolean;\n}\n\nconst subscribeToConsignmentsSelector = createSelector(\n    ({ checkoutService }: CheckoutContextProps) => checkoutService.subscribe,\n    (subscribe) => (subscriber: (state: CheckoutSelectors) => void) => {\n        return subscribe(subscriber, ({ data }) => data.getConsignments());\n    },\n);\n\nexport const isLoadingSelector = createSelector(\n    (_: CheckoutSelectors, isUpdatingAddress?: boolean) => isUpdatingAddress,\n    ({ statuses }: CheckoutSelectors) => statuses.isLoadingShippingOptions,\n    ({ statuses }: CheckoutSelectors) => statuses.isSelectingShippingOption,\n    ({ statuses }: CheckoutSelectors) => statuses.isUpdatingConsignment,\n    ({ statuses }: CheckoutSelectors) => statuses.isCreatingConsignments,\n    (\n        isUpdatingAddress,\n        isLoadingShippingOptions,\n        isSelectingShippingOption,\n        isUpdatingConsignment,\n        isCreatingConsignments,\n    ) => {\n        return (consignmentId?: string) => {\n            return (\n                isUpdatingAddress ||\n                isLoadingShippingOptions() ||\n                isSelectingShippingOption(consignmentId) ||\n                isUpdatingConsignment(consignmentId) ||\n                isCreatingConsignments()\n            );\n        };\n    },\n);\n\nconst sortConsignments = (cart: Cart, unsortedConsignments: Consignment[]): Consignment[] => {\n    if (unsortedConsignments.length < 2) {\n        return unsortedConsignments;\n    }\n\n    const shippableItems = getShippableLineItems(cart, unsortedConsignments);\n    const consignmentsOrder = uniq(map(shippableItems, 'consignment.id'));\n\n    return sortBy(unsortedConsignments, (consignment) => consignmentsOrder.indexOf(consignment.id));\n};\n\nexport function mapToShippingOptions(\n    { checkoutService, checkoutState }: CheckoutContextProps,\n    props: ShippingOptionsProps,\n): WithCheckoutShippingOptionsProps | null {\n    const {\n        data: { getCart, getConsignments, getConfig, getCustomer, getCheckout },\n        statuses: { isSelectingShippingOption },\n    } = checkoutState;\n\n    const customer = getCustomer();\n    const cart = getCart();\n    const config = getConfig();\n    const checkout = getCheckout();\n    const customerId: number | undefined = customer?.id\n    const customerGroupId: number | undefined = customer?.customerGroup?.id\n\n    const storeHash= config?.storeProfile.storeHash\n\n    if (!config || !checkout || !customer || !cart) {\n        return null;\n    }\n\n    const consignments = sortConsignments(cart, getConsignments() || []);\n    const methodId = getShippingMethodId(checkout, config);\n    const { shippingQuoteFailedMessage } = config.checkoutSettings;\n\n    return {\n        cart,\n        customerId,\n        customerGroupId,\n        storeHash,\n        consignments,\n        invalidShippingMessage: shippingQuoteFailedMessage,\n        isLoading: isLoadingSelector(checkoutState, props.isUpdatingAddress),\n        isSelectingShippingOption,\n        methodId,\n        selectShippingOption: checkoutService.selectConsignmentShippingOption,\n        subscribeToConsignments: subscribeToConsignmentsSelector({\n            checkoutService,\n            checkoutState,\n        }),\n    };\n}\n\nexport default withCheckout(mapToShippingOptions)(ShippingOptionsForm);\n","import { type Consignment } from '@bigcommerce/checkout-sdk';\nimport classNames from 'classnames';\nimport React from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\nimport { useCheckout } from '@bigcommerce/checkout/payment-integration-api';\nimport { Alert, AlertType, useThemeContext } from '@bigcommerce/checkout/ui';\n\nimport MultiShippingOptionsListV2 from './MultiShippingOptionsList';\nimport { isLoadingSelector } from './ShippingOptions';\n\ninterface MultiShippingOptionsV2Props {\n    consignment: Consignment;\n    isLoading: boolean;\n    shippingQuoteFailedMessage: string;\n    resetErrorConsignmentNumber(): void;\n}\n\nexport const MultiShippingOptions = ({\n    consignment,\n    isLoading,\n    resetErrorConsignmentNumber,\n    shippingQuoteFailedMessage,\n}: MultiShippingOptionsV2Props) => {\n    const { checkoutService, checkoutState } = useCheckout();\n    const { themeV2 } = useThemeContext();\n\n    const selectShippingOption = async (consignmentId: string, shippingOptionId: string) => {\n        await checkoutService.selectConsignmentShippingOption(consignmentId, shippingOptionId);\n        resetErrorConsignmentNumber();\n    };\n    const isLoadingOptions = isLoadingSelector(checkoutState, isLoading)(consignment.id);\n\n    return (\n        <div>\n            <h3 className={classNames('shipping-option-header',\n                { 'body-bold': themeV2 })}\n            >\n                <TranslatedString id=\"shipping.shipping_method_label\" />\n            </h3>\n            {(!consignment.availableShippingOptions ||\n                !consignment.availableShippingOptions.length) && (\n                    <Alert type={AlertType.Error}>{shippingQuoteFailedMessage}</Alert>\n                )}\n            {Boolean(consignment.availableShippingOptions) &&\n                consignment.availableShippingOptions && (\n                    <MultiShippingOptionsListV2\n                        consignmentId={consignment.id}\n                        isLoading={isLoadingOptions}\n                        onSelectedOption={selectShippingOption}\n                        selectedShippingOptionId={\n                            consignment.selectedShippingOption &&\n                            consignment.selectedShippingOption.id\n                        }\n                        shippingOptions={consignment.availableShippingOptions}\n                    />\n                )}\n        </div>\n    );\n};\n","import classNames from 'classnames';\nimport React, { type FunctionComponent } from 'react';\n\nimport { preventDefault } from \"@bigcommerce/checkout/dom-utils\";\nimport { TranslatedString } from \"@bigcommerce/checkout/locale\";\nimport { useCheckout } from \"@bigcommerce/checkout/payment-integration-api\";\nimport { useThemeContext } from '@bigcommerce/checkout/ui';\n\nimport { IconClose, IconSize } from \"../ui/icon\";\n\nimport ConsignmentAddressSelector from './ConsignmentAddressSelector';\nimport ConsignmentLineItem from './ConsignmentLineItem';\nimport { type MultiShippingConsignmentData } from './MultishippingType';\nimport { MultiShippingOptions } from './shippingOption/MultiShippingOptions';\n\nexport interface ConsignmentListItemProps {\n    consignment: MultiShippingConsignmentData;\n    consignmentNumber: number;\n    defaultCountryCode?: string;\n    isLoading: boolean;\n    shippingQuoteFailedMessage: string;\n    onUnhandledError(error: Error): void;\n    resetErrorConsignmentNumber(): void;\n}\n\nconst ConsignmentListItem: FunctionComponent<ConsignmentListItemProps> = ({\n    consignment,\n    consignmentNumber,\n    defaultCountryCode,\n    isLoading,\n    shippingQuoteFailedMessage,\n    onUnhandledError,\n    resetErrorConsignmentNumber,\n}: ConsignmentListItemProps) => {\n\n    const { checkoutService: { deleteConsignment } } = useCheckout();\n    const { themeV2 } = useThemeContext();\n\n    const handleClose = async () => {\n        await deleteConsignment(consignment.id);\n        resetErrorConsignmentNumber();\n    };\n\n    return (\n        <div className='consignment-container'>\n            <div className={classNames('consignment-header', { 'sub-header': themeV2 })}>\n                <h3>\n                    <TranslatedString data={{ consignmentNumber }} id=\"shipping.multishipping_consignment_index_heading\" />\n                </h3>\n                <a\n                    className=\"delete-consignment\"\n                    data-test=\"delete-consignment-button\"\n                    href=\"#\"\n                    onClick={preventDefault(handleClose)}\n                >\n                    <IconClose size={IconSize.Small} />\n                </a>\n            </div>\n            <ConsignmentAddressSelector\n                consignment={consignment}\n                defaultCountryCode={defaultCountryCode}\n                isLoading={isLoading}\n                onUnhandledError={onUnhandledError}\n                selectedAddress={consignment.shippingAddress}\n            />\n            <ConsignmentLineItem\n                consignment={consignment}\n                consignmentNumber={consignmentNumber}\n                isLoading={isLoading}\n                onUnhandledError={onUnhandledError}\n            />\n            <MultiShippingOptions\n                consignment={consignment}\n                isLoading={isLoading}\n                resetErrorConsignmentNumber={resetErrorConsignmentNumber}\n                shippingQuoteFailedMessage={shippingQuoteFailedMessage}\n            />\n        </div>\n    );\n};\n\nexport default ConsignmentListItem;\n","import { type Consignment } from '@bigcommerce/checkout-sdk';\nimport { every } from 'lodash';\n\nexport default function isSelectedShippingOptionValid(consignments: Consignment[]): boolean {\n    if (!consignments.length) {\n        return false;\n    }\n\n    return every(\n        consignments,\n        consignment => {\n            if (consignment.selectedShippingOption?.type === 'custom') {\n                return true;\n            }\n\n            return consignment.availableShippingOptions &&\n                consignment.availableShippingOptions.find(\n                    ({ id }) => id === consignment.selectedShippingOption?.id\n                );\n        }\n    );\n}\n","import React, { type FunctionComponent } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\nimport { useThemeContext } from '@bigcommerce/checkout/ui';\n\nimport { OrderComments } from '../orderComments';\nimport { Alert, AlertType } from '../ui/alert';\nimport { Button, ButtonVariant } from '../ui/button';\nimport { Form } from '../ui/form';\n\nexport interface ShippingFormFooterProps {\n    shouldShowOrderComments: boolean;\n    shouldDisableSubmit: boolean;\n    isLoading: boolean;\n    cartHasChanged: boolean;\n}\n\nconst MultiShippingFormFooter: FunctionComponent<ShippingFormFooterProps> = ({\n    shouldShowOrderComments,\n    shouldDisableSubmit,\n    isLoading,\n    cartHasChanged,\n}) => {\n    const { themeV2 } = useThemeContext();\n\n    return (\n        <Form>\n            {cartHasChanged && (\n                <Alert type={AlertType.Error}>\n                    <strong>\n                        <TranslatedString id=\"shipping.cart_change_error\" />\n                    </strong>\n                </Alert>\n            )}\n            {shouldShowOrderComments && <OrderComments />}\n\n            <div className=\"form-actions\">\n                <Button\n                    className={themeV2 ? 'body-bold' : ''}\n                    disabled={shouldDisableSubmit}\n                    id=\"checkout-shipping-continue\"\n                    isLoading={isLoading}\n                    type=\"submit\"\n                    variant={ButtonVariant.Primary}\n                >\n                    <TranslatedString id=\"common.continue_action\" />\n                </Button>\n            </div>\n        </Form>\n    );\n};\n\nexport default MultiShippingFormFooter;\n","import { type Consignment, type ConsignmentCreateRequestBody, type ConsignmentLineItem } from \"@bigcommerce/checkout-sdk\";\nimport classNames from \"classnames\";\nimport { find } from \"lodash\";\nimport React, { useMemo, useState } from \"react\";\n\nimport { preventDefault } from \"@bigcommerce/checkout/dom-utils\";\nimport { TranslatedString } from \"@bigcommerce/checkout/locale\";\nimport { useCheckout } from \"@bigcommerce/checkout/payment-integration-api\";\nimport { useThemeContext } from \"@bigcommerce/checkout/ui\";\n\nimport { EMPTY_ARRAY } from \"../common/utility\";\n\nimport AllocateItemsModal from \"./AllocateItemsModal\";\nimport ConsignmentAddressSelector from './ConsignmentAddressSelector';\nimport { AssignItemFailedError } from \"./errors\";\nimport { useMultiShippingConsignmentItems } from \"./hooks/useMultishippingConsignmentItems\";\nimport { setRecommendedOrMissingShippingOption } from './utils';\n\ninterface NewConsignmentProps {\n    consignmentNumber: number;\n    defaultCountryCode?: string;\n    isLoading: boolean;\n    setIsAddShippingDestination: React.Dispatch<React.SetStateAction<boolean>>;\n    onUnhandledError(error: Error): void;\n    resetErrorConsignmentNumber(): void;\n}\n\nconst NewConsignment = ({\n    consignmentNumber,\n    defaultCountryCode,\n    isLoading,\n    onUnhandledError,\n    resetErrorConsignmentNumber,\n    setIsAddShippingDestination,\n}: NewConsignmentProps) => {\n    const [consignmentRequest, setConsignmentRequest] = useState<ConsignmentCreateRequestBody | undefined>();\n    const [isOpenAllocateItemsModal, setIsOpenAllocateItemsModal] = useState(false);\n    const { unassignedItems } = useMultiShippingConsignmentItems();\n    const { themeV2 } = useThemeContext();\n    const {\n        checkoutState: {\n            data: { getShippingCountries, getConsignments: getPreviousConsignments },\n        },\n        checkoutService: { assignItemsToAddress: assignItem, selectConsignmentShippingOption },\n    } = useCheckout();\n\n    const selectedAddress = useMemo(() => {\n        if (!consignmentRequest?.address) {\n            return undefined;\n        }\n\n        const countries = getShippingCountries() || EMPTY_ARRAY;\n        const country = find(countries, { code: consignmentRequest.address.countryCode });\n\n        return {\n            ...consignmentRequest.address,\n            country: country ? country.name : consignmentRequest.address.countryCode,\n        };\n    }, [consignmentRequest]);\n\n    const toggleAllocateItemsModal = () => {\n        setIsOpenAllocateItemsModal(!isOpenAllocateItemsModal);\n    }\n\n    const handleAllocateItems = async (consignmentLineItems: ConsignmentLineItem[]) => {\n        let currentConsignments: Consignment[] | undefined;\n\n        if (!selectedAddress) {\n            return;\n        }\n\n        try {\n            const {\n                data: { getConsignments },\n            } = await assignItem({\n                address: selectedAddress,\n                lineItems: consignmentLineItems,\n            });\n\n            currentConsignments = getConsignments();\n        } catch (error) {\n            if (error instanceof AssignItemFailedError) {\n                onUnhandledError(error);\n            }\n        } finally {\n            toggleAllocateItemsModal();\n            setIsAddShippingDestination(false);\n            resetErrorConsignmentNumber();\n\n            if (currentConsignments && currentConsignments.length > 0) {\n                await setRecommendedOrMissingShippingOption(\n                    getPreviousConsignments() ?? [],\n                    currentConsignments,\n                    selectConsignmentShippingOption,\n                );\n            }\n        }\n    };\n\n    return (\n        <div className='consignment-container'>\n            <div className={classNames('consignment-header', { 'sub-header': themeV2 })}>\n                <h3>\n                    <TranslatedString data={{ consignmentNumber }} id=\"shipping.multishipping_consignment_index_heading\" />\n                </h3>\n            </div>\n            <ConsignmentAddressSelector\n                defaultCountryCode={defaultCountryCode}\n                isLoading={isLoading}\n                onUnhandledError={onUnhandledError}\n                selectedAddress={selectedAddress}\n                setConsignmentRequest={setConsignmentRequest}\n            />\n            {selectedAddress && (<>\n                <AllocateItemsModal\n                    address={selectedAddress}\n                    consignmentNumber={consignmentNumber}\n                    isLoading={isLoading}\n                    isOpen={isOpenAllocateItemsModal}\n                    onAllocateItems={handleAllocateItems}\n                    onRequestClose={toggleAllocateItemsModal}\n                    unassignedItems={unassignedItems}\n                />\n                <div className=\"new-consignment-line-item-header\">\n                    <h3 className={themeV2 ? 'body-bold' : ''}>\n                        <TranslatedString id=\"shipping.multishipping_no_item_allocated_message\" />\n                    </h3>\n                    <a\n                        className={themeV2 ? 'body-cta' : ''}\n                        data-test=\"allocate-items-button\"\n                        href=\"#\"\n                        onClick={preventDefault(toggleAllocateItemsModal)}\n                    >\n                        <TranslatedString id=\"shipping.multishipping_allocate_items\" />\n                    </a>\n                </div>\n            </>\n            )}\n        </div>\n    )\n}\n\nexport default NewConsignment;\n","import classNames from 'classnames';\nimport React, { type FunctionComponent, type ReactNode, useMemo, useState } from 'react';\n\nimport { TranslatedString, withLanguage, type WithLanguageProps } from '@bigcommerce/checkout/locale';\nimport { useCheckout } from '@bigcommerce/checkout/payment-integration-api';\nimport { Alert, AlertType, useThemeContext } from '@bigcommerce/checkout/ui';\n\nimport { withFormikExtended } from '../common/form';\nimport { EMPTY_ARRAY } from '../common/utility';\nimport { Button, ButtonVariant } from '../ui/button';\n\nimport ConsignmentListItem from './ConsignmentListItem';\nimport hasSelectedShippingOptions from './hasSelectedShippingOptions';\nimport { useMultiShippingConsignmentItems } from './hooks/useMultishippingConsignmentItems';\nimport isSelectedShippingOptionValid from './isSelectedShippingOptionValid';\nimport MultiShippingFormFooter from './MultiShippingFormFooter';\nimport { type MultiShippingConsignmentData } from './MultishippingType';\nimport './MultiShippingForm.scss';\nimport NewConsignment from './NewConsignment';\n\nexport interface MultiShippingFormValues {\n    orderComment: string;\n}\n\nexport interface MultiShippingFormProps {\n    cartHasChanged: boolean;\n    customerMessage: string;\n    defaultCountryCode?: string;\n    isLoading: boolean;\n    onUnhandledError(error: Error): void;\n    onSubmit(values: MultiShippingFormValues): void;\n}\n\nconst MultiShippingForm: FunctionComponent<MultiShippingFormProps> = ({\n    defaultCountryCode,\n    isLoading,\n    onUnhandledError,\n    cartHasChanged,\n}: MultiShippingFormProps) => {\n    const [errorConsignmentNumber, setErrorConsignmentNumber] = useState<number | undefined>();\n\n    const { themeV2 } = useThemeContext();\n    const {\n        checkoutState: {\n            data: { getConsignments, getConfig },\n        },\n    } = useCheckout();\n    const { unassignedItems: { lineItems: unassignedLineItems, shippableItemsCount }, consignmentList } = useMultiShippingConsignmentItems();\n\n    const consignments = getConsignments() || EMPTY_ARRAY;\n    const config = getConfig();\n\n    const [isAddShippingDestination, setIsAddShippingDestination] = useState(\n        consignments.length === 0,\n    );\n\n    const isEveryConsignmentHasShippingOption = hasSelectedShippingOptions(consignments);\n    const shouldDisableSubmit = useMemo(() => {\n        return isLoading || !!unassignedLineItems.length || !isEveryConsignmentHasShippingOption || !isSelectedShippingOptionValid(consignments);\n    }, [isLoading, consignments]);\n\n    if (!config) {\n        return null;\n    }\n\n    const {\n        checkoutSettings: {\n            enableOrderComments: shouldShowOrderComments,\n            shippingQuoteFailedMessage,\n        },\n    } = config;\n\n    const handleAddShippingDestination = () => {\n        if (!isAddShippingDestination && !isEveryConsignmentHasShippingOption) {\n            const errorConsignmentIndex = consignments.findIndex(\n                (consignment) => !consignment.selectedShippingOption,\n            );\n\n            if (errorConsignmentIndex === -1) {\n                setIsAddShippingDestination(true);\n\n                return;\n            }\n\n            setErrorConsignmentNumber(errorConsignmentIndex + 1);\n        } else if (isAddShippingDestination) {\n            setErrorConsignmentNumber(consignments.length + 1);\n        } else {\n            setErrorConsignmentNumber(undefined);\n            setIsAddShippingDestination(true);\n        }\n    };\n\n    const hasUnassignedItems = shippableItemsCount > 0;\n\n    const renderAllocatedBanner = (shippableItemsCount: number): ReactNode => {\n        if (shippableItemsCount > 0) {\n            return <Alert additionalClassName={themeV2 ? 'body-regular' : ''} type={AlertType.Info}>\n                <TranslatedString data={{ count: shippableItemsCount }} id=\"shipping.multishipping_item_to_allocate_message\" />\n            </Alert>;\n        }\n\n        return <Alert additionalClassName={themeV2 ? 'body-regular' : ''} type={AlertType.Success}>\n            <TranslatedString id=\"shipping.multishipping_all_items_allocated_message\" />\n        </Alert>;\n    }\n    const resetErrorConsignmentNumber = () => {\n        setErrorConsignmentNumber(undefined);\n    };\n\n    return (\n        <>\n            {renderAllocatedBanner(shippableItemsCount)}\n            {consignmentList.map((consignment: MultiShippingConsignmentData) => (\n                <ConsignmentListItem\n                    consignment={consignment}\n                    consignmentNumber={consignment.consignmentNumber}\n                    defaultCountryCode={defaultCountryCode}\n                    isLoading={isLoading}\n                    key={consignment.id}\n                    onUnhandledError={onUnhandledError}\n                    resetErrorConsignmentNumber={resetErrorConsignmentNumber}\n                    shippingQuoteFailedMessage={shippingQuoteFailedMessage}\n                />\n            ))}\n            {isAddShippingDestination && (\n                <NewConsignment\n                    consignmentNumber={consignments.length === 0 ? 1 : (consignments.length + 1)}\n                    defaultCountryCode={defaultCountryCode}\n                    isLoading={isLoading}\n                    onUnhandledError={onUnhandledError}\n                    resetErrorConsignmentNumber={resetErrorConsignmentNumber}\n                    setIsAddShippingDestination={setIsAddShippingDestination}\n                />)\n            }\n            {hasUnassignedItems &&\n                <Button\n                    className={classNames({ 'body-regular': themeV2 }, 'add-consignment-button')}\n                    onClick={handleAddShippingDestination}\n                    variant={ButtonVariant.Secondary}\n                >\n                    <TranslatedString id=\"shipping.multishipping_add_new_destination\" />\n                </Button>\n            }\n            {Boolean(errorConsignmentNumber) && (\n                <div className=\"form-field--error\">\n                    <span className=\"form-inlineMessage\">\n                        <TranslatedString\n                            data={{ consignmentNumber: errorConsignmentNumber }}\n                            id=\"shipping.multishipping_incomplete_consignment_error\"\n                        />\n                    </span>\n                </div>\n            )}\n            <MultiShippingFormFooter\n                cartHasChanged={cartHasChanged}\n                isLoading={isLoading}\n                shouldDisableSubmit={shouldDisableSubmit}\n                shouldShowOrderComments={shouldShowOrderComments}\n            />\n        </>\n    );\n}\n\nexport default withLanguage(\n    withFormikExtended<MultiShippingFormProps & WithLanguageProps, MultiShippingFormValues>({\n        handleSubmit: (values, { props: { onSubmit } }) => {\n            onSubmit(values);\n        },\n        mapPropsToValues: ({ customerMessage }) => ({\n            orderComment: customerMessage,\n        }),\n        enableReinitialize: true,\n    })(MultiShippingForm),\n);\n","import React, { type FunctionComponent, memo, useMemo } from 'react';\n\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\nimport { useThemeContext } from '@bigcommerce/checkout/ui';\n\nimport { CheckboxFormField } from '../ui/form';\n\nexport interface BillingSameAsShippingFieldProps {\n    onChange?(isChecked: boolean): void;\n}\n\nconst BillingSameAsShippingField: FunctionComponent<BillingSameAsShippingFieldProps> = ({\n    onChange,\n}) => {\n    const { themeV2 } = useThemeContext();\n\n    const labelContent = useMemo(\n        () => <TranslatedString id=\"billing.use_shipping_address_label\" />,\n        [],\n    );\n\n    return (\n        <CheckboxFormField\n            id=\"sameAsBilling\"\n            labelContent={labelContent}\n            name=\"billingSameAsShipping\"\n            onChange={onChange}\n            testId=\"billingSameAsShipping\"\n            themeV2={themeV2}\n        />\n    );\n};\n\nexport default memo(BillingSameAsShippingField);\n","import {\n    type Address,\n    type CheckoutSelectors,\n    type FormField,\n    type ShippingInitializeOptions,\n    type ShippingRequestOptions,\n} from '@bigcommerce/checkout-sdk';\nimport { noop } from 'lodash';\nimport React, { type ReactElement, useEffect } from 'react';\n\nimport { preventDefault } from '@bigcommerce/checkout/dom-utils';\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\nimport { DynamicFormField, LoadingOverlay } from '@bigcommerce/checkout/ui';\n\nimport { StaticAddress } from '../address/';\nimport { Button, ButtonSize, ButtonVariant } from '../ui/button';\nimport { Fieldset } from '../ui/form';\n\nimport './StaticAddressEditable.scss';\n\nexport interface StaticAddressEditableProps {\n    address: Address;\n    buttonId: string;\n    formFields: FormField[];\n    isLoading: boolean;\n    methodId?: string;\n    deinitialize(options?: ShippingRequestOptions): Promise<CheckoutSelectors>;\n    initialize(options?: ShippingInitializeOptions): Promise<CheckoutSelectors>;\n    onFieldChange(fieldName: string, value: string): void;\n    onUnhandledError?(error: unknown): void;\n}\n\nconst StaticAddressEditable = ({\n    address,\n    buttonId,\n    formFields,\n    isLoading,\n    methodId,\n    deinitialize,\n    initialize,\n    onFieldChange,\n    onUnhandledError = noop,\n}: StaticAddressEditableProps): ReactElement => {\n    const handleFieldValueChange = (name: string) => (value: string) => {\n        onFieldChange(name, value);\n    };\n    const customFormFields = formFields.filter(({ custom }) => custom);\n    const shouldShowCustomFormFields = customFormFields.length > 0;\n\n    const initialization = async () => {\n        try {\n            await initialize({ methodId });\n        } catch (error) {\n            onUnhandledError(error);\n        }\n    };\n    const deinitialization = async () => {\n        try {\n            await deinitialize({ methodId });\n        } catch (error) {\n            onUnhandledError(error);\n        }\n    };\n\n    useEffect(() => {\n        void initialization();\n\n        return () => {\n            void deinitialization();\n        };\n    }, []);\n\n    return (\n        <LoadingOverlay isLoading={isLoading}>\n            <div className=\"stepHeader\" style={{ padding: 0 }}>\n                <div className=\"stepHeader-body subheader\">\n                    <StaticAddress address={address} />\n                </div>\n\n                <div className=\"stepHeader-actions subheader\">\n                    <Button\n                        id={buttonId}\n                        onClick={preventDefault()}\n                        size={ButtonSize.Tiny}\n                        testId=\"step-edit-button\"\n                        variant={ButtonVariant.Secondary}\n                    >\n                        <TranslatedString id=\"common.edit_action\" />\n                    </Button>\n                </div>\n            </div>\n\n            {shouldShowCustomFormFields && (\n                <Fieldset id=\"customFieldset\">\n                    {customFormFields.map((field) => (\n                        <DynamicFormField\n                            field={field}\n                            key={`${field.id}-${field.name}`}\n                            onChange={handleFieldValueChange(field.name)}\n                            parentFieldName=\"shippingAddress.customFields\"\n                        />\n                    ))}\n                </Fieldset>\n            )}\n        </LoadingOverlay>\n    );\n};\n\nexport default StaticAddressEditable;\n","import { type Address, type ShippingInitializeOptions } from '@bigcommerce/checkout-sdk';\nimport { memoizeOne } from '@bigcommerce/memoize';\nimport React, { type FC, useCallback } from 'react';\n\nimport { type ShippingAddressProps } from './ShippingAddress';\nimport StaticAddressEditable from './StaticAddressEditable';\n\ninterface AmazonPayShippingAddressProps extends ShippingAddressProps {\n    shippingAddress:  Address,\n}\n\nexport const AmazonPayShippingAddress: FC<AmazonPayShippingAddressProps> = (props) => {\n    const {\n        methodId,\n        formFields,\n        onFieldChange,\n        initialize,\n        deinitialize,\n        shippingAddress,\n        isShippingStepPending,\n    } = props;\n\n    const initializeShipping = useCallback(\n        memoizeOne(\n            (defaultOptions: ShippingInitializeOptions) => (options?: ShippingInitializeOptions) =>\n                initialize({\n                    ...defaultOptions,\n                    ...options,\n                }),\n        ),\n        [],\n    );\n\n    const editAddressButtonId = 'edit-ship-button';\n\n    const options: ShippingInitializeOptions = {\n        amazonpay: {\n            editAddressButtonId,\n        },\n    };\n\n    return (\n        <StaticAddressEditable\n            address={shippingAddress}\n            buttonId={editAddressButtonId}\n            deinitialize={deinitialize}\n            formFields={formFields}\n            initialize={initializeShipping(options)}\n            isLoading={isShippingStepPending}\n            methodId={methodId}\n            onFieldChange={onFieldChange}\n        />\n    );\n};\n","import {\n    type Address,\n    type CheckoutSelectors,\n    type Country,\n    type CustomerAddress,\n    type FormField,\n    type ShippingInitializeOptions,\n    type ShippingRequestOptions,\n} from '@bigcommerce/checkout-sdk';\nimport React, { memo, type MutableRefObject } from 'react';\n\nimport { localizeAddress, TranslatedString } from '@bigcommerce/checkout/locale';\nimport {\n    Button,\n    ButtonSize,\n    ButtonVariant,\n    DynamicFormField,\n    Fieldset,\n    LoadingOverlay,\n} from '@bigcommerce/checkout/ui';\n\nimport PoweredByPayPalFastlaneLabel from './PoweredByPayPalFastlaneLabel';\n\nexport interface PayPalFastlaneStaticAddressProps {\n    address: Address;\n    countries?: Country[];\n    formFields: FormField[];\n    isLoading: boolean;\n    methodId: string;\n    paypalFastlaneShippingComponentRef: MutableRefObject<PayPalFastlaneAddressComponentRef>;\n    deinitialize(options?: ShippingRequestOptions): Promise<CheckoutSelectors>;\n    initialize(options?: ShippingInitializeOptions): Promise<CheckoutSelectors>;\n    onAddressSelect(address: Address): void;\n    onFieldChange(fieldName: string, value: string): void;\n    onUnhandledError?(error: Error): void;\n}\n\nexport interface PayPalFastlaneAddressComponentRef {\n    showAddressSelector?: () => Promise<CustomerAddress | undefined>;\n}\n\nconst PayPalFastlaneShippingAddressForm = (props: PayPalFastlaneStaticAddressProps) => {\n    const {\n        address: addressWithoutLocalization,\n        formFields,\n        isLoading,\n        onAddressSelect,\n        onFieldChange,\n        countries,\n        paypalFastlaneShippingComponentRef,\n    } = props;\n    const address = localizeAddress(addressWithoutLocalization, countries);\n\n    const customFormFields = formFields.filter(({ custom }) => custom);\n    const shouldShowCustomFormFields = customFormFields.length > 0;\n\n    const handleFieldValueChange: (name: string) => (value: string) => void = (name) => (value) =>\n        onFieldChange(name, value);\n\n    const handleEditButtonClick = async () => {\n        if (typeof paypalFastlaneShippingComponentRef.current.showAddressSelector === 'function') {\n            const selectedAddress =\n                await paypalFastlaneShippingComponentRef.current.showAddressSelector();\n\n            if (selectedAddress) {\n                const customFields = shouldShowCustomFormFields ? address.customFields : {};\n\n                onAddressSelect({\n                    ...selectedAddress,\n                    ...customFields,\n                });\n            }\n        }\n    };\n\n    return (\n        <LoadingOverlay hideContentWhenLoading isLoading={isLoading}>\n            <div className=\"stepHeader\" style={{ padding: 0 }}>\n                <div className=\"stepHeader-body subheader\">\n                    <div className=\"vcard checkout-address--static\">\n                        {!!(address.firstName || address.lastName) && (\n                            <p className=\"fn address-entry\">\n                                <span className=\"first-name\">{`${address.firstName} `}</span>\n                                <span className=\"family-name\">{address.lastName}</span>\n                            </p>\n                        )}\n\n                        {!!(address.phone || address.company) && (\n                            <p className=\"address-entry\">\n                                <span className=\"company-name\">{`${address.company} `}</span>\n                                <span className=\"tel\">{address.phone}</span>\n                            </p>\n                        )}\n\n                        <div className=\"adr\">\n                            <p className=\"street-address address-entry\">\n                                <span className=\"address-line-1\">{`${address.address1} `}</span>\n                                {!!address.address2 && (\n                                    <span className=\"address-line-2\">{` / ${address.address2}`}</span>\n                                )}\n                            </p>\n\n                            <p className=\"address-entry\">\n                                {!!address.city && (\n                                    <span className=\"locality\">{`${address.city}, `}</span>\n                                )}\n                                {!!address.localizedProvince && (\n                                    <span className=\"region\">{`${address.localizedProvince}, `}</span>\n                                )}\n                                {!!address.postalCode && (\n                                    <span className=\"postal-code\">{`${address.postalCode} / `}</span>\n                                )}\n                                {!!address.localizedCountry && (\n                                    <span className=\"country-name\">{`${address.localizedCountry} `}</span>\n                                )}\n                            </p>\n                        </div>\n                    </div>\n\n                    <PoweredByPayPalFastlaneLabel />\n                </div>\n\n                <div className=\"stepHeader-actions subheader\">\n                    <Button\n                        onClick={handleEditButtonClick}\n                        size={ButtonSize.Tiny}\n                        testId=\"step-edit-button\"\n                        variant={ButtonVariant.Secondary}\n                    >\n                        <TranslatedString id=\"common.edit_action\" />\n                    </Button>\n                </div>\n            </div>\n\n            {shouldShowCustomFormFields && (\n                <Fieldset id=\"customFieldset\">\n                    {customFormFields.map((field) => (\n                        <DynamicFormField\n                            field={field}\n                            key={`${field.id}-${field.name}`}\n                            onChange={handleFieldValueChange(field.name)}\n                            parentFieldName=\"shippingAddress.customFields\"\n                        />\n                    ))}\n                </Fieldset>\n            )}\n        </LoadingOverlay>\n    );\n};\n\nexport default memo(PayPalFastlaneShippingAddressForm);\n","import {\n    type Address,\n    type Consignment,\n    type FormField,\n} from '@bigcommerce/checkout-sdk';\nimport React, { type ReactElement } from 'react';\n\nimport { useCheckout } from '@bigcommerce/checkout/payment-integration-api';\nimport { LoadingOverlay } from '@bigcommerce/checkout/ui';\n\nimport { AddressForm, AddressSelect, AddressType, isValidCustomerAddress } from '../address';\nimport { connectFormik, type ConnectFormikProps } from '../common/form';\nimport { Fieldset } from '../ui/form';\n\nimport { type SingleShippingFormValues } from './SingleShippingForm';\n\nexport interface ShippingAddressFormProps {\n    address?: Address;\n    consignments: Consignment[];\n    isLoading: boolean;\n    formFields: FormField[];\n    onUseNewAddress(): void;\n    onFieldChange(fieldName: string, value: string): void;\n    onAddressSelect(address: Address): void;\n}\n\nconst addressFieldName = 'shippingAddress';\n\nconst ShippingAddressForm = (\n    {\n        address: shippingAddress,\n        onAddressSelect,\n        onUseNewAddress,\n        formFields,\n        isLoading,\n        formik: {\n            values: { shippingAddress: formAddress },\n            setFieldValue: formikSetFieldValue,\n        },\n        onFieldChange,\n    }: ShippingAddressFormProps & ConnectFormikProps<SingleShippingFormValues>,\n): ReactElement => {\n    const {\n        checkoutState:{\n            data:{\n                getCustomer,\n            },\n        },\n    } = useCheckout();\n\n    const customer = getCustomer();\n    const addresses = customer?.addresses || [];\n    const shouldShowSaveAddress = !(customer?.isGuest);\n\n    const setFieldValue = (fieldName: string, fieldValue: string) => {\n        const customFormFieldNames = formFields\n            .filter((field) => field.custom)\n            .map((field) => field.name);\n\n        const formFieldName = customFormFieldNames.includes(fieldName)\n            ? `customFields.${fieldName}`\n            : fieldName;\n\n        void formikSetFieldValue(`${addressFieldName}.${formFieldName}`, fieldValue);\n    };\n\n    const handleChange = (fieldName: string, value: string) => {\n        onFieldChange(fieldName, value);\n    };\n\n    const handleAutocompleteToggle = ({\n        isOpen,\n        inputValue,\n    }: {\n        inputValue: string;\n        isOpen: boolean;\n    }) => {\n        if (!isOpen) {\n            onFieldChange('address1', inputValue);\n        }\n    };\n\n    const hasAddresses = addresses && addresses.length > 0;\n    const hasValidCustomerAddress = isValidCustomerAddress(\n        shippingAddress,\n        addresses,\n        formFields,\n    );\n\n    return (\n        <Fieldset id=\"checkoutShippingAddress\">\n            {hasAddresses && (\n                <Fieldset id=\"shippingAddresses\">\n                    <LoadingOverlay isLoading={isLoading}>\n                        <AddressSelect\n                            addresses={addresses}\n                            onSelectAddress={onAddressSelect}\n                            onUseNewAddress={onUseNewAddress}\n                            selectedAddress={\n                                hasValidCustomerAddress ? shippingAddress : undefined\n                            }\n                            type={AddressType.Shipping}\n                        />\n                    </LoadingOverlay>\n                </Fieldset>\n            )}\n\n            {!hasValidCustomerAddress && (\n                <LoadingOverlay isLoading={isLoading} unmountContentWhenLoading>\n                    <AddressForm\n                        countryCode={formAddress && formAddress.countryCode}\n                        fieldName={addressFieldName}\n                        formFields={formFields}\n                        onAutocompleteToggle={handleAutocompleteToggle}\n                        onChange={handleChange}\n                        setFieldValue={setFieldValue}\n                        shouldShowSaveAddress={shouldShowSaveAddress}\n                        type={AddressType.Shipping}\n                    />\n                </LoadingOverlay>\n            )}\n        </Fieldset>\n    );\n};\n\nexport default connectFormik(ShippingAddressForm);\n","import {\n    type Address,\n    type Consignment,\n    type Country,\n    type CustomerAddress,\n    type FormField\n} from '@bigcommerce/checkout-sdk';\nimport React, { type FC, useEffect, useRef, useState } from 'react';\n\nimport {\n    isBigCommercePaymentsFastlaneMethod,\n    isBraintreeFastlaneMethod,\n    isPayPalCommerceFastlaneMethod,\n    isPayPalFastlaneMethod,\n    PayPalFastlaneShippingAddressForm,\n    usePayPalFastlaneAddress,\n} from '@bigcommerce/checkout/paypal-fastlane-integration';\nimport { LoadingOverlay } from '@bigcommerce/checkout/ui';\n\nimport { type ShippingAddressProps } from './ShippingAddress';\nimport ShippingAddressForm from './ShippingAddressForm';\n\nexport interface PayPalFastlaneShippingAddressProps extends ShippingAddressProps {\n    methodId?: string,\n    shippingAddress?:  Address,\n    consignments: Consignment[];\n    countries?: Country[];\n    formFields: FormField[],\n    handleFieldChange(fieldName: string, value: string): void,\n    onAddressSelect(address: Address): void;\n}\n\ninterface PayPalFastlaneAddressComponentRef {\n    showAddressSelector?: () => Promise<CustomerAddress | undefined>;\n}\n\nexport const PayPalFastlaneShippingAddress: FC<PayPalFastlaneShippingAddressProps> = (props) => {\n    const {\n        methodId,\n        formFields,\n        countries,\n        onAddressSelect,\n        onFieldChange,\n        onUnhandledError,\n        initialize,\n        deinitialize,\n        shippingAddress,\n        handleFieldChange,\n        isLoading\n    } = props;\n    const [isLoadingStrategy, setIsLoadingStrategyStrategy] = useState<boolean>(true);\n\n    const paypalFastlaneShippingComponent = useRef<PayPalFastlaneAddressComponentRef>({});\n    const fastlaneOptions = (provider: string) => {\n        return {\n            [provider]: {\n                onPayPalFastlaneAddressChange: (\n                    showPayPalFastlaneAddressSelector: PayPalFastlaneAddressComponentRef['showAddressSelector'],\n                ) => {\n                    paypalFastlaneShippingComponent.current.showAddressSelector =\n                        showPayPalFastlaneAddressSelector;\n                },\n            },\n        };\n    }\n\n    const initializeShippingStrategyOrThrow = async () => {\n        try {\n            await initialize({\n                methodId,\n                ...(isBigCommercePaymentsFastlaneMethod(methodId) ? fastlaneOptions('bigcommerce_payments_fastlane') : {}),\n                ...(isBraintreeFastlaneMethod(methodId) ? fastlaneOptions('braintreefastlane') : {}),\n                ...(isPayPalCommerceFastlaneMethod(methodId) ? fastlaneOptions('paypalcommercefastlane') : {})\n            });\n        } catch (error) {\n            if (typeof onUnhandledError === 'function' && error instanceof Error) {\n                onUnhandledError(error);\n            }\n        }\n\n        setIsLoadingStrategyStrategy(false);\n    };\n\n    const deinitializeShippingStrategyOrThrow = async () => {\n        try {\n            await deinitialize({ methodId });\n        } catch (error) {\n            if (typeof onUnhandledError === 'function' && error instanceof Error) {\n                onUnhandledError(error);\n            }\n        }\n    };\n\n    useEffect(() => {\n        void initializeShippingStrategyOrThrow();\n\n        return () => {\n            void deinitializeShippingStrategyOrThrow();\n        };\n    }, []);\n\n    const { shouldShowPayPalFastlaneShippingForm } = usePayPalFastlaneAddress();\n\n    return (\n        <LoadingOverlay hideContentWhenLoading isLoading={isLoadingStrategy || isLoading}>\n            {methodId && isPayPalFastlaneMethod(methodId) && shippingAddress && shouldShowPayPalFastlaneShippingForm ? (\n                <PayPalFastlaneShippingAddressForm\n                    address={shippingAddress}\n                    countries={countries}\n                    deinitialize={deinitialize}\n                    formFields={formFields}\n                    initialize={initialize}\n                    isLoading={isLoadingStrategy}\n                    methodId={methodId}\n                    onAddressSelect={onAddressSelect}\n                    onFieldChange={onFieldChange}\n                    onUnhandledError={onUnhandledError}\n                    paypalFastlaneShippingComponentRef={paypalFastlaneShippingComponent}\n                />\n            ) : (\n                <ShippingAddressForm\n                    address={shippingAddress}\n                    consignments={props.consignments}\n                    formFields={formFields}\n                    isLoading={isLoadingStrategy}\n                    onAddressSelect={onAddressSelect}\n                    onFieldChange={handleFieldChange}\n                    onUseNewAddress={props.onUseNewAddress}\n                />\n            )}\n        </LoadingOverlay>\n    );\n};\n","import {\n    type Address,\n    type CheckoutSelectors,\n    type Consignment,\n    type FormField,\n    type ShippingInitializeOptions,\n    type ShippingRequestOptions,\n} from '@bigcommerce/checkout-sdk';\nimport React, { type FunctionComponent, memo, useContext } from 'react';\n\nimport { isPayPalFastlaneMethod } from '@bigcommerce/checkout/paypal-fastlane-integration';\nimport { FormContext } from '@bigcommerce/checkout/ui';\n\nimport { AmazonPayShippingAddress } from './AmazonPayShippingAddress';\nimport { PayPalFastlaneShippingAddress } from './PayPalFastlaneShippingAddress';\nimport ShippingAddressForm from './ShippingAddressForm';\n\nexport interface ShippingAddressProps {\n    consignments: Consignment[];\n    formFields: FormField[];\n    isLoading: boolean;\n    isShippingStepPending: boolean;\n    methodId?: string;\n    shippingAddress?: Address;\n    hasRequestedShippingOptions: boolean;\n    deinitialize(options: ShippingRequestOptions): Promise<CheckoutSelectors>;\n    initialize(options: ShippingInitializeOptions): Promise<CheckoutSelectors>;\n    onAddressSelect(address: Address): void;\n    onFieldChange(name: string, value: string): void;\n    onUnhandledError?(error: Error): void;\n    onUseNewAddress(): void;\n}\n\nconst ShippingAddress: FunctionComponent<ShippingAddressProps> = (props) => {\n    const {\n        methodId,\n        formFields,\n        consignments,\n        onAddressSelect,\n        onFieldChange,\n        onUseNewAddress,\n        isLoading,\n        shippingAddress,\n        hasRequestedShippingOptions,\n    } = props;\n\n    const { setSubmitted } = useContext(FormContext);\n\n    const handleFieldChange: (fieldName: string, value: string) => void = (fieldName, value) => {\n        if (hasRequestedShippingOptions) {\n            setSubmitted(true);\n        }\n\n        onFieldChange(fieldName, value);\n    };\n\n    if (methodId && isPayPalFastlaneMethod(methodId) && shippingAddress) {\n        return (\n            <PayPalFastlaneShippingAddress\n                {...props}\n                handleFieldChange={handleFieldChange}\n                methodId={methodId}\n                shippingAddress={shippingAddress}\n            />\n        )\n    }\n\n    if (methodId === 'amazonpay' && shippingAddress) {\n        return (\n            <AmazonPayShippingAddress\n                {...props}\n                shippingAddress={shippingAddress}\n            />\n        );\n    }\n\n    return (\n        <ShippingAddressForm\n            address={shippingAddress}\n            consignments={consignments}\n            formFields={formFields}\n            isLoading={isLoading}\n            onAddressSelect={onAddressSelect}\n            onFieldChange={handleFieldChange}\n            onUseNewAddress={onUseNewAddress}\n        />\n    );\n};\n\nexport default memo(ShippingAddress);\n","export const SHIPPING_ADDRESS_FIELDS = [\n    'address1',\n    'postalCode',\n    'countryCode',\n    'city',\n    'stateOrProvince',\n    'stateOrProvinceCode',\n];\n","import { ExtensionRegion } from '@bigcommerce/checkout-sdk';\nimport React, { type FunctionComponent } from 'react';\n\nimport { Extension } from '@bigcommerce/checkout/checkout-extension';\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\nimport { useThemeContext } from '@bigcommerce/checkout/ui';\n\nimport { OrderComments } from '../orderComments';\nimport { Alert, AlertType } from '../ui/alert';\nimport { Button, ButtonVariant } from '../ui/button';\nimport { Fieldset, Legend } from '../ui/form';\n\nimport { ShippingOptions } from './shippingOption';\n\nexport interface ShippingFormFooterProps {\n    cartHasChanged: boolean;\n    isMultiShippingMode: boolean;\n    shouldShowOrderComments: boolean;\n    shouldShowShippingOptions?: boolean;\n    shouldDisableSubmit: boolean;\n    isInitialValueLoaded: boolean;\n    isLoading: boolean;\n    shippingFormRenderTimestamp?: number;\n}\n\nconst ShippingFormFooter: FunctionComponent<ShippingFormFooterProps> = ({\n    cartHasChanged,\n    isMultiShippingMode,\n    shouldShowOrderComments,\n    shouldShowShippingOptions = true,\n    shouldDisableSubmit,\n    isInitialValueLoaded,\n    isLoading,\n    shippingFormRenderTimestamp,\n}) => {\n    const { themeV2 } = useThemeContext();\n\n    return (\n        <>\n            <Extension region={ExtensionRegion.ShippingShippingAddressFormAfter} />\n            <Fieldset\n                id=\"checkout-shipping-options\"\n                legend={\n                    <>\n                        <Legend themeV2={themeV2}>\n                            <TranslatedString id=\"shipping.shipping_method_label\" />\n                        </Legend>\n\n                        {cartHasChanged && (\n                            <Alert type={AlertType.Error}>\n                                <strong>\n                                    <TranslatedString id=\"shipping.cart_change_error\" />\n                                </strong>\n                            </Alert>\n                        )}\n                    </>\n                }\n            >\n                <ShippingOptions\n                    isInitialValueLoaded={isInitialValueLoaded}\n                    isMultiShippingMode={isMultiShippingMode}\n                    isUpdatingAddress={isLoading}\n                    shippingFormRenderTimestamp={shippingFormRenderTimestamp}\n                    shouldShowShippingOptions={shouldShowShippingOptions}\n                />\n            </Fieldset>\n\n            {shouldShowOrderComments && <OrderComments />}\n\n            <div className=\"form-actions\">\n                <Button\n                    className={themeV2 ? 'body-bold' : ''}\n                    disabled={shouldDisableSubmit}\n                    id=\"checkout-shipping-continue\"\n                    isLoading={isLoading}\n                    type=\"submit\"\n                    variant={ButtonVariant.Primary}\n                >\n                    <TranslatedString id=\"common.continue_action\" />\n                </Button>\n            </div>\n        </>\n    );\n};\n\nexport default ShippingFormFooter;\n","import {\n    type Address,\n    type CheckoutParams,\n    type CheckoutSelectors,\n    type Consignment,\n    type CustomerRequestOptions,\n    type FormField,\n    type RequestOptions,\n    type ShippingInitializeOptions,\n    type ShippingRequestOptions,\n} from '@bigcommerce/checkout-sdk';\nimport { type FormikProps } from 'formik';\nimport { debounce, isEqual, noop } from 'lodash';\nimport React, { PureComponent, type ReactNode } from 'react';\nimport { lazy, object } from 'yup';\n\nimport { withLanguage, type WithLanguageProps } from '@bigcommerce/checkout/locale';\nimport { FormContext } from '@bigcommerce/checkout/ui';\n\nimport {\n    type AddressFormValues,\n    getAddressFormFieldsValidationSchema,\n    getTranslateAddressError,\n    isEqualAddress,\n    mapAddressFromFormValues,\n    mapAddressToFormValues,\n} from '../address';\nimport { withFormikExtended } from '../common/form';\nimport { getCustomFormFieldsValidationSchema } from '../formFields';\nimport { PaymentMethodId } from '../payment/paymentMethod';\nimport { Fieldset, Form } from '../ui/form';\n\nimport BillingSameAsShippingField from './BillingSameAsShippingField';\nimport hasSelectedShippingOptions from './hasSelectedShippingOptions';\nimport isSelectedShippingOptionValid from './isSelectedShippingOptionValid';\nimport ShippingAddress from './ShippingAddress';\nimport { SHIPPING_ADDRESS_FIELDS } from './ShippingAddressFields';\nimport ShippingFormFooter from './ShippingFormFooter';\n\nexport interface SingleShippingFormProps {\n    isBillingSameAsShipping: boolean;\n    cartHasChanged: boolean;\n    consignments: Consignment[];\n    customerMessage: string;\n    isLoading: boolean;\n    isShippingStepPending: boolean;\n    isMultiShippingMode: boolean;\n    methodId?: string;\n    shippingAddress?: Address;\n    shippingAutosaveDelay?: number;\n    shouldShowOrderComments: boolean;\n    isInitialValueLoaded: boolean;\n    shippingFormRenderTimestamp?: number;\n    deinitialize(options: ShippingRequestOptions): Promise<CheckoutSelectors>;\n    deleteConsignments(): Promise<Address | undefined>;\n    getFields(countryCode?: string): FormField[];\n    initialize(options: ShippingInitializeOptions): Promise<CheckoutSelectors>;\n    onSubmit(values: SingleShippingFormValues): void;\n    onUnhandledError?(error: Error): void;\n    signOut(options?: CustomerRequestOptions): void;\n    updateAddress(\n        address: Partial<Address>,\n        options?: RequestOptions<CheckoutParams>,\n    ): Promise<CheckoutSelectors>;\n}\n\nexport interface SingleShippingFormValues {\n    billingSameAsShipping: boolean;\n    shippingAddress?: AddressFormValues;\n    orderComment: string;\n}\n\ninterface SingleShippingFormState {\n    isResettingAddress: boolean;\n    isUpdatingShippingData: boolean;\n    hasRequestedShippingOptions: boolean;\n}\n\nfunction shouldHaveCustomValidation(methodId?: string): boolean {\n    const methodIdsWithoutCustomValidation: string[] = [\n        PaymentMethodId.BraintreeAcceleratedCheckout,\n        PaymentMethodId.PayPalCommerceAcceleratedCheckout,\n    ];\n\n    return Boolean(methodId && !methodIdsWithoutCustomValidation.includes(methodId));\n}\n\nexport const SHIPPING_AUTOSAVE_DELAY = 1700;\n\nclass SingleShippingForm extends PureComponent<\n    SingleShippingFormProps & WithLanguageProps & FormikProps<SingleShippingFormValues>\n> {\n    static contextType = FormContext;\n\n    state: SingleShippingFormState = {\n        isResettingAddress: false,\n        isUpdatingShippingData: false,\n        hasRequestedShippingOptions: false,\n    };\n\n    private debouncedUpdateAddress: any;\n\n    constructor(\n        props: SingleShippingFormProps & WithLanguageProps & FormikProps<SingleShippingFormValues>,\n    ) {\n        super(props);\n\n        const { updateAddress } = this.props;\n\n        this.debouncedUpdateAddress = debounce(\n            async (address: Address, includeShippingOptions: boolean) => {\n                try {\n                    await updateAddress(address, {\n                        params: {\n                            include: {\n                                'consignments.availableShippingOptions': includeShippingOptions,\n                            },\n                        },\n                    });\n\n                    if (includeShippingOptions) {\n                        this.setState({ hasRequestedShippingOptions: true });\n                    }\n                } finally {\n                    this.setState({ isUpdatingShippingData: false });\n                }\n            },\n            props.shippingAutosaveDelay ?? SHIPPING_AUTOSAVE_DELAY,\n        );\n    }\n\n    componentDidUpdate({ shippingFormRenderTimestamp }: SingleShippingFormProps) {\n        const {\n            shippingFormRenderTimestamp: newShippingFormRenderTimestamp,\n            setValues,\n            getFields,\n            shippingAddress,\n            isBillingSameAsShipping,\n            customerMessage,\n            values,\n            setFieldValue,\n        } = this.props;\n\n        const stateOrProvinceCodeFormField = getFields(values && values.shippingAddress?.countryCode).find(\n            ({ name }) => name === 'stateOrProvinceCode',\n        );\n\n        // Workaround for a bug found during manual testing:\n        // When the shipping step first loads, the `stateOrProvinceCode` field may not be there.\n        // It later appears with an empty value if the selected country has states/provinces.\n        // To address this, we manually set `stateOrProvinceCode` in Formik.\n        if (\n            stateOrProvinceCodeFormField &&\n            shippingAddress?.stateOrProvinceCode &&\n            !values.shippingAddress?.stateOrProvinceCode\n        ) {\n            setFieldValue('shippingAddress.stateOrProvinceCode', shippingAddress.stateOrProvinceCode);\n        }\n\n        // This is for executing extension command, `ReRenderShippingForm`.\n        if (newShippingFormRenderTimestamp !== shippingFormRenderTimestamp) {\n            setValues({\n                billingSameAsShipping: isBillingSameAsShipping,\n                orderComment: customerMessage,\n                shippingAddress: mapAddressToFormValues(\n                    getFields(shippingAddress && shippingAddress.countryCode),\n                    shippingAddress,\n                ),\n            });\n        }\n    }\n\n    render(): ReactNode {\n        const {\n            cartHasChanged,\n            isInitialValueLoaded,\n            isLoading,\n            onUnhandledError,\n            methodId,\n            shippingAddress,\n            consignments,\n            shouldShowOrderComments,\n            initialize,\n            isValid,\n            deinitialize,\n            values: { shippingAddress: addressForm },\n            isShippingStepPending,\n            shippingFormRenderTimestamp,\n        } = this.props;\n\n        const { isResettingAddress, isUpdatingShippingData, hasRequestedShippingOptions } =\n            this.state;\n\n        const PAYMENT_METHOD_VALID = ['amazonpay'];\n        const shouldShowBillingSameAsShipping = !PAYMENT_METHOD_VALID.some(\n            (method) => method === methodId,\n        );\n\n        return (\n            <Form autoComplete=\"on\">\n                <Fieldset>\n                    <ShippingAddress\n                        consignments={consignments}\n                        deinitialize={deinitialize}\n                        formFields={this.getFields(addressForm && addressForm.countryCode)}\n                        hasRequestedShippingOptions={hasRequestedShippingOptions}\n                        initialize={initialize}\n                        isLoading={isResettingAddress}\n                        isShippingStepPending={isShippingStepPending}\n                        methodId={methodId}\n                        onAddressSelect={this.handleAddressSelect}\n                        onFieldChange={this.handleFieldChange}\n                        onUnhandledError={onUnhandledError}\n                        onUseNewAddress={this.onUseNewAddress}\n                        shippingAddress={shippingAddress}\n                    />\n                    {shouldShowBillingSameAsShipping && (\n                        <div className=\"form-body\">\n                            <BillingSameAsShippingField />\n                        </div>\n                    )}\n                </Fieldset>\n\n                <ShippingFormFooter\n                    cartHasChanged={cartHasChanged}\n                    isInitialValueLoaded={isInitialValueLoaded}\n                    isLoading={isLoading || isUpdatingShippingData}\n                    isMultiShippingMode={false}\n                    shippingFormRenderTimestamp={shippingFormRenderTimestamp}\n                    shouldDisableSubmit={this.shouldDisableSubmit()}\n                    shouldShowOrderComments={shouldShowOrderComments}\n                    shouldShowShippingOptions={isValid}\n                />\n            </Form>\n        );\n    }\n\n    private shouldDisableSubmit: () => boolean = () => {\n        const { isLoading, consignments, isValid } = this.props;\n\n        const { isUpdatingShippingData } = this.state;\n\n        if (!isValid) {\n            return false;\n        }\n\n        return isLoading || isUpdatingShippingData || !hasSelectedShippingOptions(consignments) || !isSelectedShippingOptionValid(consignments);\n    };\n\n    private handleFieldChange: (name: string) => void = async (name) => {\n        const { setFieldValue } = this.props;\n\n        if (name === 'countryCode') {\n            setFieldValue('shippingAddress.stateOrProvince', '');\n            setFieldValue('shippingAddress.stateOrProvinceCode', '');\n        }\n\n        // Enqueue the following code to run after Formik has run validation\n        await new Promise((resolve) => setTimeout(resolve));\n\n        const isShippingField = SHIPPING_ADDRESS_FIELDS.includes(name);\n\n        const { hasRequestedShippingOptions } = this.state;\n\n        const { isValid } = this.props;\n\n        if (!isValid) {\n            return;\n        }\n\n        this.updateAddressWithFormData(isShippingField || !hasRequestedShippingOptions);\n    };\n\n    private updateAddressWithFormData(includeShippingOptions: boolean) {\n        const {\n            shippingAddress,\n            values: { shippingAddress: addressForm },\n        } = this.props;\n\n        const updatedShippingAddress = addressForm && mapAddressFromFormValues(addressForm);\n\n        if (Array.isArray(shippingAddress?.customFields)) {\n            includeShippingOptions = !isEqual(\n                shippingAddress?.customFields,\n                updatedShippingAddress?.customFields\n            ) || includeShippingOptions;\n        }\n\n        if (!updatedShippingAddress || isEqualAddress(updatedShippingAddress, shippingAddress)) {\n            return;\n        }\n\n        this.setState({ isUpdatingShippingData: true });\n        this.debouncedUpdateAddress(updatedShippingAddress, includeShippingOptions);\n    }\n\n    private handleAddressSelect: (address: Address) => void = async (address) => {\n        const { updateAddress, onUnhandledError = noop, values, setValues } = this.props;\n\n        this.setState({ isResettingAddress: true });\n\n        try {\n            await updateAddress(address);\n\n            setValues({\n                ...values,\n                shippingAddress: mapAddressToFormValues(\n                    this.getFields(address.countryCode),\n                    address,\n                ),\n            });\n        } catch (error) {\n            onUnhandledError(error);\n        } finally {\n            this.setState({ isResettingAddress: false });\n        }\n    };\n\n    private onUseNewAddress: () => void = async () => {\n        const { deleteConsignments, onUnhandledError = noop, setValues, values } = this.props;\n\n        this.setState({ isResettingAddress: true });\n\n        try {\n            const address = await deleteConsignments();\n\n            setValues({\n                ...values,\n                shippingAddress: mapAddressToFormValues(\n                    this.getFields(address && address.countryCode),\n                    address,\n                ),\n            });\n        } catch (e) {\n            onUnhandledError(e);\n        } finally {\n            this.setState({ isResettingAddress: false });\n        }\n    };\n\n    private getFields(countryCode: string | undefined): FormField[] {\n        const { getFields } = this.props;\n\n        return getFields(countryCode);\n    }\n}\n\nexport default withLanguage(\n    withFormikExtended<SingleShippingFormProps & WithLanguageProps, SingleShippingFormValues>({\n        handleSubmit: (values, { props: { onSubmit } }) => {\n            onSubmit(values);\n        },\n        mapPropsToValues: ({\n            getFields,\n            shippingAddress,\n            isBillingSameAsShipping,\n            customerMessage,\n        }) => ({\n            billingSameAsShipping: isBillingSameAsShipping,\n            orderComment: customerMessage,\n            shippingAddress: mapAddressToFormValues(\n                getFields(shippingAddress && shippingAddress.countryCode),\n                shippingAddress,\n            ),\n        }),\n        isInitialValid: ({ shippingAddress, getFields, language }) =>\n            !!shippingAddress &&\n            getAddressFormFieldsValidationSchema({\n                language,\n                formFields: getFields(shippingAddress.countryCode),\n            }).isValidSync(shippingAddress),\n        validationSchema: ({\n            language,\n            getFields,\n            methodId,\n        }: SingleShippingFormProps & WithLanguageProps) =>\n            shouldHaveCustomValidation(methodId)\n                ? object({\n                      shippingAddress: lazy<Partial<AddressFormValues>>((formValues) =>\n                          getCustomFormFieldsValidationSchema({\n                              translate: getTranslateAddressError(language),\n                              formFields: getFields(formValues && formValues.countryCode),\n                          }),\n                      ),\n                  })\n                : object({\n                      shippingAddress: lazy<Partial<AddressFormValues>>((formValues) =>\n                          getAddressFormFieldsValidationSchema({\n                              language,\n                              formFields: getFields(formValues && formValues.countryCode),\n                          }),\n                      ),\n                  }),\n        enableReinitialize: false, // This is false due to the concern that a shopper may lose typed details if somehow checkout state changes in the middle.\n    })(SingleShippingForm),\n);\n","import {\n    type Address,\n    type Cart,\n    type CheckoutParams,\n    type CheckoutSelectors,\n    type Consignment,\n    type CustomerRequestOptions,\n    type FormField,\n    type RequestOptions,\n    type ShippingInitializeOptions,\n    type ShippingRequestOptions,\n} from '@bigcommerce/checkout-sdk';\nimport React, { useEffect } from 'react';\n\nimport { withLanguage, type WithLanguageProps } from '@bigcommerce/checkout/locale';\nimport { useCheckout } from '@bigcommerce/checkout/payment-integration-api';\n\nimport isUsingMultiShipping from './isUsingMultiShipping';\nimport MultiShippingForm, { type MultiShippingFormValues } from './MultiShippingForm';\nimport SingleShippingForm, { type SingleShippingFormValues } from './SingleShippingForm';\n\nexport interface ShippingFormProps {\n    cart: Cart;\n    cartHasChanged: boolean;\n    consignments: Consignment[];\n    customerMessage: string;\n    isBillingSameAsShipping: boolean;\n    isGuest: boolean;\n    isLoading: boolean;\n    isShippingStepPending: boolean;\n    isMultiShippingMode: boolean;\n    methodId?: string;\n    shippingAddress?: Address;\n    shouldShowOrderComments: boolean;\n    isInitialValueLoaded: boolean;\n    deinitialize(options: ShippingRequestOptions): Promise<CheckoutSelectors>;\n    deleteConsignments(): Promise<Address | undefined>;\n    getFields(countryCode?: string): FormField[];\n    initialize(options: ShippingInitializeOptions): Promise<CheckoutSelectors>;\n    onCreateAccount(): void;\n    onMultiShippingSubmit(values: MultiShippingFormValues): void;\n    onSignIn(): void;\n    onSingleShippingSubmit(values: SingleShippingFormValues): void;\n    onUnhandledError(error: Error): void;\n    signOut(options?: CustomerRequestOptions): void;\n    updateAddress(\n        address: Partial<Address>,\n        options: RequestOptions<CheckoutParams>,\n    ): Promise<CheckoutSelectors>;\n    shippingFormRenderTimestamp?: number;\n    setIsMultishippingMode(isMultiShippingMode: boolean): void;\n}\n\nconst ShippingForm = ({\n    cart,\n    cartHasChanged,\n    consignments,\n    customerMessage,\n    deinitialize,\n    deleteConsignments,\n    getFields,\n    initialize,\n    isBillingSameAsShipping,\n    isLoading,\n    isMultiShippingMode,\n    methodId,\n    onMultiShippingSubmit,\n    onSingleShippingSubmit,\n    onUnhandledError,\n    shippingAddress,\n    shouldShowOrderComments,\n    signOut,\n    updateAddress,\n    isShippingStepPending,\n    isInitialValueLoaded,\n    shippingFormRenderTimestamp,\n    setIsMultishippingMode,\n}: ShippingFormProps & WithLanguageProps) => {\n    const {\n        checkoutState: {\n            data: { getConfig },\n        },\n    } = useCheckout();\n    const config = getConfig();\n\n    useEffect(() => {\n        if (shippingFormRenderTimestamp) {\n            const hasMultiShippingEnabled = config?.checkoutSettings?.hasMultiShippingEnabled ?? false;\n            const isMultiShippingMode =\n                !!cart &&\n                !!consignments &&\n                hasMultiShippingEnabled &&\n                isUsingMultiShipping(consignments, cart.lineItems);\n\n            setIsMultishippingMode(isMultiShippingMode);\n        }\n    }, [shippingFormRenderTimestamp]);\n\n    const getMultiShippingForm = () => {\n        return <MultiShippingForm\n            cartHasChanged={cartHasChanged}\n            customerMessage={customerMessage}\n            defaultCountryCode={shippingAddress?.countryCode}\n            isLoading={isLoading}\n            onSubmit={onMultiShippingSubmit}\n            onUnhandledError={onUnhandledError}\n        />;\n    };\n\n    return isMultiShippingMode ? (\n        getMultiShippingForm()\n    ) : (\n        <SingleShippingForm\n            cartHasChanged={cartHasChanged}\n            consignments={consignments}\n            customerMessage={customerMessage}\n            deinitialize={deinitialize}\n            deleteConsignments={deleteConsignments}\n            getFields={getFields}\n            initialize={initialize}\n            isBillingSameAsShipping={isBillingSameAsShipping}\n            isInitialValueLoaded={isInitialValueLoaded}\n            isLoading={isLoading}\n            isMultiShippingMode={isMultiShippingMode}\n            isShippingStepPending={isShippingStepPending}\n            methodId={methodId}\n            onSubmit={onSingleShippingSubmit}\n            onUnhandledError={onUnhandledError}\n            shippingAddress={shippingAddress}\n            shippingFormRenderTimestamp={shippingFormRenderTimestamp}\n            shouldShowOrderComments={shouldShowOrderComments}\n            signOut={signOut}\n            updateAddress={updateAddress}\n        />\n    );\n};\n\nexport default withLanguage(ShippingForm);\n","import { ExtensionRegion } from '@bigcommerce/checkout-sdk';\nimport classNames from 'classnames';\nimport React, { type FunctionComponent, memo, useState } from 'react';\n\nimport { Extension } from '@bigcommerce/checkout/checkout-extension';\nimport { preventDefault } from '@bigcommerce/checkout/dom-utils';\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\nimport { ConfirmationModal , useThemeContext } from '@bigcommerce/checkout/ui';\n\nimport { Legend } from '../ui/form';\n\nimport './ShippingHeader.scss';\n\ninterface ShippingHeaderProps {\n    isMultiShippingMode: boolean;\n    shouldShowMultiShipping: boolean;\n    onMultiShippingChange(): void;\n    cartHasPromotionalItems?: boolean;\n}\n\nconst ShippingHeader: FunctionComponent<ShippingHeaderProps> = ({\n    isMultiShippingMode,\n    onMultiShippingChange,\n    shouldShowMultiShipping,\n    cartHasPromotionalItems,\n}) => {\n    const [isSingleShippingConfirmationModalOpen, setIsSingleShippingConfirmationModalOpen] = useState(false);\n    const [isMultiShippingUnavailableModalOpen, setIsMultiShippingUnavailableModalOpen] = useState(false);\n\n    const { themeV2 } = useThemeContext();\n\n    const handleShipToSingleConfirmation = () => {\n        setIsSingleShippingConfirmationModalOpen(false);\n        onMultiShippingChange();\n    }\n\n    const showConfirmationModal = shouldShowMultiShipping && isMultiShippingMode;\n    const showMultiShippingUnavailableModal = shouldShowMultiShipping && !isMultiShippingMode && cartHasPromotionalItems;\n\n    return (\n        <>\n            <Extension region={ExtensionRegion.ShippingShippingAddressFormBefore} />\n            <div className={classNames(['form-legend-container', 'shipping-header'])}>\n                <Legend testId=\"shipping-address-heading\" themeV2={themeV2}>\n                    <TranslatedString\n                        id={\n                            isMultiShippingMode\n                                ? 'shipping.multishipping_address_heading'\n                                : 'shipping.shipping_address_heading'\n                        }\n                    />\n                </Legend>\n\n                {showConfirmationModal && (\n                    <>\n                        <ConfirmationModal\n                            action={handleShipToSingleConfirmation}\n                            actionButtonLabel={<TranslatedString id=\"common.proceed_action\" />}\n                            headerId=\"shipping.ship_to_single_action\"\n                            isModalOpen={isSingleShippingConfirmationModalOpen}\n                            messageId=\"shipping.ship_to_single_message\"\n                            onRequestClose={() => setIsSingleShippingConfirmationModalOpen(false)}\n                        />\n                        <a\n                            className={themeV2 ? 'body-cta' : ''}\n                            data-test=\"shipping-mode-toggle\"\n                            href=\"#\"\n                            onClick={preventDefault(() => setIsSingleShippingConfirmationModalOpen(true))}\n                        >\n                            <TranslatedString id=\"shipping.ship_to_single\" />\n                        </a>\n                    </>\n                )}\n                {showMultiShippingUnavailableModal && (\n                    <>\n                        <ConfirmationModal\n                            action={() => setIsMultiShippingUnavailableModalOpen(false)}\n                            actionButtonLabel={<TranslatedString id=\"common.back_action\" />}\n                            headerId=\"shipping.multishipping_unavailable_action\"\n                            isModalOpen={isMultiShippingUnavailableModalOpen}\n                            messageId=\"shipping.multishipping_unavailable_message\"\n                            onRequestClose={() => setIsMultiShippingUnavailableModalOpen(false)}\n                        />\n                        <a\n                            className={themeV2 ? 'body-cta' : ''}\n                            data-test=\"shipping-mode-toggle\"\n                            href=\"#\"\n                            onClick={preventDefault(() => setIsMultiShippingUnavailableModalOpen(true))}\n                        >\n                            <TranslatedString id=\"shipping.ship_to_multi\" />\n                        </a>\n                    </>\n                )}\n                {!showConfirmationModal && !showMultiShippingUnavailableModal && shouldShowMultiShipping && (\n                    <a\n                        className={themeV2 ? 'body-cta' : ''}\n                        data-test=\"shipping-mode-toggle\"\n                        href=\"#\"\n                        onClick={preventDefault(onMultiShippingChange)}\n                    >\n                        <TranslatedString\n                            id={isMultiShippingMode ? 'shipping.ship_to_single' : 'shipping.ship_to_multi'}\n                        />\n                    </a>\n                )}\n            </div>\n        </>\n    );\n}\n\nexport default memo(ShippingHeader);\n","import {\n  type CheckoutSelectors,\n  type ShippingInitializeOptions,\n  type ShippingRequestOptions,\n} from '@bigcommerce/checkout-sdk';\nimport { noop } from 'lodash';\nimport React, { type FC, useEffect } from 'react';\n\nexport interface StripeupeShippingAddressProps {\n  methodId?: string;\n  deinitialize(options?: ShippingRequestOptions): Promise<CheckoutSelectors>;\n  initialize(options?: ShippingInitializeOptions): Promise<CheckoutSelectors>;\n  onUnhandledError?(error: Error): void;\n}\n\nconst StripeShippingAddressDisplay: FC<StripeupeShippingAddressProps> = ({\n   methodId,\n   initialize,\n   deinitialize,\n   onUnhandledError = noop,\n }) => {\n\n  useEffect(() => {\n    const runInitialize = async () => {\n      try {\n        await initialize({ methodId });\n      } catch (error) {\n        onUnhandledError(error as Error);\n      }\n    };\n\n    void runInitialize();\n\n    return () => {\n      const runDeinitialize = async () => {\n        try {\n          await deinitialize({ methodId });\n        } catch (error) {\n          onUnhandledError(error as Error);\n        }\n      };\n\n      void runDeinitialize();\n    };\n  }, []);\n\n  return (\n    <>\n      <div className=\"stepHeader\" style={{ padding: 0 }}>\n        <div id=\"StripeUpeShipping\" style={{ width: '100%' }} />\n      </div>\n      <br />\n    </>\n  );\n};\n\nexport default StripeShippingAddressDisplay;\n","interface StripeCountryMapping {\n    [key: string]: StripeStateMapping;\n}\n\ninterface StripeStateMapping {\n    [key: string]: string;\n}\n\nexport default function StripeStateMapper(\n    country: string,\n    state: string,\n): string {\n\n    const countries: StripeCountryMapping = {\n        'MX': {\n            'Ags.': 'AGU',\n            'B.C.': 'BCN',\n            'B.C.S.': 'BCS',\n            'Camp.': 'CAM',\n            'Coah.': 'COA',\n            'Col.': 'COL',\n            'Chis.': 'CHP',\n            'Chih.': 'CHH',\n            'Dgo.': 'DUR',\n            'Gto.': 'GUA',\n            'Gro.': 'GRO',\n            'Hgo.': 'HID',\n            'Jal.': 'JAL',\n            'Mx.': 'MEX',\n            'CDMX': 'MEX',\n            'Mich.': 'MIC',\n            'Mor.': 'MOR',\n            'Nay.': 'NAY',\n            'N.L.': 'NLE',\n            'Oax.': 'OAX',\n            'Pue.': 'PUE',\n            'Qro.': 'QUE',\n            'Q.R.': 'ROO',\n            'S.L.P.': 'SLP',\n            'Sin.': 'SIN',\n            'Son.': 'SON',\n            'Tab.': 'TAB',\n            'Tamps.': 'TAM',\n            'Tlax.': 'TLA',\n            'Ver.': 'VER',\n            'Yuc.': 'YUC',\n            'Zac.': 'ZAC',\n        },\n        'AR': {\n            'Ciudad Autnoma de Buenos Aires': 'C',\n            'Buenos Aires': 'B',\n            'Catamarca': 'K',\n            'Chaco': 'H',\n            'Chubut': 'U',\n            'Crdoba': 'X',\n            'Corrientes': 'W',\n            'Entre Ros': 'E',\n            'Formosa': 'P',\n            'Jujuy': 'Y',\n            'La Pampa': 'L',\n            'La Rioja': 'F',\n            'Mendoza': 'M',\n            'Misiones': 'N',\n            'Neuqun': 'Q',\n            'Salta': 'A',\n            'San Juan': 'J',\n            'San Luis': 'D',\n            'Santa Fe': 'S',\n            'Santiago del Estero': 'G',\n            'Tierra del Fuego': 'V',\n            'Tucumn': 'W',\n        },\n        'IN': {\n            'Andhra Pradesh': 'AP',\n            'Arunachal Pradesh': 'AR',\n            'Assam': 'AS',\n            'Bihar': 'BR',\n            'Chhattisgarh': 'CG',\n            'Goa': 'GA',\n            'Gujarat': 'GJ',\n            'Haryana': 'HR',\n            'Himachal Pradesh': 'HP',\n            'Jammu and Kashmir': 'JK',\n            'Jharkhand': 'JH',\n            'Karnataka': 'KA',\n            'Kerala': 'KL',\n            'Madhya Pradesh': 'MP',\n            'Maharashtra': 'MH',\n            'Manipur': 'MN',\n            'Meghalaya': 'ML',\n            'Mizoram': 'MZ',\n            'Nagaland': 'NL',\n            'Odisha': 'OR',\n            'Punjab': 'PB',\n            'Rajasthan': 'RJ',\n            'Sikkim': 'SK',\n            'Tamil Nadu': 'TN',\n            'Tripura': 'TR',\n            'Uttarakhand': 'UK',\n            'Uttar Pradesh': 'UP',\n            'West Bengal': 'WB',\n            'Andaman and Nicobar Islands': 'AN',\n            'Chandigarh': 'CH',\n            'Dadra and Nagar Haveli and Daman and Diu': 'DN',\n            'Lakshadweep': 'LD',\n            'Delhi': 'DL',\n            'Puducherry': 'PY',\n            'Telangana': 'TS',\n        },\n        'ID': {\n            'Bali': 'BA',\n            'Banten': 'BT',\n            'Bengkulu': 'BE',\n            'Aceh': 'DA',\n            'DKI Jakarta': 'JK',\n            'Sumatera Utara': 'SU',\n            'Sumatera Barat': 'SB',\n            'Riau': 'SI',\n            'Jambi': 'JA',\n            'Sumatera Selatan': 'SS',\n            'Lampung': 'LA',\n            'Jawa Barat': 'JB',\n            'Jawa Timur': 'JT',\n            'Daerah Istimewa Yogyakarta': 'DY',\n            'Kalimantan Barat': 'KB',\n            'Kalimantan Tengah': 'KT',\n            'Kalimantan Timur': 'KI',\n            'Kalimantan Selatan': 'KS',\n            'Nusa Tenggara Barat': 'NB',\n            'Nusa Tenggara Timur': 'NT',\n            'Sulawesi Selatan': 'SN',\n            'Sulawesi Tengah': 'ST',\n            'Sulawesi Utara': 'SA',\n            'Sulawesi Tenggara': 'SG',\n            'Maluku': 'MA',\n            'Maluku Utara': 'MU',\n            'Gorontalo': 'GO',\n        },\n        'MY': {\n            'Johor': 'JHR',\n            'Kedah': 'KDH',\n            'Kelantan': 'KTN',\n            'Melaka': 'MLK',\n            'Negeri Sembilan': 'NSN',\n            'Pahang': 'PHG',\n            'Pulau Pinang': 'PNG',\n            'Perak': 'PRK',\n            'Perlis': 'PLS',\n            'Selangor': 'SGR',\n            'Terengganu': 'TRG',\n            'Sabah': 'SBH',\n            'Sarawak': 'SRW',\n            'Kuala Lumpur': 'KUL',\n            'Labuan': 'LBN',\n            'Putrajaya': 'PJY',\n        },\n        'IE': {\n            'Carlow': 'CW',\n            'Cavan': 'CN',\n            'Clare': 'CE',\n            'Donegal': 'DL',\n            'Dublin': 'D',\n            'Galway': 'G',\n            'Kildare': 'KE',\n            'Kilkenny': 'KK',\n            'Laois': 'LS',\n            'Leitrim': 'LM',\n            'Longford': 'LD',\n            'Louth': 'LH',\n            'Mayo': 'MO',\n            'Meath': 'MH',\n            'Monaghan': 'MN',\n            'Offaly': 'OY',\n            'Roscommon': 'RN',\n            'Sligo': 'SO',\n            'Tipperary': 'TA',\n            'Waterford': 'WD',\n            'Westmeath': 'WH',\n            'Wexford': 'WX',\n            'Wicklow': 'WW',\n        },\n        'JP': {\n            'Aichi': '23',\n            'Akita': '05',\n            'Aomori': '02',\n            'Chiba': '12',\n            'Ehime': '38',\n            'Fukui': '18',\n            'Fukuoka': '40',\n            'Fukushima': '07',\n            'Gifu': '21',\n            'Gunma': '10',\n            'Hiroshima': '34',\n            'Hokkaido': '01',\n            'Hyogo': '28',\n            'Ibaraki': '08',\n            'Ishikawa': '17',\n            'Iwate': '03',\n            'Kagawa': '37',\n            'Kagoshima': '46',\n            'Kanagawa': '14',\n            'Kochi': '39',\n            'Kumamoto': '43',\n            'Kyoto': '26',\n            'Mie': '24',\n            'Miyagi': '04',\n            'Miyazaki': '45',\n            'Nagano': '20',\n            'Nagasaki': '42',\n            'Nara': '29',\n            'Niigata': '15',\n            'Oita': '44',\n            'Okayama': '33',\n            'Okinawa': '47',\n            'Osaka': '27',\n            'Saga': '41',\n            'Saitama': '11',\n            'Shiga': '25',\n            'Shimane': '32',\n            'Shizuoka': '22',\n            'Tochigi': '09',\n            'Tokushima': '36',\n            'Tokyo': '13',\n            'Tottori': '31',\n            'Toyama': '16',\n            'Wakayama': '30',\n            'Yamagata': '06',\n            'Yamaguchi': '35',\n            'Yamanashi': '19'\n        },\n    };\n\n    if (countries[country]) {\n        return countries[country][state] ?? getStripeState(countries[country], state);\n    }\n\n    return state;\n}\n\nfunction getStripeState(stateList: StripeStateMapping, state: string) {\n    return Object.keys(stateList).find(key => stateList[key] === state) || state;\n}\n","import {\n    type Address,\n    type CheckoutSelectors,\n    type Consignment,\n    type Country,\n    type ShippingInitializeOptions,\n    type ShippingRequestOptions,\n    type StripeShippingEvent\n} from '@bigcommerce/checkout-sdk';\nimport { memoizeOne } from '@bigcommerce/memoize';\nimport React, { type FunctionComponent, memo, useCallback, useEffect, useState } from 'react';\n\nimport { getAppliedStyles } from '@bigcommerce/checkout/dom-utils';\n\nimport type CheckoutStepStatus from '../../checkout/CheckoutStepStatus';\nimport getRecommendedShippingOption from '../getRecommendedShippingOption';\nimport hasSelectedShippingOptions from '../hasSelectedShippingOptions';\nimport { type SingleShippingFormValues } from '../SingleShippingForm';\n\nimport StripeShippingAddressDisplay from './StripeShippingAddressDisplay';\nimport StripeStateMapper from './StripeStateMapper';\n\nexport interface StripeShippingAddressProps {\n    consignments: Consignment[];\n    countries?: Country[];\n    shippingAddress?: Address;\n    step: CheckoutStepStatus;\n    isShippingMethodLoading: boolean;\n    shouldDisableSubmit: boolean;\n    isStripeLoading?(): void;\n    isStripeAutoStep?(): void;\n    deinitialize(options: ShippingRequestOptions): Promise<CheckoutSelectors>;\n    initialize(options: ShippingInitializeOptions): Promise<CheckoutSelectors>;\n    onAddressSelect(address: Address): void;\n    onSubmit(values: SingleShippingFormValues): void;\n}\n\nconst StripeShippingAddress: FunctionComponent<StripeShippingAddressProps> = (props) => {\n    const {\n        countries,\n        consignments,\n        onAddressSelect,\n        initialize,\n        deinitialize,\n        shouldDisableSubmit,\n        onSubmit,\n        step,\n        isStripeLoading,\n        isStripeAutoStep,\n        isShippingMethodLoading,\n        shippingAddress,\n    } = props;\n\n    const [isNewAddress, setIsNewAddress] = useState(true);\n    const [isFirstShippingRender, setIsFirstShippingRender] = useState(true);\n    const [stripeShippingAddress, setStripeShippingAddress] =  useState({\n        firstName: '',\n        lastName: '',\n        company: '',\n        address1: '',\n        address2: '',\n        city: '',\n        stateOrProvince: '',\n        stateOrProvinceCode: '',\n        shouldSaveAddress: true,\n        country: '',\n        countryCode: '',\n        postalCode: '',\n        phone: '',\n        customFields: [],\n    });\n\n    const handleLoading = useCallback(() => {\n        if (isStripeLoading) {\n            isStripeLoading();\n        }\n    }, [isStripeLoading]);\n\n    useEffect(() => {\n        if (consignments[0]) {\n            const { availableShippingOptions } = consignments[0];\n\n            if (availableShippingOptions && !getRecommendedShippingOption(availableShippingOptions)) {\n                handleLoading();\n            }\n        }\n    }, [consignments]);\n\n    useEffect(() => {\n        const hasStripeAddressAndHasShippingOptions = stripeShippingAddress.firstName && hasSelectedShippingOptions(consignments);\n        const afterReload = !isFirstShippingRender && !isNewAddress && !isShippingMethodLoading;\n        const isLoadingBeforeAutoStep =  isStripeLoading && isStripeAutoStep;\n\n        if (hasStripeAddressAndHasShippingOptions && afterReload && isLoadingBeforeAutoStep) {\n            isStripeLoading();\n            isStripeAutoStep();\n            onSubmit({ billingSameAsShipping: true, shippingAddress: stripeShippingAddress, orderComment: '' });\n        }\n    }, [isFirstShippingRender, onSubmit, stripeShippingAddress, shouldDisableSubmit, isShippingMethodLoading, isNewAddress ,consignments]);\n\n    const availableShippingList = countries?.map(country => ({ code: country.code, name: country.name }));\n    const allowedCountries = availableShippingList ? availableShippingList.map(country => country.code).join(', ') : '';\n    const shouldShowContent = (isNewAddress = true, phoneFieldRequired: boolean, phone: string) => {\n        const stepCompleted = step.isComplete;\n        const shippingPopulated = shippingAddress?.firstName && isNewAddress;\n        const PhoneRequiredAndNotFilled = phoneFieldRequired && !phone;\n\n        return stepCompleted || shippingPopulated || PhoneRequiredAndNotFilled;\n    };\n\n    const handleStripeShippingAddress = useCallback(async (shipping: StripeShippingEvent) => {\n        const { complete, phoneFieldRequired, value: { address = { country: '', state: '', line1: '', line2: '', city: '', postal_code: '' }\n            , name = '', firstName = '', lastName = '', phone = '' } } = shipping;\n\n        if (complete) {\n            if (shouldShowContent(shipping?.isNewAddress, phoneFieldRequired, phone)) {\n                handleLoading();\n            }\n\n            const names = name?.split(' ');\n            const country = availableShippingList?.find(country => country.code === address.country)?.name;\n            const state = StripeStateMapper(address.country, address.state);\n            const shippingValue = {\n                firstName: firstName || names[0],\n                lastName: lastName || names[1],\n                company: '',\n                address1: address.line1,\n                address2: address.line2 || '',\n                city: address.city,\n                stateOrProvince: state,\n                stateOrProvinceCode: state,\n                shouldSaveAddress: true,\n                country: country || address.country,\n                countryCode: address.country,\n                postalCode: address.postal_code,\n                phone: phone || '',\n                customFields: [],\n            };\n\n            if (!step.isComplete) {\n                setIsFirstShippingRender(current => !current);\n            }\n\n            onAddressSelect(shippingValue);\n            setStripeShippingAddress(shippingValue);\n\n            if (shipping.isNewAddress !== isNewAddress) {\n                setIsNewAddress(current => !current);\n            }\n        } else {\n            handleLoading();\n        }\n\n    }, [availableShippingList, onAddressSelect]);\n\n    const initializeShipping = useCallback(\n        memoizeOne(\n            (defaultOptions: ShippingInitializeOptions) => (options?: ShippingInitializeOptions) =>\n                initialize({\n                    ...defaultOptions,\n                    ...options,\n                }),\n        ),\n        [],\n    );\n\n    const getStylesFromElement = (\n        id: string,\n        properties: string[]) => {\n        const parentContainer = document.getElementById(id);\n\n        if (parentContainer) {\n            return getAppliedStyles(parentContainer, properties);\n        }\n\n        return undefined;\n    };\n\n    const getStripeStyles: any = useCallback( () => {\n        const containerId = 'stripe-card-component-field';\n        const formInput = getStylesFromElement(`${containerId}--input`, ['color', 'background-color', 'border-color', 'box-shadow']);\n        const formLabel = getStylesFromElement(`${containerId}--label`, ['color']);\n        const formError = getStylesFromElement(`${containerId}--error`, ['color']);\n\n        return formLabel && formInput && formError ? {\n            labelText: formLabel.color,\n            fieldText: formInput.color,\n            fieldPlaceholderText: formInput.color,\n            fieldErrorText: formError.color,\n            fieldBackground: formInput['background-color'],\n            fieldInnerShadow: formInput['box-shadow'],\n            fieldBorder: formInput['border-color'],\n        } : undefined;\n    }, [])\n\n        const options: ShippingInitializeOptions = {\n            stripeupe: {\n                container: 'StripeUpeShipping',\n                onChangeShipping: handleStripeShippingAddress,\n                availableCountries: allowedCountries,\n                getStyles: getStripeStyles,\n                getStripeState: StripeStateMapper,\n                gatewayId: 'stripeupe',\n                methodId: 'card',\n            },\n        };\n\n        const renderCheckoutThemeStylesForStripeUPE = () => {\n            const containerId = 'stripe-card-component-field';\n\n            return (\n                <div\n                    className=\"optimizedCheckout-form-input\"\n                    id={ `${containerId}--input` }\n                >\n                    <div\n                        className=\"form-field--error\"\n                    >\n                        <div\n                            className=\"optimizedCheckout-form-label\"\n                            id={ `${containerId}--error` }\n                        />\n                    </div>\n                    <div\n                        className=\"optimizedCheckout-form-label\"\n                        id={ `${containerId}--label` }\n                    />\n                </div>\n            );\n        };\n\n        return (\n            <>\n                <StripeShippingAddressDisplay\n                    deinitialize={ deinitialize }\n                    initialize={ initializeShipping(options) }\n                    methodId=\"stripeupe\"\n                />\n                { renderCheckoutThemeStylesForStripeUPE() }\n            </>\n        );\n};\n\nexport default memo(StripeShippingAddress);\n","import {\n  type Address,\n  type CheckoutParams,\n  type CheckoutSelectors,\n  type FormField,\n  type RequestOptions,\n} from '@bigcommerce/checkout-sdk';\nimport { type FormikProps } from 'formik';\nimport { noop } from 'lodash';\nimport React, { useCallback, useState } from 'react';\nimport { lazy, object } from 'yup';\n\nimport { withLanguage, type WithLanguageProps } from '@bigcommerce/checkout/locale';\nimport { useCheckout } from '@bigcommerce/checkout/payment-integration-api';\n\nimport {\n  type AddressFormValues,\n  getAddressFormFieldsValidationSchema,\n  getTranslateAddressError,\n  mapAddressToFormValues,\n} from '../../address';\nimport type CheckoutStepStatus from '../../checkout/CheckoutStepStatus';\nimport { withFormikExtended } from '../../common/form';\nimport { EMPTY_ARRAY } from '../../common/utility';\nimport { getCustomFormFieldsValidationSchema } from '../../formFields';\nimport { Fieldset, Form } from '../../ui/form';\nimport BillingSameAsShippingField from '../BillingSameAsShippingField';\nimport hasSelectedShippingOptions from '../hasSelectedShippingOptions';\nimport ShippingFormFooter from '../ShippingFormFooter';\n\nimport StripeShippingAddress from './StripeShippingAddress';\n\nexport interface SingleShippingFormProps {\n  isBillingSameAsShipping: boolean;\n  cartHasChanged: boolean;\n  customerMessage: string;\n  isLoading: boolean;\n  isShippingMethodLoading: boolean;\n  isMultiShippingMode: boolean;\n  methodId?: string;\n  shippingAddress?: Address;\n  shouldShowOrderComments: boolean;\n  step: CheckoutStepStatus;\n  isInitialValueLoaded: boolean;\n  isStripeLoading?(): void;\n  isStripeAutoStep?(): void;\n  getFields(countryCode?: string): FormField[];\n  onSubmit(values: SingleShippingFormValues): void;\n  onUnhandledError?(error: Error): void;\n  updateAddress(\n    address: Partial<Address>,\n    options?: RequestOptions<CheckoutParams>,\n  ): Promise<CheckoutSelectors>;\n}\n\nexport interface SingleShippingFormValues {\n  billingSameAsShipping: boolean;\n  shippingAddress?: AddressFormValues;\n  orderComment: string;\n}\n\nconst StripeShippingForm: React.FC<SingleShippingFormProps & WithLanguageProps & FormikProps<SingleShippingFormValues>> = (props) => {\n  const { checkoutService, checkoutState } = useCheckout();\n  const {\n    data: {\n      getConsignments,\n      getShippingCountries,\n    },\n  } = checkoutState;\n\n  const consignments = getConsignments() || [];\n  const initialize = checkoutService.initializeShipping;\n  const deinitialize = checkoutService.deinitializeShipping;\n  const countries = getShippingCountries() || EMPTY_ARRAY;\n\n  const [isUpdatingShippingData] = useState(false);\n\n  const {\n    cartHasChanged,\n    isInitialValueLoaded,\n    isLoading,\n    isStripeLoading,\n    shippingAddress,\n    shouldShowOrderComments,\n    isValid,\n    onSubmit,\n    isStripeAutoStep,\n    step,\n    isShippingMethodLoading,\n    updateAddress,\n    onUnhandledError = noop,\n    values,\n    setValues,\n    getFields,\n  } = props;\n\n  const shouldDisableSubmit = () => {\n    if (!isValid) {\n      return false;\n    }\n\n    return isLoading || isUpdatingShippingData || !hasSelectedShippingOptions(consignments);\n  };\n\n  const handleAddressSelect = useCallback(async (address: Address) => {\n    try {\n      await updateAddress(address);\n\n      setValues({\n        ...values,\n        shippingAddress: mapAddressToFormValues(\n          getFields(address.countryCode),\n          address,\n        ),\n      });\n    } catch (error) {\n      onUnhandledError(error);\n    }\n  }, [values, setValues, onUnhandledError]);\n\n  return (\n    <Form autoComplete=\"on\">\n      <Fieldset>\n        <StripeShippingAddress\n          consignments={consignments}\n          countries={countries}\n          deinitialize={deinitialize}\n          initialize={initialize}\n          isShippingMethodLoading={isShippingMethodLoading}\n          isStripeAutoStep={isStripeAutoStep}\n          isStripeLoading={isStripeLoading}\n          onAddressSelect={handleAddressSelect}\n          onSubmit={onSubmit}\n          shippingAddress={shippingAddress}\n          shouldDisableSubmit={shouldDisableSubmit()}\n          step={step}\n        />\n\n        <div className=\"form-body\">\n          <BillingSameAsShippingField />\n        </div>\n      </Fieldset>\n\n      <ShippingFormFooter\n        cartHasChanged={cartHasChanged}\n        isInitialValueLoaded={isInitialValueLoaded}\n        isLoading={isLoading || isUpdatingShippingData}\n        isMultiShippingMode={false}\n        shouldDisableSubmit={shouldDisableSubmit()}\n        shouldShowOrderComments={shouldShowOrderComments}\n        shouldShowShippingOptions={isValid}\n      />\n    </Form>\n  );\n};\n\nexport default withLanguage(\n  withFormikExtended<SingleShippingFormProps & WithLanguageProps, SingleShippingFormValues>({\n    handleSubmit: (values, { props: { onSubmit } }) => {\n      onSubmit(values);\n    },\n    mapPropsToValues: ({\n         getFields,\n         shippingAddress,\n         isBillingSameAsShipping,\n         customerMessage,\n       }) => ({\n      billingSameAsShipping: isBillingSameAsShipping,\n      orderComment: customerMessage,\n      shippingAddress: mapAddressToFormValues(\n        getFields(shippingAddress && shippingAddress.countryCode),\n        shippingAddress,\n      ),\n    }),\n    isInitialValid: ({ shippingAddress, getFields, language }) =>\n      !!shippingAddress &&\n      getAddressFormFieldsValidationSchema({\n        language,\n        formFields: getFields(shippingAddress.countryCode),\n      }).isValidSync(shippingAddress),\n    validationSchema: ({\n         language,\n         getFields,\n         methodId,\n       }: SingleShippingFormProps & WithLanguageProps) =>\n      methodId\n        ? object({\n          shippingAddress: lazy<Partial<AddressFormValues>>((formValues) =>\n            getCustomFormFieldsValidationSchema({\n              translate: getTranslateAddressError(language),\n              formFields: getFields(formValues && formValues.countryCode),\n            }),\n          ),\n        })\n        : object({\n          shippingAddress: lazy<Partial<AddressFormValues>>((formValues) =>\n            getAddressFormFieldsValidationSchema({\n              language,\n              formFields: getFields(formValues && formValues.countryCode),\n            }),\n          ),\n        }),\n    enableReinitialize: false,\n  })(StripeShippingForm),\n);\n","import {\n  type Address,\n  type CheckoutSelectors,\n} from '@bigcommerce/checkout-sdk';\nimport React, { type ReactNode, useState } from 'react';\n\nimport { useCheckout } from '@bigcommerce/checkout/payment-integration-api';\nimport { AddressFormSkeleton } from '@bigcommerce/checkout/ui';\n\nimport type CheckoutStepStatus from '../../checkout/CheckoutStepStatus';\nimport ShippingHeader from '../ShippingHeader';\n\nimport StripeShippingForm, { type SingleShippingFormValues } from './StripeShippingForm';\n\nexport interface StripeShippingProps {\n  isBillingSameAsShipping: boolean;\n  cartHasChanged: boolean;\n  isMultiShippingMode: boolean;\n  step: CheckoutStepStatus;\n  isInitializing: boolean;\n  isInitialValueLoaded: boolean;\n  isLoading: boolean;\n  isShippingMethodLoading: boolean;\n  isShippingStepPending: boolean;\n  methodId?: string;\n  shippingAddress?: Address;\n  shouldShowMultiShipping: boolean;\n  shouldShowOrderComments: boolean;\n  onReady?(): void;\n  onUnhandledError(error: Error): void;\n  onSubmit(values: SingleShippingFormValues): void;\n  onMultiShippingChange(): void;\n  loadShippingAddressFields(): Promise<CheckoutSelectors>;\n  loadShippingOptions(): Promise<CheckoutSelectors>;\n  updateAddress(address: Partial<Address>): Promise<CheckoutSelectors>;\n}\n\nconst StripeShipping = ({\n  isBillingSameAsShipping,\n  shouldShowMultiShipping,\n  updateAddress,\n  isMultiShippingMode,\n  step,\n  onSubmit,\n  onMultiShippingChange,\n  isLoading,\n  isShippingMethodLoading,\n  ...shippingFormProps\n}: StripeShippingProps): ReactNode => {\n  const { checkoutState } = useCheckout();\n\n  const {\n    data: {\n      getCheckout,\n      getShippingAddressFields,\n    },\n  } = checkoutState;\n  const checkout = getCheckout();\n  const getFields = getShippingAddressFields;\n\n  const [isStripeLoading, setIsStripeLoading] = useState(true);\n  const [isStripeAutoStep, setIsStripeAutoStep] = useState(false);\n\n  const stripeLoadedCallback = () => {\n    setIsStripeLoading(false);\n  };\n\n  const handleIsAutoStep = () => {\n    setIsStripeAutoStep(true);\n  };\n\n  if (!checkout) {\n    return null;\n  }\n\n  const customerMessage = checkout.customerMessage;\n\n  return (\n    <>\n      <AddressFormSkeleton isLoading={isStripeAutoStep || isStripeLoading} />\n      <div\n        className=\"checkout-form\"\n        style={{ display: isStripeAutoStep || isStripeLoading ? 'none' : undefined }}\n      >\n        <ShippingHeader\n          isMultiShippingMode={isMultiShippingMode}\n          onMultiShippingChange={onMultiShippingChange}\n          shouldShowMultiShipping={shouldShowMultiShipping}\n        />\n        <StripeShippingForm\n          customerMessage={customerMessage}\n          getFields={getFields}\n          {...shippingFormProps}\n          isBillingSameAsShipping={isBillingSameAsShipping}\n          isLoading={isLoading}\n          isMultiShippingMode={isMultiShippingMode}\n          isShippingMethodLoading={isShippingMethodLoading}\n          isStripeAutoStep={handleIsAutoStep}\n          isStripeLoading={stripeLoadedCallback}\n          onSubmit={onSubmit}\n          step={step}\n          updateAddress={updateAddress}\n        />\n      </div>\n    </>\n  );\n};\n\nexport default StripeShipping;\n","import {\n    type Address,\n    type AddressRequestBody,\n    type Cart,\n    type CheckoutRequestBody,\n    type CheckoutSelectors,\n    type Consignment,\n    type ConsignmentAssignmentRequestBody,\n    type Country,\n    type Customer,\n    type CustomerRequestOptions,\n    type FormField,\n    type ShippingInitializeOptions,\n    type ShippingRequestOptions,\n} from '@bigcommerce/checkout-sdk';\nimport { noop } from 'lodash';\nimport React, { Component, type ReactNode } from 'react';\nimport { createSelector } from 'reselect';\n\nimport { type ExtensionContextProps, withExtension } from '@bigcommerce/checkout/checkout-extension';\nimport { shouldUseStripeLinkByMinimumAmount } from '@bigcommerce/checkout/instrument-utils';\nimport { TranslatedString } from '@bigcommerce/checkout/locale';\nimport { type CheckoutContextProps } from '@bigcommerce/checkout/payment-integration-api';\nimport { AddressFormSkeleton, ConfirmationModal } from '@bigcommerce/checkout/ui';\n\nimport { isEqualAddress, mapAddressFromFormValues } from '../address';\nimport { withCheckout } from '../checkout';\nimport type CheckoutStepStatus from '../checkout/CheckoutStepStatus';\nimport { EMPTY_ARRAY } from '../common/utility';\nimport getProviderWithCustomCheckout from '../payment/getProviderWithCustomCheckout';\nimport { PaymentMethodId } from '../payment/paymentMethod';\n\nimport getShippableItemsCount from './getShippableItemsCount';\nimport getShippingMethodId from './getShippingMethodId';\nimport hasPromotionalItems from './hasPromotionalItems';\nimport { type MultiShippingFormValues } from './MultiShippingForm';\nimport ShippingForm from './ShippingForm';\nimport ShippingHeader from './ShippingHeader';\nimport { type SingleShippingFormValues } from './SingleShippingForm';\nimport StripeShipping from './stripeUPE/StripeShipping';\n\nexport interface ShippingProps {\n    isBillingSameAsShipping: boolean;\n    cartHasChanged: boolean;\n    isMultiShippingMode: boolean;\n    step: CheckoutStepStatus;\n    onCreateAccount(): void;\n    onToggleMultiShipping(): void;\n    onReady?(): void;\n    onUnhandledError(error: Error): void;\n    onSignIn(): void;\n    navigateNextStep(isBillingSameAsShipping: boolean): void;\n    setIsMultishippingMode(isMultiShippingMode: boolean): void;\n}\n\nexport interface WithCheckoutShippingProps {\n    billingAddress?: Address;\n    cart: Cart;\n    cartHasPromotionalItems: boolean;\n    consignments: Consignment[];\n    countries: Country[];\n    customer: Customer;\n    customerMessage: string;\n    isGuest: boolean;\n    isInitializing: boolean;\n    isLoading: boolean;\n    isShippingStepPending: boolean;\n    methodId?: string;\n    shippingAddress?: Address;\n    shouldShowMultiShipping: boolean;\n    shouldShowOrderComments: boolean;\n    providerWithCustomCheckout?: string;\n    isFloatingLabelEnabled?: boolean;\n    assignItem(consignment: ConsignmentAssignmentRequestBody): Promise<CheckoutSelectors>;\n    deinitializeShippingMethod(options: ShippingRequestOptions): Promise<CheckoutSelectors>;\n    deleteConsignments(): Promise<Address | undefined>;\n    getFields(countryCode?: string): FormField[];\n    initializeShippingMethod(options: ShippingInitializeOptions): Promise<CheckoutSelectors>;\n    loadShippingAddressFields(): Promise<CheckoutSelectors>;\n    loadBillingAddressFields(): Promise<CheckoutSelectors>;\n    loadShippingOptions(): Promise<CheckoutSelectors>;\n    signOut(options?: CustomerRequestOptions): void;\n    createCustomerAddress(address: AddressRequestBody): Promise<CheckoutSelectors>;\n    unassignItem(consignment: ConsignmentAssignmentRequestBody): Promise<CheckoutSelectors>;\n    updateBillingAddress(address: Partial<Address>): Promise<CheckoutSelectors>;\n    updateCheckout(payload: CheckoutRequestBody): Promise<CheckoutSelectors>;\n    updateShippingAddress(address: Partial<Address>): Promise<CheckoutSelectors>;\n    shouldRenderStripeForm: boolean;\n}\n\ninterface ShippingState {\n    isInitializing: boolean;\n    isMultiShippingUnavailableModalOpen: boolean;\n}\n\nclass Shipping extends Component<ShippingProps & WithCheckoutShippingProps & ExtensionContextProps, ShippingState> {\n    constructor(props: ShippingProps & WithCheckoutShippingProps & ExtensionContextProps) {\n        super(props);\n\n        this.state = {\n            isInitializing: true,\n            isMultiShippingUnavailableModalOpen: false,\n        };\n    }\n\n    async componentDidMount(): Promise<void> {\n        const {\n            loadShippingAddressFields,\n            loadBillingAddressFields,\n            loadShippingOptions,\n            onReady = noop,\n            onUnhandledError = noop,\n            cartHasPromotionalItems,\n            isMultiShippingMode,\n        } = this.props;\n\n        try {\n            await Promise.all([loadShippingAddressFields(), loadShippingOptions(), loadBillingAddressFields()]);\n\n            if (cartHasPromotionalItems && isMultiShippingMode) {\n                this.setState({ isMultiShippingUnavailableModalOpen: true });\n            }\n\n            onReady();\n        } catch (error) {\n            onUnhandledError(error);\n        } finally {\n            this.setState({ isInitializing: false });\n        }\n    }\n\n    render(): ReactNode {\n        const {\n            isBillingSameAsShipping,\n            isGuest,\n            shouldShowMultiShipping,\n            customer,\n            updateShippingAddress,\n            initializeShippingMethod,\n            deinitializeShippingMethod,\n            isMultiShippingMode,\n            step,\n            shouldRenderStripeForm,\n            cartHasPromotionalItems,\n            extensionState: { shippingFormRenderTimestamp } = {},\n            setIsMultishippingMode,\n            ...shippingFormProps\n        } = this.props;\n\n        const {\n            isInitializing,\n            isMultiShippingUnavailableModalOpen,\n        } = this.state;\n\n        const handleSwitchToSingleShipping = async () => {\n            this.setState({ isMultiShippingUnavailableModalOpen: false });\n            await this.handleMultiShippingModeSwitch();\n        }\n\n        if (shouldRenderStripeForm && !customer.email && this.props.countries.length > 0) {\n            return <StripeShipping\n                { ...shippingFormProps }\n                isBillingSameAsShipping={isBillingSameAsShipping}\n                isInitialValueLoaded={!isInitializing}\n                isLoading={ isInitializing }\n                isMultiShippingMode={isMultiShippingMode}\n                isShippingMethodLoading={ this.props.isLoading }\n                onMultiShippingChange={ this.handleMultiShippingModeSwitch }\n                onSubmit={this.handleSingleShippingSubmit}\n                shouldShowMultiShipping={ shouldShowMultiShipping }\n                step={step}\n                updateAddress={updateShippingAddress}\n            />;\n        }\n\n        return (\n            <AddressFormSkeleton isLoading={isInitializing} renderWhileLoading={true}>\n                <div className=\"checkout-form\">\n                    <ConfirmationModal\n                        action={handleSwitchToSingleShipping}\n                        actionButtonLabel={<TranslatedString id=\"common.ok_action\" />}\n                        headerId=\"shipping.multishipping_unavailable_action\"\n                        isModalOpen={isMultiShippingUnavailableModalOpen}\n                        messageId=\"shipping.checkout_switched_to_single_shipping\"\n                        shouldShowCloseButton={false}\n                    />\n                    <ShippingHeader\n                        cartHasPromotionalItems={cartHasPromotionalItems}\n                        isMultiShippingMode={isMultiShippingMode}\n                        onMultiShippingChange={this.handleMultiShippingModeSwitch}\n                        shouldShowMultiShipping={shouldShowMultiShipping}\n                    />\n                    <ShippingForm\n                        {...shippingFormProps}\n                        deinitialize={deinitializeShippingMethod}\n                        initialize={initializeShippingMethod}\n                        isBillingSameAsShipping={isBillingSameAsShipping}\n                        isGuest={isGuest}\n                        isInitialValueLoaded={!isInitializing}\n                        isMultiShippingMode={isMultiShippingMode}\n                        onMultiShippingSubmit={this.handleMultiShippingSubmit}\n                        onSingleShippingSubmit={this.handleSingleShippingSubmit}\n                        setIsMultishippingMode={setIsMultishippingMode}\n                        shippingFormRenderTimestamp={shippingFormRenderTimestamp}\n                        updateAddress={updateShippingAddress}\n                    />\n                </div>\n            </AddressFormSkeleton>\n        );\n    }\n\n    private handleMultiShippingModeSwitch: () => void = async () => {\n        const {\n            consignments,\n            isMultiShippingMode,\n            onToggleMultiShipping = noop,\n            onUnhandledError = noop,\n            updateShippingAddress,\n            deleteConsignments,\n        } = this.props;\n\n        try {\n            this.setState({ isInitializing: true });\n\n            if (isMultiShippingMode && consignments.length) {\n                // Collapse all consignments into one\n                await updateShippingAddress(consignments[0].shippingAddress);\n            }\n            else {\n                await deleteConsignments();\n            }\n        } catch (error) {\n            onUnhandledError(error);\n        } finally {\n            this.setState({ isInitializing: false });\n        }\n\n        onToggleMultiShipping();\n    };\n\n    private handleSingleShippingSubmit: (values: SingleShippingFormValues) => void = async ({\n        billingSameAsShipping,\n        shippingAddress: addressValues,\n        orderComment,\n    }) => {\n        const {\n            customerMessage,\n            updateCheckout,\n            updateShippingAddress,\n            updateBillingAddress,\n            navigateNextStep,\n            onUnhandledError,\n            shippingAddress,\n            billingAddress,\n            methodId,\n        } = this.props;\n\n        const updatedShippingAddress = addressValues && mapAddressFromFormValues(addressValues);\n        const promises: Array<Promise<CheckoutSelectors>> = [];\n        const hasRemoteBilling = this.hasRemoteBilling(methodId);\n\n        if (!isEqualAddress(updatedShippingAddress, shippingAddress) || shippingAddress?.shouldSaveAddress !== updatedShippingAddress?.shouldSaveAddress) {\n            promises.push(updateShippingAddress(updatedShippingAddress || {}));\n        }\n\n        if (\n            billingSameAsShipping &&\n            updatedShippingAddress &&\n            !isEqualAddress(updatedShippingAddress, billingAddress) &&\n            !hasRemoteBilling\n        ) {\n            promises.push(updateBillingAddress(updatedShippingAddress));\n        }\n\n        if (customerMessage !== orderComment) {\n            promises.push(updateCheckout({ customerMessage: orderComment }));\n        }\n\n        try {\n            await Promise.all(promises);\n\n            navigateNextStep(billingSameAsShipping);\n        } catch (error) {\n            if (error instanceof Error) {\n                onUnhandledError(error);\n            }\n        }\n    };\n\n    private hasRemoteBilling: (methodId?: string) => boolean = (methodId) => {\n        const PAYMENT_METHOD_VALID = ['amazonpay'];\n\n        return PAYMENT_METHOD_VALID.some((method) => method === methodId);\n    };\n\n    private handleMultiShippingSubmit: (values: MultiShippingFormValues) => void = async ({\n        orderComment,\n    }) => {\n        const { customerMessage, updateCheckout, navigateNextStep, onUnhandledError } = this.props;\n\n        try {\n            if (customerMessage !== orderComment) {\n                await updateCheckout({ customerMessage: orderComment });\n            }\n\n            navigateNextStep(false);\n        } catch (error) {\n            if (error instanceof Error) {\n                onUnhandledError(error);\n            }\n        }\n    };\n}\n\nconst deleteConsignmentsSelector = createSelector(\n    ({ checkoutService: { deleteConsignment } }: CheckoutContextProps) => deleteConsignment,\n    ({ checkoutState: { data } }: CheckoutContextProps) => data.getConsignments(),\n    (deleteConsignment, consignments) => async () => {\n        if (!consignments || !consignments.length) {\n            return;\n        }\n\n        const [{ data }] = await Promise.all(consignments.map(({ id }) => deleteConsignment(id)));\n\n        return data.getShippingAddress();\n    },\n);\n\nexport function mapToShippingProps({\n    checkoutService,\n    checkoutState,\n}: CheckoutContextProps): WithCheckoutShippingProps | null {\n    const {\n        data: {\n            getCart,\n            getCheckout,\n            getConfig,\n            getCustomer,\n            getConsignments,\n            getShippingAddress,\n            getBillingAddress,\n            getShippingAddressFields,\n            getShippingCountries,\n        },\n        statuses: {\n            isShippingStepPending,\n            isSelectingShippingOption,\n            isLoadingShippingOptions,\n            isUpdatingConsignment,\n            isCreatingConsignments,\n            isCreatingCustomerAddress,\n            isLoadingShippingCountries,\n            isUpdatingBillingAddress,\n            isUpdatingCheckout,\n            isDeletingConsignment,\n            isLoadingCheckout,\n        },\n    } = checkoutState;\n\n    const checkout = getCheckout();\n    const config = getConfig();\n    const consignments = getConsignments() || [];\n    const customer = getCustomer();\n    const cart = getCart();\n\n    if (!checkout || !config || !customer || !cart) {\n        return null;\n    }\n\n    const {\n        checkoutSettings: {\n            enableOrderComments,\n            hasMultiShippingEnabled,\n        },\n    } = config;\n\n    const methodId = getShippingMethodId(checkout, config);\n    const isLoading =\n        isLoadingShippingOptions() ||\n        isSelectingShippingOption() ||\n        isUpdatingConsignment() ||\n        isCreatingConsignments() ||\n        isUpdatingBillingAddress() ||\n        isUpdatingCheckout() ||\n        isCreatingCustomerAddress() ||\n        isDeletingConsignment() ||\n        isLoadingCheckout();\n\n    const shippableItemsCount = getShippableItemsCount(cart);\n    const shouldShowMultiShipping =\n        hasMultiShippingEnabled && !methodId && shippableItemsCount > 1;\n\n    const shippingAddress =\n        !shouldShowMultiShipping && consignments.length > 1 ? undefined : getShippingAddress();\n\n    const providerWithCustomCheckout = getProviderWithCustomCheckout(\n        config.checkoutSettings.providerWithCustomCheckout,\n    );\n\n    return {\n        assignItem: checkoutService.assignItemsToAddress,\n        billingAddress: getBillingAddress(),\n        cart,\n        cartHasPromotionalItems: hasPromotionalItems(cart),\n        consignments,\n        countries: getShippingCountries() || EMPTY_ARRAY,\n        customer,\n        customerMessage: checkout.customerMessage,\n        createCustomerAddress: checkoutService.createCustomerAddress,\n        deinitializeShippingMethod: checkoutService.deinitializeShipping,\n        deleteConsignments: deleteConsignmentsSelector({ checkoutService, checkoutState }),\n        getFields: getShippingAddressFields,\n        initializeShippingMethod: checkoutService.initializeShipping,\n        isGuest: customer.isGuest,\n        isInitializing: isLoadingShippingCountries() || isLoadingShippingOptions(),\n        isLoading,\n        isShippingStepPending: isShippingStepPending(),\n        loadShippingAddressFields: checkoutService.loadShippingAddressFields,\n        loadBillingAddressFields: checkoutService.loadBillingAddressFields,\n        loadShippingOptions: checkoutService.loadShippingOptions,\n        methodId,\n        providerWithCustomCheckout,\n        shippingAddress,\n        shouldShowMultiShipping,\n        shouldShowOrderComments: enableOrderComments,\n        signOut: checkoutService.signOutCustomer,\n        unassignItem: checkoutService.unassignItemsToAddress,\n        updateBillingAddress: checkoutService.updateBillingAddress,\n        updateCheckout: checkoutService.updateCheckout,\n        updateShippingAddress: checkoutService.updateShippingAddress,\n        shouldRenderStripeForm: providerWithCustomCheckout === PaymentMethodId.StripeUPE && shouldUseStripeLinkByMinimumAmount(cart),\n    };\n}\n\nexport default withExtension(withCheckout(mapToShippingProps)(Shipping));\n","import { memoizeOne } from '@bigcommerce/memoize';\nimport { noop } from 'lodash';\nimport React, { type ReactNode, useState } from 'react';\n\nimport AccordionContext from './AccordionContext';\n\nexport interface AccordionProps {\n    children?: ReactNode;\n    className?: string;\n    defaultSelectedItemId?: string;\n    isDisabled?: boolean;\n    onSelect?(id: string): void;\n}\n\nconst Accordion = ({\n    children,\n    className = 'accordion',\n    defaultSelectedItemId,\n    isDisabled,\n    onSelect = noop,\n}: AccordionProps) => {\n    const [selectedItemId, setSelectedItemId] = useState<string | undefined>(defaultSelectedItemId);\n\n    const handleToggleItem: (id: string) => void = (id) => {\n        if (isDisabled) {\n            return;\n        }\n\n        setSelectedItemId(id);\n        onSelect(id);\n    };\n\n    const getContextValue = memoizeOne((newSelectedItemId?: string) => {\n        return {\n            onToggle: handleToggleItem,\n            selectedItemId: newSelectedItemId,\n        };\n    });\n\n    return (\n        <AccordionContext.Provider value={getContextValue(selectedItemId)}>\n            <ul className={className}>{children}</ul>\n        </AccordionContext.Provider>\n    );\n};\n\nexport default Accordion;\n","import { noop } from 'lodash';\nimport React, {\n    createContext,\n    type FunctionComponent,\n    memo,\n    type ReactNode,\n    useCallback,\n    useEffect,\n    useMemo,\n} from 'react';\n\nimport { Accordion } from '@bigcommerce/checkout/ui';\n\nimport { connectFormik, type ConnectFormikProps } from '../../common/form';\n\nexport interface ChecklistProps {\n    children?: ReactNode;\n    defaultSelectedItemId?: string;\n    isDisabled?: boolean;\n    name: string;\n    onSelect?(value: string): void;\n}\n\nexport interface ChecklistContextProps {\n    name: string;\n}\n\nexport const ChecklistContext = createContext<ChecklistContextProps | undefined>(undefined);\n\nconst Checklist: FunctionComponent<\n    ChecklistProps & ConnectFormikProps<{ [key: string]: string }>\n> = ({ formik: { setFieldValue }, name, onSelect = noop, ...props }) => {\n    useEffect(() => {\n        return () => {\n            setFieldValue(name, '');\n        };\n    }, []);\n\n    const handleSelect = useCallback(\n        (value: string) => {\n            setFieldValue(name, value);\n            onSelect(value);\n        },\n        [name, onSelect, setFieldValue],\n    );\n\n    const contextValue = useMemo(() => ({ name }), [name]);\n\n    return (\n        <ChecklistContext.Provider value={contextValue}>\n            <Accordion\n                {...props}\n                className=\"form-checklist optimizedCheckout-form-checklist\"\n                onSelect={handleSelect}\n            />\n        </ChecklistContext.Provider>\n    );\n};\n\nexport default connectFormik(memo(Checklist));\n","import React, { type FunctionComponent } from 'react';\n\nimport withIconContainer from './withIconContainer';\n\nconst IconChevronUp: FunctionComponent = () => (\n    <svg height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z\" />\n    </svg>\n);\n\nexport default withIconContainer(IconChevronUp);\n","import { connect } from 'formik';\nimport React, { type ComponentType, type FunctionComponent, memo } from 'react';\nimport shallowEqual from 'shallowequal';\n\nimport type ConnectFormikProps from './ConnectFormikProps';\n\nexport default function connectFormik<TProps extends ConnectFormikProps<TValues>, TValues = any>(\n    OriginalComponent: ComponentType<TProps>,\n): ComponentType<Omit<TProps, keyof ConnectFormikProps<TValues>>> {\n    const InnerComponent: FunctionComponent<TProps> = memo(\n        (props) => <OriginalComponent {...props} />,\n        ({ formik: prevFormik, ...prevProps }, { formik: nextFormik, ...nextProps }) =>\n            shallowEqual(prevFormik, nextFormik) && shallowEqual(prevProps, nextProps),\n    );\n\n    const DecoratedComponent = connect<TProps, TValues>(InnerComponent) as ComponentType<\n        Omit<TProps, keyof ConnectFormikProps<TValues>>\n    >;\n\n    DecoratedComponent.displayName = `ConnectFormik(${\n        OriginalComponent.displayName || OriginalComponent.name\n    })`;\n\n    return DecoratedComponent;\n}\n","import { type Placement } from '@popperjs/core';\nimport React, { type ReactElement, type ReactEventHandler, type ReactNode, useState } from 'react';\nimport { Manager, Popper, Reference } from 'react-popper';\n\nexport interface TooltipTriggerProps {\n    placement?: Placement;\n    tooltip: ReactNode;\n    children?: ReactNode;\n}\n\nconst TooltipTrigger = ({\n    children,\n    placement = 'bottom',\n    tooltip,\n}: TooltipTriggerProps): ReactElement => {\n    const [shouldShow, setShouldShow] = useState(false);\n\n    const handleShow: ReactEventHandler<HTMLElement> = () => {\n        setShouldShow(true);\n    };\n\n    const handleHide: ReactEventHandler<HTMLElement> = () => {\n        setShouldShow(false);\n    };\n\n    return (\n        <Manager>\n            <Reference>\n                {({ ref }) => (\n                    <span\n                        onBlur={handleHide}\n                        onFocus={handleShow}\n                        onMouseEnter={handleShow}\n                        onMouseLeave={handleHide}\n                        ref={ref}\n                    >\n                        {children}\n                    </span>\n                )}\n            </Reference>\n\n            <Popper\n                modifiers={[\n                    { name: 'hide', enabled: false },\n                    { name: 'flip', enabled: false },\n                    { name: 'preventOverflow', enabled: false },\n                ]}\n                placement={placement}\n            >\n                {({ ref, style }) =>\n                    shouldShow && (\n                        <div ref={ref} style={style}>\n                            {tooltip}\n                        </div>\n                    )\n                }\n            </Popper>\n        </Manager>\n    );\n};\n\nexport default TooltipTrigger;\n"],"names":["height","viewBox","width","xmlns","d","memo","bodyClassName","children","className","classNameSelected","headerClassName","headerClassNameSelected","headerContent","itemId","onToggle","selectedItemId","useContext","AccordionContext","A","isSelected","transitionEndListener","useCallback","node","done","addEventListener","target","CSSTransition","addEndListener","classNames","in","mountOnEnter","timeout","unmountOnExit","id","props","Input","checked","type","Label","htmlFor","isDisabled","value","content","htmlId","kebabCase","label","rest","name","Checklist","C","renderInput","memoizeOne","field","disabled","Function","handleChange","selectedValue","renderHeaderContent","BasicFormField","onChange","render","headerId","messageId","isModalOpen","action","actionButtonLabel","onRequestClose","noop","shouldShowCloseButton","additionalModalClassName","footer","onClick","size","Small","variant","Primary","header","role","isOpen","closeButtonLabel","additionalHeaderClassName","additionalBodyClassName","handleClose","event","ariaHideApp","bodyOpenClassName","base","afterOpen","beforeClose","closeTimeoutMS","overlayClassName","shouldCloseOnEsc","shouldCloseOnOverlayClick","href","preventDefault","Boolean","forwardRef","ref","additionalClassName","legend","testId","createContext","withIconContainer","AlertType","icon","describedBy","useId","Info","Error","Success","Warning","renderDefaultIcon","getShippingMethodId","checkout","config","SHIPPING_METHOD_IDS","PaymentMethodId","AmazonPay","BraintreeAcceleratedCheckout","PayPalCommerceAcceleratedCheckout","providerWithCustomCheckout","getProviderWithCustomCheckout","checkoutSettings","preselectedPayment","getPreselectedPayment","includes","providerId","undefined","hasPromotionalItems","cart","digitalItems","physicalItems","lineItems","filter","item","addedByPromotion","length","withFormikExtended","OriginalComponent","DecoratedComponent","resetForm","isInitialValueLoaded","initialValues","previousIsInitialValueLoadedRef","useRef","useEffect","current","values","displayName","SaveAddressForm","withLanguage","handleSubmit","onSaveAddress","mapPropsToValues","getFields","selectedAddress","mapAddressToFormValues","countryCode","validationSchema","language","getAddressFormFieldsValidationSchema","formFields","setFieldValue","isLoading","Form","autoComplete","LoadingOverlay","AddressForm","shouldShowSaveAddress","AddressType","Shipping","Button","Secondary","TranslatedString","onAfterOpen","addressFormProps","Modal","ModalHeader","AssignItemInvalidAddressError","CustomError","constructor","data","super","message","getLanguageService","translate","title","this","prototype","AssignItemFailedError","fill","onUseNewAddress","themeV2","SingleLineStaticAddress","address","setRecommendedOrMissingShippingOption","previousConsignment","currentConsignments","selectConsignmentShippingOption","previousShippingOptions","Map","map","consignment","selectedShippingOption","previousShippingOptionId","get","recommendedOption","availableShippingOptions","find","option","isRecommended","defaultCountryCode","onUnhandledError","setConsignmentRequest","isOpenNewAddressModal","setIsOpenNewAddressModal","useState","createCustomerAddressError","setCreateCustomerAddressError","checkoutState","getCustomer","getConfig","getConsignments","getPreviousConsignments","getShippingAddressFields","checkoutService","updateConsignment","createCustomerAddress","customer","addresses","isGuest","handleSelectAddress","isValidAddress","shippingAddress","quantity","error","handleUseNewAddress","ErrorModal","onClose","shouldShowErrorCode","addressFormValues","mapAddressFromFormValues","AddressSelect","onSelectAddress","placeholderText","showSingleLineAddress","ItemSplitTooltip","TooltipTrigger","placement","tooltip","Tooltip","IconHelp","assignedItems","onUnassignItem","count","shippableItemsCount","hasSplitItems","key","toString","IconClose","isMobileView","imageUrl","alt","src","options","nameId","FormField","input","TextInput","min","items","formErrors","LineItemType","onAllocateItems","Object","keys","lineItemId","unassignedItems","forEach","enableReinitialize","createItemSchema","baseSchema","required","integer","max","Custom","oneOf","schemaObject","fromEntries","shape","validateOnBlur","validateOnChange","consignmentNumber","setValues","dirty","submitForm","errors","allocatedOrSelectedItemsMessage","useMemo","leftItemsTotal","selectedItems","reduce","acc","push","Array","from","Set","hasItemsAssigned","hasUnassignedItems","modalFooter","index","Alert","hasDigitalItems","UnassignItemError","generateHash","btoa","encodeURIComponent","join","calculateShippableItemsCount","total","hasSplitItem","itemHashMap","processedHashes","hash","has","add","mapConsignmentsItems","consignments","unassignedItemsMap","digitalItemsMap","consignmentList","set","Physical","productId","variantId","sku","valueId","generateItemHash","customItems","Digital","consignmentLineItems","lineItemIds","delete","unassignedItemsList","defaultMultiShippingConsignmentItems","useMultiShippingConsignmentItems","getCheckout","nonBundledLineItems","parentId","removeBundledItems","isOpenAllocateItemsModal","setIsOpenAllocateItemsModal","showItems","setShowItems","assignItemsToAddress","assignItem","deleteItem","createConsignments","deleteConsignment","consignmentRequest","consignmentIdToBeDeleted","consignmentsReponse","c","useDeallocateItem","toggleAllocateItemsModal","itemsCount","itemToDelete","IconChevronUp","IconChevronDown","ConsignmentLineItemDetail","MultiShippingOptionsListItem","consignmentId","selectedShippingOptionId","shippingOption","handleSelect","description","ShopperCurrency","amount","cost","RadioInput","readOnly","shippingOptions","onSelectedOption","getShippableLineItems","result","i","isNil","concat","lineItemIndex","splitItems","findConsignment","splitItem","getRecommendedShippingOption","getShippingOptionIds","shippingOptionIds","ConsignmentDetails","StaticAddress","StaticConsignmentItemList","NoShippingOptions","ChecklistSkeleton","rows","getCarriers","userBcId","BUNDLEURL","process","env","BUNDLEAUTHTOKEN","companiesIds","fetch","headers","authToken","then","response","json","res","companyId","multipleShippingsNames","Promise","all","shippingsArray","extraFields","fieldName","fieldValue","split","shippingNamesFiltered","SELANUSAAPIURL","shippingsNumberArray","element","parseInt","shippingsNumberArrayInString","JSON","stringify","shipping","e","console","getCarriersName","flat","ShippingOptionListItem","isMultiShippingMode","renderLabel","StaticShippingOption","displayAdditionalInformation","method","Extension","region","ChecklistItem","inputName","customerId","customerGroupId","postalCode","stateOrProvince","filteredShippingOptions","setFilteredShippingOptions","setFilterCarriers","newCarriers","bundleCarriers","pushAndFilterCarriers","newDefaultCarriers","GetDefaultCarriers","allCarriers","Carriers","newFilteredShipping","carrierName","filteredShipping","isTheStateAndSelanusasGroup","defaultSelectedItemId","onSelect","selectShippingOption","shouldShowShippingOptions","invalidShippingMessage","methodId","subscribeToConsignments","shippingFormRenderTimestamp","storeHash","analyticsTracker","useAnalytics","selectDefaultShippingOptions","singleShippingOption","defaultShippingOption","unsubscribe","showShippingMethods","subscribeToConsignmentsSelector","createSelector","subscribe","subscriber","isLoadingSelector","_","isUpdatingAddress","statuses","isLoadingShippingOptions","isSelectingShippingOption","isUpdatingConsignment","isCreatingConsignments","withCheckout","getCart","customerGroup","storeProfile","unsortedConsignments","shippableItems","consignmentsOrder","uniq","sortBy","indexOf","sortConsignments","shippingQuoteFailedMessage","MultiShippingOptions","resetErrorConsignmentNumber","isLoadingOptions","MultiShippingOptionsList","shippingOptionId","isSelectedShippingOptionValid","every","shouldShowOrderComments","shouldDisableSubmit","cartHasChanged","OrderComments","setIsAddShippingDestination","getShippingCountries","countries","country","code","onSubmit","customerMessage","orderComment","errorConsignmentNumber","setErrorConsignmentNumber","unassignedLineItems","isAddShippingDestination","isEveryConsignmentHasShippingOption","hasSelectedShippingOptions","enableOrderComments","renderAllocatedBanner","errorConsignmentIndex","findIndex","labelContent","CheckboxFormField","buttonId","deinitialize","initialize","onFieldChange","customFormFields","custom","shouldShowCustomFormFields","style","padding","Tiny","Fieldset","DynamicFormField","parentFieldName","AmazonPayShippingAddress","isShippingStepPending","initializeShipping","defaultOptions","editAddressButtonId","amazonpay","addressWithoutLocalization","onAddressSelect","paypalFastlaneShippingComponentRef","localizeAddress","hideContentWhenLoading","firstName","lastName","phone","company","address1","address2","city","localizedProvince","localizedCountry","PoweredByPayPalFastlaneLabel","showAddressSelector","customFields","addressFieldName","connectFormik","formik","formAddress","formikSetFieldValue","hasAddresses","hasValidCustomerAddress","isValidCustomerAddress","unmountContentWhenLoading","onAutocompleteToggle","inputValue","formFieldName","PayPalFastlaneShippingAddress","handleFieldChange","isLoadingStrategy","setIsLoadingStrategyStrategy","paypalFastlaneShippingComponent","fastlaneOptions","provider","onPayPalFastlaneAddressChange","showPayPalFastlaneAddressSelector","shouldShowPayPalFastlaneShippingForm","usePayPalFastlaneAddress","hasRequestedShippingOptions","setSubmitted","FormContext","SHIPPING_ADDRESS_FIELDS","Legend","ShippingOptions","SingleShippingForm","PureComponent","state","isResettingAddress","isUpdatingShippingData","isValid","resolve","setTimeout","isShippingField","updateAddressWithFormData","handleAddressSelect","updateAddress","setState","deleteConsignments","debouncedUpdateAddress","debounce","includeShippingOptions","params","include","shippingAutosaveDelay","componentDidUpdate","newShippingFormRenderTimestamp","isBillingSameAsShipping","stateOrProvinceCode","billingSameAsShipping","addressForm","shouldShowBillingSameAsShipping","some","updatedShippingAddress","isArray","isEqual","isEqualAddress","contextType","isInitialValid","isValidSync","methodIdsWithoutCustomValidation","shouldHaveCustomValidation","formValues","getCustomFormFieldsValidationSchema","onMultiShippingSubmit","onSingleShippingSubmit","signOut","setIsMultishippingMode","hasMultiShippingEnabled","isUsingMultiShipping","onMultiShippingChange","shouldShowMultiShipping","cartHasPromotionalItems","isSingleShippingConfirmationModalOpen","setIsSingleShippingConfirmationModalOpen","isMultiShippingUnavailableModalOpen","setIsMultiShippingUnavailableModalOpen","showConfirmationModal","showMultiShippingUnavailableModal","ConfirmationModal","StripeStateMapper","stateList","getStripeState","step","isStripeLoading","isStripeAutoStep","isShippingMethodLoading","isNewAddress","setIsNewAddress","isFirstShippingRender","setIsFirstShippingRender","stripeShippingAddress","setStripeShippingAddress","shouldSaveAddress","handleLoading","availableShippingList","allowedCountries","handleStripeShippingAddress","complete","phoneFieldRequired","line1","line2","postal_code","stepCompleted","isComplete","shippingPopulated","shouldShowContent","names","shippingValue","getStylesFromElement","properties","parentContainer","document","getElementById","getAppliedStyles","stripeupe","container","onChangeShipping","availableCountries","getStyles","containerId","formInput","formLabel","formError","labelText","color","fieldText","fieldPlaceholderText","fieldErrorText","fieldBackground","fieldInnerShadow","fieldBorder","gatewayId","renderCheckoutThemeStylesForStripeUPE","deinitializeShipping","shippingFormProps","setIsStripeLoading","setIsStripeAutoStep","AddressFormSkeleton","display","Component","handleMultiShippingModeSwitch","onToggleMultiShipping","updateShippingAddress","isInitializing","handleSingleShippingSubmit","addressValues","updateCheckout","updateBillingAddress","navigateNextStep","billingAddress","promises","hasRemoteBilling","handleMultiShippingSubmit","componentDidMount","loadShippingAddressFields","loadBillingAddressFields","loadShippingOptions","onReady","initializeShippingMethod","deinitializeShippingMethod","shouldRenderStripeForm","extensionState","email","renderWhileLoading","deleteConsignmentsSelector","getShippingAddress","mapToShippingProps","getBillingAddress","isCreatingCustomerAddress","isLoadingShippingCountries","isUpdatingBillingAddress","isUpdatingCheckout","isDeletingConsignment","isLoadingCheckout","getShippableItemsCount","signOutCustomer","unassignItem","unassignItemsToAddress","StripeUPE","shouldUseStripeLinkByMinimumAmount","withExtension","setSelectedItemId","handleToggleItem","getContextValue","newSelectedItemId","Provider","ChecklistContext","contextValue","InnerComponent","prevFormik","prevProps","nextFormik","nextProps","shouldShow","setShouldShow","handleShow","handleHide","onBlur","onFocus","onMouseEnter","onMouseLeave","modifiers","enabled"],"sourceRoot":""}